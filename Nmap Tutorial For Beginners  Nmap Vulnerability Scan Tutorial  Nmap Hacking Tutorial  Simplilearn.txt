with ethical hacking and penetration
testing becoming mainstream in corporate
environments trained personal and
relevant equipment are in high demand
the right software framework can be the
tipping point in a hacking campaign
which deals with intricate hardware
one such tool that has been a mainstay
for decades is nmap
when it comes to scanning machines for
open ports and services and map has
always been the first choice for hackers
being lightweight and open source nmap
has a strong community backing and
receives regular updates
let's take a look at the topics being
covered
today we start by learning about the
different phases in ethical hacking and
where nmap is most valuable to the
hackers
we learn the basics of nmap and its
purpose during a penetration testing
flow
next we take a look at the top-level
approach of nmap as a scanning tool and
how it conducts these scans on host
machines
moving on we cover the multiple modes
and the types of scans that we can be
performed using nmap on unsuspecting
users
we also look at some alternatives that
users can prefer if nmap is not
something that they are comfortable with
while a live demonstration of the powers
of nmap will help in shedding light on
the topics that are being covered today
first let's understand where and why and
map is so essential
there are five phases when it comes to
ethical
hacking reconnaissance is the first
phase of a penetration test or ethical
hacking campaign
in this phase the security researcher
collects information about the target
it can be done actively meaning you are
collecting information by sending a
request directly to the target and
interpreting it
or passively meaning you are collecting
information without contacting the
target directly
it helps security firms gather
information about the target system
network components active machines open
ports operating system details etc
this activity can be performed by using
information available in the public
domain and by using different tools at
the disposal
the scanning phase is more tool oriented
rather than being performed manually
the penetration tester runs one or more
scanner tools to gather more information
about the target
by using various scanners such as war
dialers port scanners network mappers
and vulnerability scanners penetration
testers collect as many vulnerabilities
which help in turn attack to a target in
a more sophisticated way
in this phase the penetration tester
tries to establish a connection with the
target and exploit the vulnerabilities
found in the previous state
the gaining access phase is highly
essential after the scanning phase
exploitation may be buffer overflow
attack denial of service or a dos attack
session hijacking and many more
basically the penetration tester
extracts information and sensitive data
from the servers by gaining access using
different
tools in the maintaining access phase
the penetration tester tries to create a
back door for himself that he can access
later on
it helps the penetration tester in
identifying hidden vulnerabilities in
the system while making sure it can be
accessed later on should there be a need
in the covering track phase the
penetration tester tries to remove all
logs and footprints which help the
administrator identify his presence
this helps the tester to think like a
hacker and perform corrective actions to
mitigate these activities
and map is most beneficial in the early
stages of ethical hacking where a hacker
must figure the possible entry point to
a system before running the necessary
exploits
this allows the hackers to leverage any
insecure openings and breach the device
so the reconnaissance and the scanning
phases are the points where nmap finds
most user
let us understand what nmap is from a
layman's perspective
nmap which stands for network mapper is
a free and open source utility for
network discovery and security auditing
many systems and network administrators
also find it useful for tasks such as
network inventory managing service
upgrade schedules and monitoring host or
service uptime
the program is most commonly used via
command line interface and is available
for many different operating systems
such as linux free psd and gen2
its popularity has also been bolstered
by an active and enthusiastic user
support community
it is most beneficial in the early
stages of ethical hacking where a hacker
must figure the possible entry point to
a system before running the necessary
exploits
initially developed for enterprise scale
networks it can scan through thousands
of connected devices
however in recent years nmap has become
increasingly popular among smaller
companies as well
nmap users repeat packets in novel ways
to determine what hosts are available on
the network what services these hosts
are offering what operating systems they
are running what type of packet filters
or firewalls are in use and dozens of
other characteristics
it was designed to rapidly scan large
networks but works fine against single
host as well
the rise of iot in particular now means
that networks used by these companies
have become more complex and therefore
harder to secure
this means that nmap is now used in many
website monitoring tools to audit the
traffic between web servers and iot
devices
since every application that connects to
a network needs to do so via a port the
wrong port or server configuration can
open a can of worms which lead to a
thorough breach of the system and
ultimately a fully hacked device
the recent emergence of iot botnets have
also stimulated interest in nmap not
least because of its ability to
interrogate devices connected by the
upnp protocol but also to highlight any
devices that may be malicious
now that we understand what nmap is
let us take a look at the workflow of
how an ethical hacker uses this tool in
penetration testing
at a practical level nmap is used to
provide detailed real-time information
on your networks and on the devices that
are connected to them
we have the hacker running nmap on his
own system with a victim machine running
a standard installation of their
operating system which can be either
windows mac os linux or any other
variation
the first stage consists of the hacker
sending some ip packets to the victim
machine directly
these are specially crafted ip packets
which are necessary of some reply
after getting these packets the victim
machine tends to send some reply back to
the machine that had sent these requests
which is in turn a hacker
whatever reply the machine sends back to
nmap it can later be used for analysis
depending on what kind of requests are
being sent and the manner of the replies
that are received one can determine
easily what kind of machine we are
taking up
it can be used to determine the life of
the host which basically means if the
host is alive or currently if the server
is shut down
we can check what ports are open and we
can also know what type of services are
being offered on those specific ports
many applications like ftp and samba run
on specific ports thereby if we find
those ports open one can determine that
these services are being run on the
victim machine
we can also find the operating system
which is being run on the victim with
the specific scan filters using nmap
we are now aware of how nmap works at a
basic level
but there are many varieties of scans
that users can run on local machines
each of them serves a different purpose
let's take a look at some of these scans
ping sweep is the simple time of nmap
scan where it pings to all available ip
addresses to check which ips respond to
icmp or internet control message
protocol
if the users need to know only the
number of ip addresses and not many
details the ping sweep is very useful
this is fast and the results are known
to be fetched very easily
syn is the most useful type of nmap scan
which does work quietly
it sends the syn packet via tcp or
transfer control protocol to all the
intended ports if an acknowledgement
pack is received back to the system it
is sure that the port is open there
no response means that the port is
either closed or not available
here the acknowledgement pack is not
sent back to the system assuming that
the connection is not valid thus the
full connection is not scanned as per
the system
the tcp connect scan is similar to syn
scan in many aspects as it uses the tcp
layer to send packets and it is passed
on to all the ports
here the difference is that the full
connection is done by sending the
acknowledgement packets back
the logs can easily find the tcp scan
but need more power from the machines to
do the work
this is more accurate than syn scans too
if all the accesses related to os are
available to the user it is better to do
a tcp scan than an syn scan as well as
all the low and high level accesses that
are required for this
the network is also loaded more and
hence users must be careful about
loading the system and the networks
an ideal scan is really used to check
whether any malicious attacks are
planned on any particular network
this is the most recent type of nmap
scan where the scan packets are sent to
a port when moved away by another host
to check the presence of malware
rpc scans also known as remote procedure
calls are done by hackers to make the
system vulnerable to virus attacks
it is thus necessary to know whether our
system answers such calls and makes our
systems open to malware
rpc scan is done to check this by
finding the ports open with certain
commands being run by rpc
a windows scan is a simple scan where
the application scans the
acknowledgement packets received from
the ports once syn packages are sent
if there are any abnormalities in the
ack package received which is the
acknowledgement the scan reports the
same and helps in recognizing which
ports are functioning in a different way
the bound scan is used to check the
security in the file transfer protocol
layer
ftp layers mostly do not accept any
packets and once it is rejected from the
ftp layers there are chances that it
might be sent to an internal layer so
that it can access the machines
bounce can check this loophole by doing
exactly the same process and identifies
whether ftp layer is open to this
vulnerability or not
the udp scan is most useful in the
windows system to know whether the udp
layer is open to attacks
it is not always possible to get a
response from the udp layer but it helps
to know whether the layer is having any
trojan attacks running in it the
responses can be a bit slower than other
scans but it is useful to do this scan
to protect it
it responds to packets when the port is
closed which might make the sender
believe that there is a presence of
trojan so it is good to double check the
same
the fin scan is similar to syn scan but
the system that sends the package
receives a response back and it will be
mostly tcp fi in packets
if the system sends an rsd packet it is
a false alarm and users need not be
worried about the same
null scan is useful for other systems
than windows where the systems can
easily identify what kind of packets
they have received and respond back with
either tcp packets or null responses
null scans are not useful for windows as
they may not always produce the desired
results
there is a wide range of free network
monitoring utilities as well as free
open source vulnerability scanners which
are available to admins and security
auditors
what makes and map stand out as the tool
id and network managers need to know is
its flexibility and power
there are some alternatives to nmap but
most of them are focused on providing
specific niche functionality that
average system administrator does not
need frequently
mass scan for instance is much faster
than nmap but it provides much less
detail as well
in reality nmap provides all the
functionality and speed that the average
user requires especially when used along
with other similar tools
we also have netcat which can be used to
manage and control network traffic and
zenmap which is basically a graphical
user interface for nmap but as an
all-rounder solution to network scanning
nobody can go wrong with nmap as the
tool of choice
let us now take a tour of and map based
on all the things we have covered today
we start by learning of how to install
an end map on a fresh operating system
that doesn't come pre-installed with the
tool
we also cover some different types of
scans that can be run on local machines
along with checking the multiple
inferences an ethical hacker can gather
based on the scan output of nmaps
finally we run scans and vulnerable
machines to get an idea of how to
proceed with the outputs we gather using
this tool the first step in our
demonstration is installing nmap
now it depends heavily on what linux
distribution you are going to use to
perform ethical hacking
right now i am using parrot security
operating system
if you are not aware of what parrot
security is or even what kali linux is
we highly suggest that you check out the
videos of those two operating systems on
our youtube channel so that you can get
a fair idea of what they serve
now if you are using any of these two
operating systems and map should come
pre-installed by default
to check if nmap is pre-installed or not
you can just press on applications over
here
go to the pen testing section
go to this information gathering tab
and you should be able to see nmap right
here
now let's say you do not have nmf
pre-installed maybe you're using a linux
distribution like ubuntu or linux mint
or something that is based on debian
operating systems
one thing you have to make sure that
nmap should be in the distribution
repository
once you check that or even if you do
not know if it is present it should be
sudo which is to give the root
permissions for installation
apt
apt is the package manager of all linux
distributions that are based on debian
that goes for debian stable ubuntu linux
mint kali linux parrot security and
anything of that nature
apt is the package manager which handles
the installation and removal of
applications in these specific operating
systems
once you are here just write install
and nmap
press enter and it's going to ask you
for the root password that you set when
you install the operating system in the
first place
enter your root password and press enter
again
as you can see it's saying that nmap is
already installed the newest version
since i am running pirate security
operating system
now should you be running this operating
system or even kali linux you should
receive a similar message and the
installation is already done
if you are using some other distribution
let's say even black
arch linux or manjaro anything like that
the installation steps will be slightly
different
this sudo apt-install nmap command is
for distributions that are derived from
debian and ubuntu
if you want to install in arch linux
based distributions you have to use
their package manager which is known as
by mac
but that is for a different step and if
you want to get ethical hacking the best
way to start is by learning either kali
linux or parrot security
now that the installation is done
we're going to learn how to use nmap
one of the most basic functions of nmap
is to identify active hosts on the
network
we can do this by using a ping scan the
pings scan identifies all of the ip
addresses that are currently online
without sending any packets to these
hosts
now to run the ping scan we're going to
end map
the flag we're going to mention over
here is sp now these flags are the
different
traits of the nmap scan depending on
what flag we use we can send different
kinds of requests to the host that we
are scanning
now before moving forward with this let
me open another terminal over here and
check the ip address
we're going to write the command
ifconfig and find the subnet in which
this system is present
as you can see the ip address is
192.168.72.131
now this operating system is being run
on a virtual machine software known as
vmware the vmware in itself is running
on a windows 10 operating system
considering they are now a part of the
local network
this ip address is of pirate security
and the windows operating system which
is the host system in my scenario
will fall in this particular subnet
so to run our scan
we're going to target
192.160.
72.1
24.
this command then returns a list of
hosts on your network and the total
number of assign ip addresses
it's going to be capital p
yeah
if you spot any hosts or ip addresses on
that list that you cannot account for
you can then run further commands to
investigate them further
as of right now you can see the machine
that is the parrot security
this ip address can be detected in the
subnet
the 192.168.72.1
is my local windows machine that is
running vmware software and ultimately
this virtual machine
the 72.2 is the dhcp server that hosts
the internet connection of the parrot
security this we can ignore for now
now the windows machine that we have
over here let's run some tests on that
i'm going to clear
our terminal
and we can close this actually
when scanning hosts nmap commands can
use server names ipv for networks or
ipv6 addresses
a basic nmap command
will produce information about the given
host
to run a basic port scan we can just use
nmap along with the ip
now as you remember
the ip
it's 192.168.72.1
this is the ip of my local windows 10
machine
as you can see
it shows the ports that are open and the
particular servers that these ports are
running
now we can also have a detection of the
operating system
now mind you this is not 100 correct and
the reliability depends on the
installation
and what kind of fingerprinting measures
are available
now since this does tcp ip
fingerprinting it needs some extra
permissions
the flag that we are going to use is
nmap
minus o
along with the same ip address
like i said since this is tcp
fingerprinting it requires root
privileges
now to provide root privileges we're
just going to add the nmap
and sudo keyword
going to repeat the same command that we
wrote above
as you can see it has successfully
detected that i am running microsoft
windows 10
with this mac address
it has also shown the correct build
number of the windows 10 system that i
am using
this is useful for troubleshooting
scanning for few vulnerabilities or even
locating some services that need to be
updated
look at the necessary information about
these services for example what versions
they are using we have a command known
as sv which stands for service version
we use the same ip address
and press enter
now as you can see
the scan is complete and if you can
check the results of the scan above here
we don't see any version number for the
services
here
we can actually check what version they
are running
now this becomes helpful when we are
trying to find specific versions to
exploit for example if vmware
workstation 16 1.2 had some particular
vulnerability we can exploit it by
checking this command
apart from the host scanning port
scanning is one of the most basic
utilities there are few ways that this
command can be customized as well
for example
i have already checked that the 443
command is open
but i have found out after running this
lengthy scan let's say i only want to
check if command if the port 443 is open
and map
i'm going to use the
flag of minus p
which stands for port
and give
443 as an argument here
using the same ip address
and you can see it says it's open
but we already knew it is open
let's say there was something else
uh if let's say we're going to scan if
the apache web server port is open which
usually runs on 80
obviously since i'm not running an
apache web server it says it's closed
now we can combine these two commands by
running both both simultaneously
to do that we can just put a comma
and
complete the rest
similarly
expected it is closed and 443 is open
another feature of nmap
for port scanning is showing off ranges
now ranges can be beneficial when you're
trying to see up to a certain limit for
example nmap minus p we're going to
check what ports are open between 100
to let's say 2000
this acts as the range
everything else is the same
and it checks all ports in the range of
100 to 2000
whatever pose is open in between that
range
it can be mentioned over here
we're going to clear the screen now
another flag that can be used with nmap
is the ss command
this runs a stealth scan which is a
little harder to detect if you're the id
admin of the system that is being
scanned
the results will more or less be the
same although this will need elevated
root privileges
2.1
as you can see this is more or less
similar to a port scan it just adds an
extra mac address as well for good
measure but like i said it's more about
the stealth the normal scans usually are
easier to detect when the logs are being
checked
stealth scans are relatively tougher to
check
on much more intricate systems this
takes longer as well
now that we're done with both scanning
let's look at a vulnerable machine
the system that is scanning right now is
this my own personal system but
everything is pretty locked down as much
as it can be
there is an attack box running
in the cloud the ip address of which is
over here
now to be able to get into this network
we need to connect to their personal
network using a vpn
so what i'm going to do is switch to a
different workspace over here
i'm going to open a terminal
and if you can see over here there is a
hacktest.ovpn file
i am going to connect to their vpn
network using this ovpn file
and once we get the initialization
sequence completed message we know that
the connection has been established
like we discussed this is the
vulnerable device ip
we're going to copy this
and we're going to try to ping this
let's open a new terminal
i'm going to try to ping this and check
if we are able to reach this machine
and as you can see we're getting a reply
back which means we are now part of the
local network
where the vulnerable machine is present
let's run a service scan map
with the respective versions
we ran the similar scan on my local
machine where we were able to detect
what version each service was running
what we're going to do over here is by
checking what kind of services are open
on the machine running on the cloud
we're going to decide what we are going
to do next and we are going to see if
nmap alone can point us to a direction
where we can gain access to the machine
as you can see the scan is now completed
and we have some of the ports that are
being opened over here and what kind of
service they are running
now
like we discussed this is the first
stage or sometimes even the second stage
of ethical hacking
what we can infer from here is what are
the services that are being run now
these two ports 139 and 445
are actually windows smb server ports
which are
above the windows samba server
now every service has a particular
attached to it that will be consistent
whichever machine you may use apache
server will always run on port 80 smb
servers will function on these two ports
now assembly servers have had a
vulnerability known as the eternal blue
exploit which was pretty well known
as of right now from the scan results we
are not able to detect if this machine
has the similar vulnerability or not
but since it has the smb server open
it's worth a shot that we try that
exploit on this machine
now to start the exploit on this
we're going to open another terminal
over here
and we're going to use metasploit for
trying the exploit there
we're going to write sudo msf console
msf console
is the keyword first launching the
metasploit console
enter the root password and wait for
metasploit to launch
other than the ports we can also see
that it has
checked the hostname of the system
and the operating system as well
now that the metasploit is open
we're going to launch the exploit
now before launching we're going to have
to check what exploits are there for the
eternal blue vulnerability
we're going to write use exploit
blue and we're going to check what kind
of results we are getting over here
as you can see
serial number nine exploit windows smb
ms-17010 internal blue it was first
disclosed in 2017
and assembly remote kernel pool
corruption
let's say we're going to use this
particular exploit
now all of this may be confusing if
you're not aware of metasploit but
remember this is the next stage of
ethical hacking which comes into the
gaining access part
we're going to use
exploit number nine
as we found above
to use exploit number nine
we're going to set a payload
which
is our malicious code that will run
on the vector machine
now we're going to check
some options
as you can see it has by default pointed
it to the 445 port since that is the
port where smb server can be accessed
from
the parameter that's missing over here
is our host
the r host is the ip address of the
vulnerable machine basically the machine
in which we want to attack
now i'm going to use the set command
to set the ip address
now if we check
we now have
a victim ipad set
another parameter that we can change is
the lhost this is basically the ip
address of our own system where we are
going to gain access now if you have
remember
we had connected using a vpn
so we're going to be assigned a new ip
according to the vpn so if we write
ifconfig
and check this one tun0 is the vpn
adapter
this
is our ip address that we have been
assigned in the server in the network
where the vulnerable machine is present
so we're going to copy this ip address
you're going to move over this workspace
and we're going to set lhost
with that ip address
with that our options are set
now we're going to
run exploit
and it's going to check if
samba server vulnerability is present
as you can see it has written that the
target is vulnerable to this particular
exploit
it's going to send the malicious code
and the mauritius code is set in the
payload that is sent above
and we now have the shell command of the
windows machine
as you can see see windows system 32
to be sure that this is in fact this
windows machine that is being used we're
going to write ipconfig
which is a windows only shell command
as you can see
this is the ip address that was assigned
to the victimize victim machine
now
while the major part of this process was
done on metasploit
we would not have reached the stage had
we not found out that the 139 and 445
ports are open which basically pointed
us that we can drive the eternal blue
exploit of the windows samba servers
similarly
all the scans that we run serve as a
preface to the actual stages or the
actual hacking stages of the campaigns
this sv command was necessary because we
could check what are the exact services
that are being running
in some cases if the if apache server is
being run there are particular versions
which have particular exploits those
exploits will not work on other versions
so we're going to have to check what
particular version is being run and
accordingly apply the exploit that can
be done in the metasploit or you can run
some other tool but
what
exact exploit we have to run and which
vulnerability we have to target that is
where nmap comes to help
hope you learned something new today
if you have any questions or doubt
regarding this topic please feel free to
let us know in the comments below and we
will get back to you as soon as possible
subscribe to our channel for more
informative content like this thank you
for watching
hi there if you like this video
subscribe to the simply learn youtube
channel and click here to watch similar
videos to nerd up and get certified
click here