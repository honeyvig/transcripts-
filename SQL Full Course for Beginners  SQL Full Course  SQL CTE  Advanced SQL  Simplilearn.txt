hello everyone Welcome to our SQL full
course if you just starting out or want
to improve your database skills you are
in the right place I'll be your guide
through this course SQL a structured
query language is crucial for managing
and working with databases it's a
valuable skill for careers in data
analysis software development and
database management with SQL you can
interact with databases uncover insights
and make informed data driven decisions
by the end of this course you'll
understand SQL Basics write complex
queries must Advanced topics like joints
and subqueries and learn how to design
and optimize databases you'll be
prepared for real world projects the
course covers an introduction to SQL and
databases basic SQL commands data
manipulation Advanced Techniques
database design and normalization SQL
for data analysis and practical projects
SQL is a powerful tool for managing and
analyzing data and this course will
equip you with the skills you need
trving a career upgrade subscribe like
and comment
below dive into the link in the
description to FasTrack your Ambitions
whether you're making a switch or aiming
higher simply learn has your
back but before that if you're
interested in making a career in data
analytics check out Simply learn post
graduate program in data analytics this
comprehensive course is designed to
transform you into a data analytics
expert this program covers essential
skills such as data visualization
statistical analysis and machine
learning with expert instructors real
world projects and hamon experience
you'll gain the knowledge and confidence
needed to excel in today's data driven
World join now to advance your career
and become a data analytics professional
you can find the Cod Link in the
description box and pin comments in this
session we are going to learn about
databases how data is stored in
relational databases and we'll also look
at some of the popular databases finally
we'll understand understand various SQL
commands on my SQL Server now let's get
started with what is a
database so according to Oracle a
database is an organized collection of
structured information or data that is
typically stored electronically in a
computer system a database is usually
controlled by a database management
system or
dbms so it is a storage system that has
a collection of data relational
databases store data in the form of
tables that can be easily retrieved
managed and updated you can organize
data into tables rows columns and index
it to make it easier to find relevant
information now talking about some of
the popular
databases we have mySQL database we also
have Oracle database then we have mongod
DV which is a no SQL database next we
have Microsoft SQL Server next we have
Apache cendra which is a free and open
source nosql database and finally we
have postgress SQL now let's learn what
is SQL so SQL is a domain specific
language to communicate with databases
SQL was initially developed by
IBM most databases use structured query
language or SQL for writing and querying
data SQL commands help you to store
process analyze and manipulate databases
with this let's look at what a table is
so this is how a table in a database
looks like so here you can see the name
of the table is
players on the top you can see the
column names so we have the player ID
the player name the country to which the
player belongs to and we also have the
goals scored by each of the players so
these are also known as fields in a
database here each row represents a
record or a tle so if you have the
player ID which is 103 here the name of
the player is Daniel he is from England
and the number of goals here scored is
seven so you can use SQL commands to
query update insert records and do a lot
of other tasks now we'll see what the
features of SQL are SQL lets you access
any information stored in a relational
database with SQL queries data is
extracted from the database in a very
efficient way the structured query
language is compatible with all database
systems from Oracle IBM to Microsoft and
it doesn't require much coding to manage
databases
now we will see applications of SQL SQL
is used to create a database Define its
structure implement it and lets you
perform many functions SQL is also used
for maintaining an already existing
database SQL is a powerful language for
entering data modifying data and
extracting data in a database SQL is
extensively used as a client server
language to connect the front end with
the back end th supporting the client
server architecture SQL when deployed as
data control language DCL helps protect
your database from unauthorized access
so let's understand what an ear diagram
is an entity relationship diagram
describes the relationship of entities
that needs to be stored in a database ER
diagram is mainly a structural design
for the database it is a framework made
using specialized symbols to define the
relationship between entities ER
diagrams are created based on the three
main components entities attributes and
relationships let's understand the use
of ER diagram with the help of a real
world example here a school needs all
its Student Records to be stored
digitally so they approach an IT company
to do so a person from the company will
meet the school authorities note all
their requirements describe them in the
form of ear diagram and get it CR
checked by the school authorities as the
school authorities is approve the year
diagram the database Engineers would
carry further
implementation let's have a view of an
year
diagram the following diagram showcases
two entities student and course and the
relationship the relationship described
between student and course is many to
many as a course can be opted by several
students and a student can opt for more
than one course here student is the
entity and it possesses the attributes
that is student ID student name and
student age and the course entity has
attributes such as course ID and course
name now we have an understanding of
year diagram let us see why it has been
so popular The Logical structure of the
database provided by year diagram
communicates the landscape of business
to different teams in the company which
is eventually needed to support the
business year diagram is a GUI
representation of The Logical structure
of of a database which gives a better
understanding of the information to be
stored in a database database designers
can use ER diagrams as a blueprint which
reduces complexity and helps them save
time to build databases quickly ER
diagrams helps you identify the entities
that exist in a system and the
relationships between those
entities after knowing its uses now we
should get familiar with the symbols
used in your diagram the rectangle
symbol represents the entities oval
symbol represents attributes a rectangle
embedded in a rectangle represents a
weak entity a dashed oval represents a
derived attribute a diamond symbol
represents a relationship among entities
double all symbol represents multivalued
attributes now we should dive in and
learn about the components of ER diagram
there are three main components of ER
diagram entity attribute and
relationship entities have weak entity
attributes are further classified into
key attribute composite attribute
multivalued attribute and derived
attribute relationships are also
classified into one to one relationships
one to many relationships many to one
relationships and many to many
relationships let's understand these
components of feia diagram starting with
entities an entity can be either a
living or a non- living component an
entity is showcased as a rectangle in an
diagram
let's understand this with the help of
an near diagram here both student and
course are in rectangular shape and are
called entities and they represent the
relationship study in a diamond shape
let's transition to weak
entity an entity that makes Reliance
over another entity is called a weak
entity the weak entity is showcased as a
double rectangle in ER diagram in the
example below the school is a strong
entity because it has a primary key
attribute School number unlike the
school the classroom is a weak entity
because it does not have any primary key
and the room number attribute here acts
only as a discriminator and not a
primary
key now let us know about attributes
attribute an attribute exhibits the
properties of an entity an attribute is
Illustrated with an oval shape in an ER
diagram in the example below student is
an entity and the properties of student
such as address age name and role number
are called its attributes let's see our
first classification under attribute
that is key attribute the key attribute
uniquely identifies an entity from an
entity set the text of a key attribute
is underlined in the example below we
have a student entity and it has
attributes name address role number and
age but here role number can use
uniquely identify a student from a set
of students that's why it is termed as a
key attribute now we will see composite
attribute an attribute that is composed
of several other attributes is known as
a composite attribute an oval showcases
the composite attribute and the
composite attribute oval is further
connected with other ovals in the
example below we can see an attribute
name which can have further sub parts
such as first name middle name and last
name these attributes with further
classification is known as composite
attribute now let's have a look at
multivalued attribute an attribute that
can possess more than one value are
called multivalued attributes these are
represented as double O
shape in the example below the student
entity has attributes phone number role
number name and age out of these
attributes phone number can have more
than one entry and the attribute with
more than one value is called
multivalued attribute let's see derived
attribute an attribute that can be
derived from other attributes of the
entity is known as a derived attribute
in the ER diagram the derived attribute
is represented by dashed over and in the
example below student entity has both
date of worth and age as attributes here
age is a derived attribute as it can be
derived by subtracting current date from
the student date of birth now after
knowing attributes let's understand
relationship in ER diagram a
relationship is showcased by the diamond
shape in the ER diagram it depicts the
relationship between two entities in the
below example student study course here
both student and course are entities and
study is the relationship between them
now let's go through the type of
relationship first is one to one
relationship when a single element of an
entity is associated with a single
element of another entity this is called
one to one
relationship in the example below we
have student and identification card as
entities we can see a student has only
one identification card and an
identification card is given to one
student it represents a one toone
relationship let's see the second one
one to many relationship when a single
element of an entity is associated with
more than one element of another entity
is called one to many relationship in
the below example a customer can place
many orders but a particular order
cannot be placed by many customers now
we will have a look at many to one
relationship when more than one element
of an entity is related to a single
element of another entity it is called
many to one relationship for example
students have to opt for a single course
but a course can be oped by number of
students let's see many to many
relationship when more than one element
of an entity is associated with more
than one element of another entity is
called many to many
relationship for example an employee can
be assigned to many projects and many
employees can be assigned to a
particular project now after having an
understanding of PR diagram let us know
the points to keep in mind while
creating in the year diagram first
identify all the entities in the system
embed all the entities in a rectangular
shape and label them appropriately this
could be a customer a manager an order
an invoice a schedule Etc identify
relationships between entities and
connect them using a diamond in the
middle illustrating the relationship do
not connect
relationships connect attributes with
entities and label them appropriately
and the attributes should be in Old
shape assure that each entity only
appears a single time and eradicate any
redundant entities or relationships in
the ear diagram make sure your ER
diagram supports all the data provided
to design the database make effective
use of colors to highlight key areas in
your diagrams there are mainly four
types of SQL commands so first we have
data definition language or ddl so ddl
commands change the structure of the
table like creating a table deleting a
table or altering a table all the
commands of ddl are autoc committed
which means it permanently save all the
changes in the database we have create
alter draw up and trunk eight as ddl
commands next we have data manipulation
language or DML so DML commands are used
to modify a database it is responsible
for all forms of changes in the database
DML commands are not autoc committed
which means it can't permanently save
all the changes in the database we have
select update delete and insert as DML
commands now select command is also
referred to as dql or data query
language third we have data control
language or DCL so DCL commands allow
you to control access to data within the
database these DCL commands are normally
used to create objects related to user
access and also control the distribution
of privileges among
users so we have Grant and revoke which
are the examples of data control
language finally we have something
called a as transaction control language
or TCL so TCL commands allow the user to
manage database transactions commit and
roll back our example of TCL now let's
see the basic SQL command
structure so first we have the select
statement so here you specify the
various column names that you want to
fetch from the table we write the table
name using the from statement next we
have the wear Clause to filter out our
table based on some conditions so you
can see here where condition one
condition two and so
on then we have the group by Clause that
takes various column names so you can
write Group by column 1 column 2 and so
on next we have the having Clause to
filter out tables based on groups
finally we have the order by Clause to
filter out the result in ascending or
descending order now talking about the
various data types in
SQL so we have exact numeric which has
integer small smallint bit and decimal
then we have approximate numeric which
are float and real then we have some
date and time data types such as date
time time stamp and others then we have
string data type which includes car the
VAR car and text finally we have binary
data types and binary data types have
binary VAR binary and image now let's
see some of the various operators that
are present in SQL so first first we
have our basic arithmetic operators so
you have addition the subtraction
multiplication division and modulus then
we have some logical operators like all
and any or between exist and so on
finally we have some comparison
operators such as equal to not equal to
that's greater than less than greater
than equal to or less than equal to not
less than or not greater than now let me
take you to my MySQL workbench where we
will learn to write some of the
important SQL commands use different
statements functions data types and
operators that we just learned in this
session we will learn how to install my
SQL workbench and then we will run some
commands firstly we will visit the
official Oracle website that is myql.com
and now we'll move to the downloads page
now scroll down and click on my SQL GPL
downloads now under Community downloads
click on my SQL installer for Windows
the current versions are available to
download I will choose this installer
and click the download
button now here just click on no thanks
just start my
download Once the installer has
downloaded open
it you maybe prompted for permission
click
yes this opens the installer we will be
asked to choose the setup typee we will
go with
custom click
next now you have to select the products
you want to install we will install only
the MySQL server MySQL shell and the
MySQL workbench expand my SQL servers by
double clicking on
it and choose the version you want to
install and click on this
Arrow now you have to do the same thing
for applications expand
applications and choose the MySQL
workbench version you want to install
and click on the
arrow and we'll do the same thing for my
SQL
shell we'll choose the latest version
click on the Arrow these are the
products that have to be installed in a
system now we'll click
next I'll click execute to download and
install the server
this may take a while depending on your
internet
speed as the download is completed click
next now you see the product
configuration click
next now we'll configure our SQL Server
instance here we will go with the
default settings and click
next and under authentication select use
strong password encryption for
authentication which is recommended and
click on
next now here set the password for your
root user by the way root is the default
user this user will have access to
everything I will set my password
now I'll click on
next and here also we'll keep the
default
settings and click on
next now to apply configuration we will
execute the
process once all the configuration steps
are complete click
finish now you will see the installation
is complete it will launch my SQL
workbench and my SQL shell after
clicking on finish
now the shell and workbench has
started now we'll connect by clicking on
the root user it will ask for a password
enter the password and it will connect
successfully
yeah the workbench has started now we'll
just connect the
server so first we'll open command
prompt
now we will reach the path where MySQL
files are
present we go into this
PC local to C program
files my
SQL my SQL Server 8.0 bin and now copy
this
path now look open the command prom and
write a command CD space and paste the
link and press enter now we write
another command type my
SQL minus
u
space root minus p and press enter now
it will ask for your password just enter
the
password and press
enter now the server has started and and
now we'll see some commands in my SQL
workbench first we will open my SQL
workbench now we'll click on the local
instance my SQL 18 and enter the
password to connect to the Local
Host now the my workbench has started
now we will see some
commands the First Command we will see
is show
databases show databases semicolon and
now we'll select the whole command and
click on this execute
button and here we will see the result
in the result
grid these are the databases that are
stored already in the database
now there are four databases that is
information schema my SQL performance
schema and SS now we will select one of
the database we will use uh my
SQL now we have selected the my SQL
database and now in this database we
will see which tables are stored in this
my SQL database to see that we will run
a command show
tables we'll select the command and
click on the execute button these are
the tables that are stored in this my
SQL database that is columns _ PR
component DP and much more now let me
now go ahead and open my MySQL workbench
so in the search bar I'll search for my
SQL workbench you can see I'm using the
8.0 version I'll click on it
and here it says welcome to my SQL
workbench and Below under connections
you can see I have already created a
connection which says local instance
then you have the root the local host
and the port number let me click on
it you can see the service the username
is root and I'll enter my password and
hit okay now this will will open the SQL
editor so this is how the MySQL
workbench looks like here we learn some
of the basic SQL commands so first let
me show you the databases that are
already
present so the command is so
databases you can hit tab to
autocomplete I'll use a
semicolon I'll select this and here you
on the top you can see the execute
button so if I run
this below you can see the output
it says show databases seven rows are
returned which means currently there are
seven
databases you can see the
names all right
now let's say I want to see the tables
that are present inside this database
called world so I'll use the command use
World which is the database name now let
me run it so currently I'm using the
world database so to display the tables
that are present in the world database I
can use the show command and write show
tables give a semicolon and I'll hit
control enter this time to run it all
right so you can see the tables that are
present inside this world database so we
have three tables in total City Country
and Country language now if you are to
see the rows that are present in one of
the tables you can use the select
command so I'll write select star which
basically means I want to display all
the columns so star here means to
display all the columns then I'll write
my
from the table name that is
City so this command is going to display
me all the rows that are present inside
the city table so if I hit control enter
all right you can see the message here
it says th000 rows were returned which
means there were total thousand records
present inside the city table so here
you can see there's an ID column a name
column this country code district and
population all right similarly you can
check the structure of the table by
using the describe command so I'll write
describe and then I'll give the table
name that is City now let's just run it
there you go the field shows the column
names so we have ID name country code
district population
type here shows the data type of each of
the columns so district is character 20
ID is an integer population is also
integer null says yes or no which means
if no then there are no null values if
it's yes which means there are null
values in your table key here represents
whether you have any primary key or
foreign key and these are some extra
information now let's learn how to
create a table in MySQL so I'll use the
create create table command for this and
before that let me create a
database and I'll name it as SQL intro
so the command is
create
database and I'll give my database name
that is SQL
intro me give a semicolon and hit
control enter you can see I have created
a new database now if I run this command
that is show
databases you can see this
newly created database that is SQL intro
if I scroll down there you go you can
see the name here SQL intro okay now
within this database we'll create a
table called employee details now this
will have the details of some employees
so let me first show you how to create a
table that will be present inside the
SQL intro
database so I'll use the command
create
table and then I'll give my table name
that is going to be employee uncore
details
next the syntax is to give the column
names so my first column would be the
name column which is basically the
employee name followed by the data type
for this column since name is a text
column so I'll use
varar and I'll give a value of 25 so it
can hold only 25 characters
okay next I also want the age of the
employee now age is always an integer so
I'll give
int okay then we can have the gender of
the
employee so gender can be represented as
F or m f for female and M for male so
I'm
using the card data type or character
data type and I'll give the value as
one then let's have
the date of join or doj and this is
going to be of data type
date all right next we'll have the city
name that is the city to which the
employee belongs
to so again this is going to be work car
15 finally we'll have a salary
column and salary we'll keep it as float
since salary can be in decimal numbers
as well
now I'll give a semicolon all right so
let me just quickly run through it so
first I wrote my create command then the
table which is also a
keyword followed by the table name which
is employee details here and then we
give the column names such as name AG
this
gender date of join City and
salary for each of the columns we also
give the data type all right so let me
just run it okay so here you can see we
have successfully created our first
table now you can use the describe
command to see the structure of the
table I'll write describe empore
details if I run this there you go so
under field you can see the column names
then you have the data types null
represents if the table can accept null
values or not and these are basically
empty and we haven't set any default
constraint all right moving
ahead now let's learn to add data to our
table using the insert command so on a
notepad I have already written my insert
statement so let me just copy it and
then I'll explain it one by one all
right so if you see this so we have used
an insert into statement or a command
followed by the table name that is EMP
details then this is the syntax using
values I have passed in all the records
so first we have Jimmy which is the name
of the employee then we have 35 which
basically represents the age then m
means the gender or the sex then we have
the date of join next we have the city
to which the employee belongs to and
finally we have have the salary of the
employee so this particular information
represents one record or a
toule similarly the next employee we
have is Shane you can see the age and
other information then we have Mary this
Dwayne Sara and Amy all right so let me
go ahead and run this so this will help
you
insert the values in the table that you
have created you can see we have
successfully inserted six
records now to display the records let
me use the select statement so I'm using
select star from empore
details if I run this you can see my
table here and the values it has so we
have the name column the age column the
state of join City
salary and these are the values that you
can see here moving ahead now let's say
you want to see the Unique city name
names present in the table so in this
case you can use the distinct keyword
along with the column name in the select
statement so let me show you how you can
print the distinct city names that are
present in our table now if you notice
this table
clearly we have Chicago Seattle Boston
Austin this New York and this Seattle
repeated again so I only want to print
the unique values so for that I can
write my select statement as select
distinct then I'll give my column name
which is City from my table name that is
EMP
details if I run this you can
see my query has returned five rows and
these are the values so we have Chicago
cattl which was repeated twice is just
been shown once then we have Boston
Austin and New York now let's see how
you can use
inbuilt aggregate functions in SQL so
suppose you want to count the number of
employees in the table in that case you
can use the count function in the select
statement so let me show you how to do
that so I'll write
select I'll use my function name that is
Count now since I want to know the total
number of employees I'm going to use
their
name inside the brackets
from employee _ detail
now if I run this this will return the
total number of employees that are
present in the table so we have six
employ in total now if you see here in
the result it says count name now this
column is actually not readable at all
so what SQL provides is something called
as an alas name so you can give an alas
to the resultant output so here I can
write select count of name and use an
alas as as
I can give an alas as countor
name and run this statement again there
you go you can see here in the
resultant output we have the column name
as count name which was our alas name
now suppose you want to get the total
sum of salaries you can use another
aggregate function called sum so I'll
write my select statement and this time
instead of count I'm going to write sum
and since I want to find the sum of
salaries so inside the bracket I'll give
my salary column from my table name that
is employee
details if I run this this will result
the total sum of salaries so basically
it adds up all the salaries that were
present in the salary column now let's
say you want to find the average salary
so instead of sum you can write the
average function which is AVG so this
will give you the average salary from
the column salary so you can see it here
this says average salary now if you want
you can give an alas name to this as
well now you can select specific columns
from the table by using the column names
in the select statement so initially we
were selecting all the columns for
example like you saw here the star
represents that we want to see all the
columns from the employee details table
now suppose you want to see only
specific columns you can mention those
column names in the select statement so
let's say I want to select just the name
age and the city
column from my table that is employee
details so this will
result in displaying only the name age
and City column from the table if I run
it there you go it has given only three
columns to me now SQL has a wear Clause
to filter row based on a particular
condition so if you want to filter your
table based on specific conditions you
can use we Clause now where Clause comes
after you give your table name so
suppose you want to find the employees
with age greater than 30 in this case
you can use a we Clause so let me show
you how to do it I'll write select star
from my table name that is employee
details
and after this I'll use my we Clause so
I'll write where
age greater than
30 if I run
this it will give me the output where
the age is only greater than 30 so it
excluded everything that is less than 30
so we have four employees whose age is
greater than 30 here now suppose you
want to find only female employees from
the table you can also use a wear Clause
here so I'll write select let's say I
want only the name the gender which is
sex here comma City from my table that
is employee details where I'll give my
column name that is sex is equal to
since I want only the female employees
I'll give
F and run this statement
okay you can see here our employee table
has three female employees now suppose
you want to find the details of the
employees who belong to Chicago or
Austin in this case you can use the or
operator now the or operator in SQL
displays a record if any of the
condition separated by or is true so let
me show you what I
mean so since I want the employees who
are from Chicago and Austin I can use an
or operat so I'll write select star
from EMP details which is my table name
then I'll give my wear Clause where
City equal to I'll give my city name as
Chicago and then I'm going to use the or
operator or city equal to I'll write
Austin I'll give give a semicolon and
let me run it there you go so in the
output you can see all the employees who
belong to the city Chicago and
Austin now there is another way to write
the same SQL query so you can use an in
operator to specify multiple conditions
so let me just copy this and instead of
using the or operator this time I'm
going to use the in operator so I'll
delete this after the we Clause I'm
going to write where City and use the in
operator inside
bracket I'll give my city names as
Chicago and I want Austin so I'll give a
comma and write my next city name that
is Austin so this query is exactly the
same that we wrote on top let me run
this you will get the same output there
you go so we have Jimmy and Dwayne who
are from Chicago and Austin respectively
now SQL provides the between operator
that selects values within a given range
the values can be numbers text or dates
now suppose you want to find the
employees whose date of join was between
1st of J 2000 and 31st of December
2010 so let me show you how to do it
I'll write select start from EMP details
where my date of join that is
doj
between I'll give my two date values
that is 1st of Jan
2000
and I'll give
my second value the date value that
is 31st of December
2010 so every employee who has joined
between these two dates will be
displayed in the output if I run it we
have two employees who had joined
between 2000 and 2010 so we have Jimmy
and Mary here who had joined in 2005 and
2009
respectively all right now in we Clause
you can use the and operator to specify
multiple conditions now the and operator
displays a record if all the conditions
separated by and are true so let me show
you an example I'll write select star
from employee details
table where I want the age to be greater
than 30 and I want sex to be
male all right so here you can see I
have specified two conditions so both
the conditions are true only then it
will result in an output if I run it you
can see there are two employees who are
male and their age is greater than 30
now let's talk about the group by
statement in SQL so the group by
statement groups rows that have the same
values into summary rows like for
example you want to find the average
salary of customers in each department
now the group by statement is often used
with aggregate functions such as count
sum and average to group the result set
into one or more
columns let's say we want to find the
total salary of employees based on the
gender so in this case you can use the
group by Clause so I'll write
select let's say sex
comma I want to find the total sum of
salary as I'll give an alas name let's
say total
salary
from my table name that is employee
details next I'm going to group it by
sex
okay let me run it there you go so we
have two genders male and female and
here you can see the total salary so
what this SQL statement did was first it
grouped all the employees based on the
gender and then it found the total
salary now SQL provides the order by
keyword to sort the result set in
ascending or descending order now the
order by keyword sorts the records in
ascending order by default to sort the
records in descending order you can use
the DC keyword so let's say I want to
sort my employee details table in terms
of salary so I'll write select star
from
empore
details and I'll use my order by clause
on the salary column so this will sort
all the record
in ascending order of their salary which
is by default you can see the salary
column is sorted in ascending order now
suppose you want to sort the salary
column and display it in descending
order you can use this keyword that is
DEC let me run
it you can see the output now this time
the salary is sorted in descending order
and you have the other values as well
now let me show you some basic
operations that you can do using the
select statement
so suppose I write
select and do an addition operation
let's say 10 + 20 and I'll give an alas
name as
addition if I run this it will give me
the sum of 10 and 20 that is 30
similarly you can
use the subtraction
operator and you can change the alas
name as let's say sub sub ract let's run
it you get minus 10 now there are some
basic inbuild functions there are a lot
of inbuilt functions in SQL but here
I'll show you a few suppose you want to
find the length of a text or a string
you can use the length function so I'll
write select and then use the length
function I'll hit tab to autoc complete
let's say I want to find the length of
country
India and I'll give an Alia as total
length if I run it you see here it
returns five because there are five
letters in India there's another
function called repeat so let me show
you how repeat works so I'll write
select repeat let's say I want to repeat
the symbol that is at the
rate I'll put it in single codes because
it is a text character and I want to
repeat this character for 10 times close
the bracket and let's run it you can see
here in the output it has printed at the
rate 10 times you can count
it all right now let's say you want to
convert a text or a string to upper case
or lower case you can do that as well so
I'll write select and use the function
called upper let's say I want to
convert my string that is India to Upper
ke I'm not giving in any Alias
name if I run this see my input was
capital I and everything else was in
small letter in the output you can see
it has
converted my input to all
caps similarly you can change
this let's say you want to print
something in lower case you can use the
lower function let's say this time
everything is in upper case if I run it
it converts India to lower case now
let's explore a few date and time
functions let's say you want to find the
current date there's a function called
Cur which stands for current and this is
the function I'm talking about which is
current date if I run this you will get
the current date that is 28th of Jan
2021 and let's say you want to extract
the D from a date value so you can use
the D function let's say I'll use D and
I want to find the day from my current
date if I run this you get 28 which is
today's
day now similarly you can also display
the current date and time so for that
you can use a function that is called
now so this will return the current date
and time you can see this is the date
value value and then we have the current
time all
right and this brings us to the end of
our demo session so let me just scroll
through whatever we have learned so
first I showed you how you can see the
databases present in my SQL then we used
one of the databases and checked the
tables in it then we created another
database called SQL intro for our demo
purpose we used that database and
then we created this table called
employee details with column names like
name integer the sex date of joint City
and
salary I showed you the structure of the
database let me run this again so you
get an idea you can see this was the
structure of our
table then we went ahead and inserted a
few records so we inserted records for
six employees so you have the employee
name the age the gender the date of join
the city to which the employee belongs
to and the salary of the employe
then we saw how you can use the select
statement and display all the columns
present in the table we learned how you
can display the Unique city names we
learned how to
use different aggregate functions like
count average and
sum then we learned how you could
display specific columns from the table
we learned how to use we
Clause then we used an R operator we
learned about in operator the between
operator then we used an and operator to
select
multiple
conditions finally we learned about
group by order by and some basic SQL
operations now it's time to explore some
string functions in
MySQL so I have given a comment string
functions first
let's say you want to convert a certain
string into upper Kee so I can write
select the function I'll use is upper
and within this function you can pass in
the string let's say I'll write
India if you want you can give an alas
name as let's say
uppercase I'll give a
semicolon and let's run it there you go
so my input was in sentence case and
using the upper function we have
converted everything into upper case
similarly let me just copy
this and I'll show
you if you want to convert a string into
a lower case you can use the lower
function I'll run this you can see the
result everything is in lower case now
of course I need to change the alas name
to lower
case instead of using lower as the
function function there is another
function that MySQL provides which is
called the L case so I'll just edit this
and write L
case and let's see I'll write India
in uppercase let's run it it returns me
the same
result
cool moving
on let's say you want to find the length
of a string you can use the character
length function
I'll write
select use the function character
length and I'm again going to pass in
my string as India as let's say total
length let's run it this time I'm going
to hit control enter to run my SQL
command there you go it has given us the
right result which is five because India
has five characters in it now these
functions you can also apply on a table
now let me show you how to do it let's
say we already have the students table
and you want to find
the length
of each of the student names so here you
can pass sore
name and you can give the same alas name
let's say total
length and then you can write from table
name that is
students if I run
this you can see the output it has given
me total 20 rows of information is not
readable actually let me also display
these student names so that we can
compare
their
length all right I'll run this
again and now you can see the result so
Joseph has six characters NES has six
vipul has five anubhab has seven
similarly if you see Aki has six tanishk
has seven ragav has six cins has seven
rabada has six so on and so
forth now instead of using this
character length you can also use the
function car
length it will work the same way let's
see the
result there you go go it has given us
the same result you can either use
character length or car
length now there's another very
interesting function called concat so
the concat function adds two or more
Expressions together let's say I'll
write
select use the function
concatenate the function is actually
concat and I'm going to pass
in my
string values let's say
India
is in
Asia let's run this and see our result
you can see here it has concatenated
everything let us make it more readable
I'll give a space in between so that you
can read it clearly now this is much
more readable India is
Asia and if you want you can give an
alas name as well as let's say
merged there you go now the same concat
operation you can also perform on a
table I'm going to use the same students
table let's say I want to return the
student
ID followed by the student
name and then I am going to
merge the student
name followed by a
space followed by the age of the
student and I can give an alas as let's
say name _
age from my table that is
students let's see how this
works okay you see here the result is
very clear we have the student ID the
student name and the concatenated column
that we created which was name
underscore age where we have the student
name with a space followed by the age of
the
student if I scroll down you can see the
rest of the
results
cool now moving
ahead let's see how the reverse function
Works in
MySQL so the MySQL reverse function
returns a string with the characters
printed in reverse order so suppose I
write
select reverse I'll use the same string
again let's say I have
India let's run it you will see all the
characters printed in reverse order
again you can perform the same operation
on a table as well let's say I'll write
select
reverse and I'll pass in column as
student
name from my table that is
students let's run it it gives you 20
students and all the names have been
printed in reverse
order
okay now let's see what the replace
function does so the replace function
replaces all occurrences of a substring
within a string within a new substring
so let me show you what I mean I'll
write
select
replace I'll pass in my input string
which
is let's say orange is
a
vegetable which is ideally incorrect I'm
purposely writing this so that I can
replace
the word
vegetable with
fruit okay so what this replace function
does is it is going to find where my
word vegetable is within the string my
input string and it is going to replace
my word vegetable with fruit let's run
it and see the output there you go now
this is correct which is Orange is a
fruit all
right now MySQL also provides some trim
functions you can use the the left trim
right trim and just the trim function so
let me show you how this left trim
Works left trim or L trim removes the
leading space characters from a string
passed as an
argument so see I write select I'll use
the left trim function which is L trim
and then I'm going to purposely give a
few
Spees in the beginning of the string
I'll give a word let's let's say India
and then I'll give some space after the
word
India and see how the elri works if I
run this it gives me India which is fair
enough but before
that let's first find the length of my
string so I'll use my length function
here and within this function I am going
to find the length of my string which
has India along with some leading and
trailing spaces I'll paste this here
give a semicolon and I'll run
it okay so the entire string is 17
characters long or the length of the
string is 17 now say I use lrim on my
same
string what it returns me is
India and if I run length over it you
can see the difference as in you can see
how many spaces were deleted from the
left of the string you can see here now
it says
17 and I'm going to use
lrim let's see the difference it gives
me 12 the reason being it has deleted
five spaces from the left you can count
it 1 2 3 4 and 5 so 17 - 5 is 12 which
is correct similarly you
can use the rrim function which removes
the trailing spaces from a string
trailing spaces are these spaces when
you use left triim it deletes the
leading spaces which is this now let me
just replace L trim with r trim which
stands for right trim and see the
result so the length is 10 now the
reason being it has
deleted seven spaces from the right of
the string if you can count it 1 2 3 4 5
6 and
7
cool you can also use the trim function
which will delete both the leading and
the trailing spaces so here if I just
write trim and
I'll run it it gives me five because
India is total five characters long and
it has deleted all the leading and the
trailing spaces all
right there's also a function called
position in MySQL the position function
Returns the position of the first
occurrence of a substring in a string so
if the substring is not found with the
original string the function will return
zero so let's say I'll write
select
position I want to find
where fruit is in my string that
is
Orange is a
fruit I'll give an alas as
name there's some error
here this should be within double quotes
now let's run it and see the result okay
it says at the 13th place or at the 13th
position we have the word fruit in our
string which is Orange is a fruit now
the final function we are going to see
is called ask key so the ask key
function Returns the ask key value for a
specific character let's say I write
select ask key of the letter small
a if I run this it will give me the asky
value which is
97 let's say you want to find the S key
value
of
four let's see the result it gives me
52 all right in this session we are
going to learn two important SQL
statements or Clauses that are widely
used that is Group by and having first
we'll understand the basics of group by
and having and then jump into my SQL
workbench to implement these statements
so let's begin first what is Group by in
SQL so the group by statement or Clause
groups records into summary rows and
returns one record for each group it
groups the rows with the same group by
item expressions and computes aggregate
functions for the resulting group a
group by Clause is a part of Select
expression in each group no two rows
have the same value for the grouping
column or columns now below you can see
the syntax of group by so first we have
the select statement and Then followed
by the column names that we want to
select from we have the table name
followed by the we condition and next we
have the group by clause and here we
include the column names finally we have
the order by and the column names now
here is an example of the group by
Clause so we want to find the average
salary of employees for each department
so here you can see we have the
employees table it has the employee ID
the employ employee name the age of the
employee we have the gender the date on
which the employeer had joined the
company then we have the department to
which each of these employees belong to
we have the city to which the employees
belong to and then we have the salary in
dollars so actually we'll be using this
employees table on my SQL workbench as
well so if you were to find the average
salary of employees in each department
so this is how your SQL query with Group
by Clause would look like so we we have
selected department and then we are
using an aggregate function that is AVG
which is average and we have chosen the
salary column and here we have given an
alias name which is average _ salary
which appears in the output you can see
here from employees and we have grouped
it by department so here in the output
you can see we have the department names
and the average salary of the employees
in each department now let me take you
to my MySQL workbench where we'll
Implement Group by and solve specific
problems okay so I am on my MySQL
workbench so let me make my connection
first I'll enter the
password so this will open my SQL
editor so first of all let me check the
databases that I
have so I'll use my query that is show
databases let's run
it okay you can see we have a list of
databases here I'm going to use my SQL
intro database so I'll
write
use SQL intro so this will take us
inside this database I'll run it all
right now you can check the tables that
are present in SQL intro
database if I write show tables you can
see the list of tables that are already
present in this database to do our demo
and understand Group by as well as
having let me first create an employee
table so I'll write create
table
employees next I'll give my column name
as employee unor ID which is the ID for
each
employee I'll give my data type as
integer and I'll
assign employee ID as my primary key
next I'll give employee underscore
name and my data type would be
varar
I'll give the size as
25 my third column would be the age
column age would obviously be an
integer then I
have my gender
column I'll use character data type and
assign a value of one or size of
one next we have the date of join and
the data type will be
date we have
the department column as well this is
going to be of varar and 20 will be the
size
next we have the city
column which is actually the city to
which the employee belongs to
and finally we have
the salary column which will have the
salary for all the employees okay now
let me select and run this you can see
here we have successfully created our
table now to check if our table was
created or not you can use the describe
command I'll write describe
employees you can see the structure of
the team so
far all right now it's time for us to
insert a few records into this employees
table so I'll write insert
into
employees and
I'll copy paste the records which have
already written on a notepad so let me
show
you so this is my EMP notepad and you
can see I have
already put the information for all the
employees so let me just copy
this
and we'll paste it
here all right let me go to the top and
verify if all the records are
fine all right so let's run our insert
query okay so you can see here we have
inserted 20 rows of
information and now let's
check the table information or the
records that are present in our
employees table I'll write select star
from employees if I run it you can see
here I have my employee ID the employee
name age gender we have the city salary
and in total we have inserted 20
records now let me run a few SQL
commands to check how the structure of
our table is let's say I want to see the
distinct cities that are present in our
table so I'll write select distinct City
from
employees if I run this you see here
there are total eight different cities
present in our employees table so we
have Chicago the Seattle Boston we have
New York Miami and Detroit as well
now let's say you want to know
the total number of departments that are
present so you can use dising
Department if I run
this all right you can see we have seven
rows returned and here are the
department names so we have sales
marketing product Tech it finance and
HR all right now let me show
you another SQL command now this is to
use an aggregate function so I want to
find the average age of all the
employees from the
table so I can write select AVG which is
the aggregate function for average
inside that I have passed my age column
from employees if I run this so the
average age of all the employees in our
table is 33.3 5
now say you want to find the average age
of employees in each department so for
this you need to use the group by
Clause I'll give a comment here I want
to find the average age in each
department so I'll write
select
Department
comma I'll write average of
age
from
employees Group
by
department now if I run
this you can see here we have our seven
departments on the left and on the right
you can see the average age of employees
in each of these departments now you can
see here in the output it says AVG of
age which is not readable so I can give
an alas name
as average
age all right I can bring this
down and if you want you can round the
values also so you can round the decimal
places so I'll use a round function
before the average function and the
round function takes two parameters one
is the variable and
the decimal place you want to round it
to so if I run this there you go you can
see here we have the average age of all
the employees in each of these
departments all right now suppose you
want to find the total salary of all the
employees for each department so you can
write
select Department
comma Now I want the total salary so
I'll use the sum
function and and I'll pass my column as
salary
from
employees Group
by
Department let's run this
query you can see here in the output we
have the different departments and on
the right you can see the total salary
of all the employees in each of these
departments now here also so you can
give an alas name as total _
salary let's run it
again and you can see the output
here all right now moving ahead you can
also use the order by Clause along with
the group by Clause let's see you want
to find the total number of employees in
each City and group it in the order of
employee ID so
to do this I can use my select
query I'll write select count of let's
say employee
ID and I want to know the city as well
from
employees Group
by
City And next you can use the order by
Clause I'll write order
by count
of employee
ID and I'll write DEC which stands for
descending if I run this query you can
see here on the left you have the count
of employees and on the right you can
see the city names so in Chicago we had
the highest number of employees working
that was four then we had Seattle
Houston Boston Austin and the remaining
also had two
employees so in this case we have
ordered our result based on the count of
employee ID in descending order so we
have the highest number appearing at the
top and then followed by the lowest okay
now let's explore another example
suppose we want to find the number of
employees that join the company each
year we can use the year function on the
date of joining column then we can count
the employee IDs and group the result by
each year so let me show you how to do
it so I'll write
select I'm going to extract Year from
the date of join column I'll give an
alas as
year
next I'll count
the employee
ID from my table name that is
employees and I'm going to group it
by
Year date of
join I give a
semicolon all right so let's run this
great you see here in the result we have
the year that we have extracted from the
date of join column and on the right you
can see the total number of employees
that joined the company each year so we
have in 2005 there was one employee
similarly we have in 2009 there were two
employees if I scroll down you have
information of other years as well now
if you want you can order this as well
based on year or
count
okay now you can also use the group buy
to join two or more tables
together so to show you this operation
let me first create a sales table
so I'll write create
table sales and the sales table will
have columns such as the product ID
which is going to be of integer type
then we have the selling price of the
product now this will be a float
value then we have the quantity sold for
each of the products so I'll write
quantity
quantity will of integer type next we
have the state in which the item was
sold and state I'll put it as worker and
give the size as
20 let's run this so that we'll create
our sales table all right so we have
successfully created our sales
table next we need to insert a few
values to our sales table so I've have
already written the records in a notepad
let me show
you okay so here you can see I have my
sales text file let me just copy these
information I'll just paste it on the
query
editor okay now let me go ahead
and run this insert command all right so
you can see here we have successfully
inserted nine rows of information so let
me just run it through what we have
inserted so the First Column is the
product ID column then we have the
selling price at which this product was
sold then we have the quantity that was
sold and in which state it was sold so
we have California Texas
Alaska then we have another product ID
which is 1 2 3 and these are the states
in which the products were sold
so let me
just confirm with
the select statement I'll write select
star
from
sales I run this you can see we have
successfully created our
table
okay now suppose you want to find the
revenue for both the product IDs one to
one and let's say 1 to three since we
have just two product IDs here
so for that you can use the select query
so I'll write
select product
ID next I want to calculate the revenue
so revenue is nothing but selling price
multiplied by the quantity so I'll use
the sum function to find the total
revenue and inside the sum function I'll
use my selling price column multiplied
by my quantity column
I'll give this an alas name as
revenue from my table name that is
sales finally I'll group it by product
ID let's run
it there you go so here you can see we
have the two product IDs one 121 and 1
123 and here you can see the
Revenue that was generated from these
two
products all
right now let's
say we have to find the total profit
that was made from both the products 1
to 1 and 1 to 3 so for that I'll create
another table now this table will have
the cost price of both the products so
let me create the table first I'll write
create table let's say the table name is
C product which stands for the cost
price of the
products
I'll give my first column as product
ID this will be an
integer and I'll have my second column
as cost price cost price will have
floating type
values let's run this so we have
successfully created our product cost
table now let me insert a few values
into the C product table so I'll write
insert into
ccore
product I'll give my
values for one to one let's say
the cost price was
$270 for each and next we have my
product as 1 123 and let's say the cost
price for product 1 2 3 was
$250 let's insert these two values okay
next we'll join our sales table and the
product cost table so this will give us
the profit that was generated for each
of the
products so I'll write
select C
do productor
ID comma
I'll write
sum s do cellcore price now here C and S
are alas
names so if I subtract my cost price
from the selling price that will return
the profit that was
generated I'll multiply this with s do
quantity
close the bracket I'll give an alas name
as
profit from sales as s so here s stands
for the sales table I'm going to use
inner
join
ccore product
table as the Alias name should be C
where
here s
do productor ID is equal to C do
productor ID we are using product
underscore ID because this column is the
common column to both the
tables and finally I'm going
to group it
by C do productor
ID all right
so let me tell you what I have done here
so I'm selecting the product
ID next I'm calculating the profit by
subtracting the cost price from the
selling price and I have multiplied the
quantity
column I'm using an inner join to
connect my sales and the product cost
table and I am joining on the column
that is product ID and I have grouped it
by C do product ID let's run this there
you go so here you can see for product
ID 1 to1 we made a profit of
$1,100 and for product ID 123 we made a
profit of
$840 so now that we have learned Group
by in detail let's learn about the
having clause in SQL the having clause
in SQL operates on grouped records and
returns rows where aggregate function
results matched with given conditions
only so now having and wear Clause are
kind kind of similar but where Clause
can't be used with an aggregate function
so here you can see the syntax of having
Clause you have the select statement
followed by the column names from the
table name then we have the we
conditions next we have the group bu
finally we have having and at last we
have order by column names so you can
see here we have a question at hand we
want to find the cities where there are
more than two employees so you can see
the employee table that we had used in
our group by Clause as well so if you
were to find the cities where there are
more than two employees so this is how
your SQL query should look like so we
have
selected the employee ID and we are
finding out the count using the count
function next we have selected the city
column from employees we have grouped it
by City And then we have used our having
Clause so we have given our condition
having count of employee ID should be
greater than two so if you see the
output we have the different city names
and these were the cities where the
count of employees was greater than
two all right so let's go to our MySQL
workbench and Implement how having works
so suppose you want to find those
departments where the average salary is
greater than
$75,000 you can use the having clause
for this so let me first run my table
which is
employees if I run this you can see we
had inserted 20 rows of information and
the last column we had was salary so the
question we have is we want to find
those departments where the average
salary is greater than
$75,000 so let me show you how to do it
so I'll write select
Department
comma I'll use the aggregate function
that is average
salary I'll give an alas name
as
AVG uncore
salary
from
employees next we'll use the group by
clause and I want to group it by each
department
and then I'm going to write my having
Clause so in having Clause I'll use my
condition that is having average of
salary greater than
$75,000 let's run it and see the output
there you go so here you can see there
were total three departments in the
company that is sales finance and HR
where the average salary is greater than
75
$1,000 okay next let's say you want to
find the cities where the total salaries
greater than
$200,000 so this will again be a simple
SQL query so I'll write select City
comma I want to find the total salary so
I'll use the sum function and I'll pass
my colum as salary as I'll give
a alas name as total
from
employees Group by City And then I'm
going to use my having Clause I'll pass
in my condition as having sum of
salary greater than
$200,000 all right so let's run this
query there you go so so the different
cities are Chicago Seattle and Houston
where the total salary was greater than
$200,000 now suppose you want to find
the Departments that have more than two
employees so let's see how to do
it I'll write
select Department comma this time since
I want to find the number of employees
I'm going to use the count function I'll
write count Star as employee uncore
count or empore count which is my alas
name
from
employees next I'll group it by
Department
having I'll give my
condition count star greater than
two let's run
this okay so you have departments such
as sales product Tech and it where there
are more than two
employees okay now you can also use a
wear Clause along with the having clause
in an SQL statement so suppose I want to
find the cities that have more than two
employees apart from Houston
so I can write my query as
select City comma count
Star
as EMP count
from
employees
where I'll give my condition
City not equal
to Houston I'll put it in double
quotes since I don't want to
see the information regarding
Houston I'll group it
by City
having
count of employees greater than
two so if I run this
query you see we have information for
cicago and cattl only and we have
excluded the information for Houston now
you may also use aggregate functions in
the having Clause that does not appear
in the select Clause so if I want to
find the total number of employees for
each department that that have an
average salary greater than $775,000
I can write it something like this so
select
Department
comma
count
Star as EMP
count
from
employees Group
by
department and in the having
Clause I'm going to provide the column
name that is not present in the select
expression so I'll write having average
salary greater than
75,000 this is another way to use the
having Clause let's run this all right
you can see we have Department sales
finance and HR and you can see the
employee count where the average
salary was greater than
75,000
okay so let me run you from the
beginning what we did in our demo so
first we created a table called employee
then we inserted 20 records to this
table next we explored a few SQL
commands like distinct then we used
average and finally we started with our
Group by
Clause followed
by looking at how Group by can be used
along with another table and we joined
two tables that was sales and product
cost table to find out the
profit then you learned how to use the
having Clause so we explored several
different questions and learned how to
use having an SQL in this session we
will learn about joints in SQL joints
are really important when you have to
deal with data that is present on
multiple tables I'll help you understand
the basics of joints and make you learn
the different types of joints with
Hands-On demonstrations on MySQL
workbench so let's get started with what
are joints in
SQL SQL joint statement or command is
often used to fetch data present in
multiple tables SQL joints are used to
combine rows of data from two or more
tables based on a common field or column
between them now consider this example
where we have two tables an orders table
and a customers
table now the order table has
information about the order ID which is
unique here we have the order date that
is when the order was placed then we
have the shipped date this has
information about the date on which the
order was shipped then we have the
product name which basically is the
names of different products we have the
status of delivery whether the product
was delivered or not or whether it was
cancelled then we have the quantity
which means the number of products that
were ordered and finally we have the
price of each product similarly we have
another table called customers and this
customer table has information about the
order ID which is the foreign key here
then we have the customer ID which is
the primary key for this table we also
have the phone number customer name and
address of the customers now suppose you
want to find the phone numbers of
customers who have ordered a laptop now
to solve this problem we need to join
both the tables the reason being the
phone numbers are present in the
customers table as you can see here and
laptop which is the product name is
present in the orders table which you
can see it here so using a join
statement you can find the phone numbers
of customers who have ordered a
laptop now let's see another problem
where you need to find the customer
names who have ordered a product in the
last 30 days in this case we want the
customer name present in the customer's
table and the last 30 days order
information which you can get from the
order date column that is present in the
orders
table okay now let's discuss the
different types of joints one by one so
first we have an inner
join so the SQL inner join statement
returns all the rows from multiple
tables as long as the conditions are met
from the the diagram ADB you can see
that there are two tables A and B A is
the left table and B is the right table
the orange portion represents the output
of an inner join which means an inner
join Returns the common records from
both the tables now you can see the
syntax here so we have the select
command and then we give the list of
columns from table a which you can see
here is the left table followed by the
inner joint keyword and the then the
name of the table that is B on a common
key column from both the tables A and B
now let me take you to the MySQL
workbench and show you how inner join
Works in reality so here I'll type
MySQL you can see I have got my SQL
workbench 8.0 version installed I'll
click on
it so it will take some time to
open okay okay I'll click on this local
instance and here I'll give my
password
okay so this is how an SQL editor on my
SQL workbench looks like so first of all
let me go ahead and create a new
database so I'll write
create database this is going to be my
command followed by the name of the
database that is going going to be SQL
joins if I give a semicolon and hit
control enter this will create a new
database you can see here one row
affected now you can check whether the
database was created or not using show
databases command if I run it here you
can see I have SQL joints
database created now I'll use this
database so I'll write use SQL unor
joints
okay now to understand inner join
consider that there is a college and in
every College you have different teams
for different sports such as Cricket
football basketball and others so let's
create two tables cricket and football
so I'll write
create
table and my table name is going to be
Cricket next I'm going to create two
columns in this table the First Column
is going to be
cricet
ID
then I'm going to give the data type as
int and use the autoincrement
operator I'm using Auto increment
because my cricet ID is going to be my
primary
key then I'm going to give the name of
the students who are part of the cricket
team and for this I'll use war card data
type and give the length as
30 I'll give another comma and I'll
assign my Cricket ID as primary key
within brackets I'll
give cricet
ID Cricket ID is nothing but a unique
identifier for each of the players like
you have role numbers in
college okay let me just run it all
right so we have successfully created
our cricket table
similarly let me just copy this and I'll
paste it here I'll
create another table called
football this will have the information
of all the students who are part of the
football team and instead of cricket I
am going to give this as football
ID all right
and the name column will have the names
of the students I'll change my primary
key to football
ID all right let me run this okay so now
we have also created
our football table the next step is to
insert a few player names into both the
tables so I'll write my insert into
command first let's load some data to
our cricet table so I'll write cricet
and I'll give my name column follow
by values and here I'll give some names
such as let's say
Stuart we give another
comma the next player I'll choose is
let's say
Michael similarly I'll add a few more
let's say we have
Johnson the fourth player I'll take is
let's say
hidden and finally we have
let's say
flaming
okay now I'll give a semicolon and run
this okay so let me just check if all
the values were inserted properly for
this I'll use select star from table
that is cricet if I run it you can see I
have created a table and have
successfully
inserted five rows of information
now
similarly let's
insert a few student
names for our football table so I'll
change this
to
football and obviously there would be
students who will be part of both
cricket and football team
so I'll keep a
few repeated names let's say Stuart John
Johson and let's say Hayden are part of
both cricket and football team then we
have let's
say Langer
and let's say we have another player in
the football team that is
astral I'll just run it okay you can see
there are no errors so we have
successfully inserted values to our
football team as well let me just
recheck it I'll write select star
from
football all right so we have five
players in the football team as well
okay now the question is suppose you
want to find the students that are part
of both the cricket and football team in
this case you can use an inner join so
let me show you how to do it so I'll
write select star
from
cricket as I'm using using an alas name
as C which stands for Cricket then I'm
going to write inner
join my next table is going to be
football as F which is an alas name for
the football
table then I'm going to use the
on command or
operator and then I'll give the
common key that is name here so C do
name is equal to F do name
So based on this name column from both
the table my inner John operation will
be performed so let's just run
it there you go so Stuart Johnson and
Hayden are the only three students who
are part of both the teams all
right now you can also individually
select each of the columns from both the
tables so let's say I write select C do
ccore ID comma C do name comma F do
foore ID comma f.
name from I'll write Cricket as
C inner
join football as F on C do name is equal
to F do name
now if I run this you see we get the
same output here as well all
right now let's explore another example
to learn more about inner joints so we
have a database called classic models
let me first use classic
models I'll run this okay now let me
just show the different tables that are
part of classic tables
all right so here you can see there are
tables like customers there's employees
office there's office details orders
payments products and product lines as
well all right
so let me
use my select statement to
show what are the columns present in the
products table
okay so this product table has
information about different product
names you have the product code now this
product code is unique
here we also have the product
vendor a little description about the
product then we have the quantity in
stock buying price and
MSRP let's see what we have
in product lines
if I run it you see here we have the
product line which is the primary key
for this table then we have the textual
description for each of the products
this is basically some sort of an
advertisement all right now suppose you
want to find the product code the
product name and the text description
for each of the products you can join
the products and product lines table so
let me show you how to do it I'll write
my select statement
and choose my columns as product code
then we
have product name and let's say I want
the text description so I'll write this
column name okay then I'll use
from my first table that is
products inner
join product lines
I can use
using the common key column that is
product
line close the bracket I'll give a
semicolon and if I run it there you go
so you can see the different product
codes then we have the different product
names and the textual description for
each of the products so this we did by
joining the products table and the
product lines table all
right now suppose you want to find the
revenue generated from each product
order and the status of the product to
do this task we need to join three
tables that is orders order details and
products so first let me show you what
are the columns we have in these three
tables we have obviously seen for the
products table now let me show you for
orders and Order details table so I'll
write select star from orders if I run
it you can see it has information about
the order
number the date on which the order was
placed we also have the shipment date we
also have the status column which has
information regarding whether the order
was shipped or
cancelled then we have some comments
column we also have the cust customer
number who ordered this particular
product similarly let's check what we
have under order
details so I'll write select star from
order details if I run it you can see it
has the order number the product code
quantity of each product we have the
price of each product then we have the
order line number okay so using the
product or orders and Order details
let's perform an inner join so I'll
write
select o
do order
number comma o do
status
comma I need the product name which I'll
take from the products table so I'll
write P do product name now here o p are
all alas name for the tables orders
products and I'll use use OD for order
details comma since we want to find the
revenue we actually need to find the
product of quantity ordered into price
of each product so I'll use a sum
function and inside the sum function
I'll give
quantity
ordered multiplied by the price of each
item I'll use an alas as
Revenue then I'll use my from
Clause from orders as
o inner
join
order details as I'll use an alas name
as
OD
on I'll write o
do order number
is equal to OD
dot order
number I'll use another inner join and
this time we'll join the products table
so I'll write inner join products as p
on P
do product
code is equal to UD do product
code and finally I'll use the group by
clause and group it by order
number all right let me run this okay
there's some mistake here we need to
debug this it says you have an error in
your SQL syntax check the manual all
right okay I think the name of the
tables is actually orders or not order
all right now let's run it okay there's
still some error it
says classic models. product doesn't
exist so again the product name is I
mean the table name is products and not
product so let's run it again all right
there you go so we have the order number
the status the product name and the
revenue
this we got it using inner joint from
three different tables now talking about
left
joins the SQL left join statement
returns all the rows from the left table
and the matching rows from the right
table so if you see this diagram you can
see we have all the rows from the left
table that is a and only the matching
rows from the right table that is B so
you can see this overlapped region
and the
Syntax for SQL left join is something
like this so you have the select
statement and then you give the list of
columns from table a which is your left
table then you use the left join
keyword followed by the next table that
is table B on the common key column so
you write a do key is equal to B do key
okay now in our classic models database
we have two tables customers and orders
so if you want to find the customer name
and their order ID you can use these two
tables so first let me show you the
columns that are present in customers
and orders I think orders we have
already seen let me first show you
what's there in the customers table okay
so you can see we have the customer
number the name of the customer then we
have the contact last name the contact
first name we have the phone number then
there's an address column there are two
address columns
actually we have the city name the state
and we have
other information as well and similarly
we have our orders table so I'll write
select start from orders so I'll write
select star from orders if I run this
you can see these are the information
available in the orders
table okay so let's perform a left join
where we want to find the customer name
and their order IDs so I'll write select
C
do customer name or let's say first
we'll choose the customer number
comma then I want the customer name so
I'll write C do customer
name then we have the order number
column which is present in the orders
table and let's say I also want to see
the
status then I'll give my left table that
is
customers as
C left
join orders as o
on C
do customer number equal to O do
customer
number let's run it okay again there is
some problem all right so the table name
is
customers let's run
it so there's another mistake here this
is customer number so B is missing cool
let me run it all right so here you can
see we have the information regarding
the customer number then the respective
customer names we have the order number
and the status of the shipment so if I
scroll down you'll notice one thing
there are few rows you can see which
have null values this means for customer
number 125 and for this particular
customer name there were no orders and
similarly if I scroll down you will find
a few more null values you can see here
there are two null values here for
customer number 168 and 169 there were
no orders
available all right now to check those
customers who haven't placed any orders
you can use the null operator so what
I'll do is here I'll just continue with
this I'll use a wear clause and write
where order number is
null now let me run this okay so here
you can see there
are 24 customers from the table that
don't have any orders in their
names okay now talking about right joins
so SQL right join statement returns all
the rows from the right table and only
matching rows from the left table so
here you can see we have our left table
as a and the right table as B so the
right join will return all the rows from
the right table and only the matching
rows from the left
table now talking about the syntax so
here you can see we have the select
statement followed by the select
statement you'll have the list of
columns that you want to choose
from table a right join table B on the
common key column from both the tables
all
right now to show how right join works
I'll be using two tables that is
customers and employees so let's
see the rows of data that are present in
the customer table first so I'll write
select star from
customers let's run it so here you have
the customer number the customer name
then we have the phone number the
address of the customers you also have
the country to which the customer
belongs to the postal
code and the credit limit as well
similarly let's see
for the employees
table here I'll change customers to
employees let's run it okay so we have
the employee number the last name the
first name you have the extension the
email ID the job title and
also reports to here means the
manager okay so based on these two
tables we'll find the customer name the
phone number of the customer and the
email address of the employee and join
both the tables that is customers and
employees so let me show you the command
so I'll write select C
do customer name comma then we have C C
do phone I'll give a space here next I
want the employee number from the
employee table so I'll write e
do employee number comma e do email from
customers as C right
join
employees as
e on
e do my common key column is employee
number here so I'll write e do employee
number is equal to C dot we
have
sales
representatives employee
number and I'm also going to order it
by the employee number column
okay so you can see I have my customer
name selected from the customer table
the phone number of the customer then we
have the employee number and the email
address so let me run
it okay there's some problem all right
so the table name is customers
actually let's run it once
again there you go so you can see here
we have
all the values selected from our right
table which is the employees table you
can see right on employees which means
your employees table is to the right and
then we have the customer name and phone
numbers of the customers from the
customer table which is actually your
left table so you have a few employee
numers such as one2 this 1056 which
don't have any customer name or phone
numbers okay so there's another pop join
which is very widely used in SQL known
as self joins so self joins are used to
join a table to itself so in our
database we have a table called
employees let me show you the table
first all right so here you can see we
have the employee number the last name
the first name of the employee we have
the email ID and here if you see we have
a column called reports 2 now this you
can think of as the manager column so
the way to read is for example for
employee number
1056 the manager is one2 so if you check
for one2 we have Dane
Murphy then if I scroll down let's say
for employee number
1102 yeah for employee number 1102 the
manager is 105 56 so here you can see
who is at 1056 you have Mary
Patterson similarly if I scroll down
let's say for employee number
1188 we
have the manager as
11 43 now if I check the table at 1143
we have Anthony B so so the employee
Julie feli reports to Anthony B
all right now suppose you want to know
who is the reporting manager for each
employee so for that you can use a self
join so let me show you how to join this
employees table I'll write
select and then I'm going to use a
function called
concat within brackets I'll start with
my alas name that is m dot then I'll
write last
name I'm going to concat last name
followed by a comma then I'll have my
first
name I'll close this bracket and then
I'm going to give my alas name let's say
manager comma next I'm going to
concat the same last name and first name
and this time I'm going to use a
separate alas let's say e which stands
for employee so I'll write e do last
name comma and within single
codes
I'll give my comma and then I'll write e
do first
name I close this bracket I'll give an
alas as let's
say
employee from I'll wrun
write
employees as
e inner
join
employees as M on m
dot I'll use my common key column as
employee number so I'll write M
do employee number is equal to e do here
I'm going to use the reports 2
column and
then
I'll order it
by let's say
manager okay now let's run
this there you go so you have your two
columns as manager and employee so for
employee Louie
bonder the manager is zarad bonder
similarly if I scroll down you have
there are multiple employees reporting
to this particular manager similarly we
have our manager as Anthony bow and we
have different employees who are
reporting to this particular manager and
so
on all right now moving
ahead now let's see what a full join is
so SQL full outer join statement returns
all the rows when there is a match in
either left right table now you must
remember that MySQL workbench does not
support full outer join by default but
there's a way to do it so by default
this is how the syntax of full outer
join looks like now this statement will
work on other SQL databases like
Microsoft SQL server but it won't work
on MySQL workbench I'll show you the
right way of using full auto join on my
SQL
workbench so to sew full outer join I'm
going to first use a left join and then
we'll also use a right join and finally
we'll use a union operator so the union
operator is used to combine the result
set of two or more select statements so
first of all let me
write C do customer name so for this
example I'm using the customer table and
the order
table comma o
do order number so I just want to know
the customer name and the order number
related to the
customer
from I have
customers
as
C left
join I'll write orders as o on C
do customer
number is equal to o do customer
number let me just copy
this and after this I'm going to use my
union
operator so Union operator is used to
merge results from two or more
tables so basically this performs a
vertical join and next I'm am going to
use my right join operation so here
instead of left join I'll write
right rest all looks fine let me just
run
it there you go so we have successfully
run our full outer join operation you
can see we have the different customer
names and the order that each customer
had
placed all right so that brings us to
the end of our demo session so let me
just run through whatever we did in this
session
so first we created a database called
SQL joints then we created two tables
like cricket and football then we had
inserted a few rows to each of these
tables then we used this table to learn
about inner join next we used a database
called classic models it had multiple
tabl so we explored all of these tables
like products there was product lines
orders customers and employees and
learned
how to use inner join left join self
join right join as well as full outer
join in this video we will learn what is
a subquery and look at the different
types of subqueries then we'll learn
subqueries with select statement
followed by subqueries with insert
statement moving further we will learn
subqueries with the update statement and
finally we look at subqueries with
delete statement all this we will be
doing on our MySQL workbench
so before I begin make sure to subscribe
to the simply learn Channel and hit the
Bell icon to never miss an update so
let's start with what is a
subquery so a subquery is a select query
that is enclosed inside another query so
if I show you this is how the basic
structure of a subquery looks like so
here whatever is present inside the
brackets is called as the inner query
and whatever is present outside is
called the outer query so first the
inner query gets executed and the result
is returned to the outer query and then
the outer query operation is
performed all right now let's see an
example so we have a question at hand
which is to write a SQL query to display
Department with maximum salary from
employees table so this is how our
employees table looks like it has the
employee ID the employee name age gender
we have the date of join Department City
and salary now to solve this
query my my subquery would look like
this so I'll first select the department
from my table that is employees where
I'll use the Condition salary equal to
and then I'll pass in my inner query
which is Select Max of salary from
employees so what this does is it will
first return the maximum salary of the
employees in the table then our outer
query will get executed based on the
salary returned from the inner query so
here the output is department sales has
the maximum salary so one of the
employees from the sales department
earns the highest of the maximum salary
if you see in our table the employee is
Joseph who earns
$115,000 all right and Joseph is from
the sales
department now let's see how this query
works so here we have another question
which is to find the name of the
employee with maximum salary in the
employees table so this is our previous
employees table that we saw and to find
the employee who has the maximum salary
my subquery would look something like
this so I'm selecting the employee name
from my table that is employees where
I'm using the Condition salary equal to
and then I'm passing in my subquery or
the inner query so first I'm selecting
the maximum salary this will return a
particular value that is the highest
salary from the table and if you see our
table the highest salary is
$115,000 so our query becomes select
employee name from employees where
salary equal to $115,000 so the employee
name is Joseph here and that's the
output now if you want to break it down
here you can see first the inner query
gets executed so our SQL query will
first execute the inner query that is
present inside brackets select maximum
salary from employees the result is
$115,000 and then based on the return
result are out query gets executed so
the query becomes select employee name
from employees where salary equal to
$115,000 and that employe is
Joseph all right now we'll learn the
different types of subqueries so you can
write subqueries using select statement
update statement delete and insert
statement we'll explore each of this
with the help of example on my my SQL
workbench so let's learn sub queries
with the select statement
so subqueries are majorly used with the
select statement and this is how the
syntax looks like you select the column
name from the table name then you have
the wear condition followed by The
Columns that you want to pass the
operator and inside that you have this
subquery so here is an example that we
will perform on our MySQL workbench so
in this example we want to select all
the employees who have a salary less
than average salary of for all the
employees this is the output so let's do
this on my MySQL
workbench all right so let me log into
my local
instance I'll give my
password okay so you can see I'm on my
MySQL workbench so let's start by
writing our subquery using the select
statement okay so for this demo session
we'll be using a database that is
subqueries you can see it here I have a
database called
subqueries so
I'll use this subqueries database and
we'll create a few tables as
well okay if I run
it now we are inside the subqueries
database
so let me just show you the tables that
are present inside this database I'll
write show
tables if I run it okay there are two
tables employees and employees unor B uh
we'll use this table throughout our demo
session all right now for our select
subquery we want to fetch the employee
name the department and the salary whose
salary is less than the average salary
so we will be using the employees table
so let me first show you the records and
the columns we have in the employee
table so I'll write select star from
employees and run it okay you can see
here we have 20 rows of information we
have the employee name the employee ID
age gender date of join Department City
and salary so this is the same table
that we saw in our
slides okay now for our subquery I'll
write select I want to choose the
employee
name the
department and the salary
there should be a comma here instead of
a
period next I'll give my table name that
is
employees
where my salary is less than and after
this I'll start my inner query or the
subquery I'll write
select average salary so I'm using the
AVG function to find the average salary
of all the employees
from my table that is
employees if I give a
semicolon and run
this you'll see the output so we have
total 12 employees in the table whose
salary is less than the average salary
now if you want you can check the
average
salary so the average salary is
$753 now the employees who have a salary
less than the average salary
so these are the
people all right now moving back to our
slides okay now let's see how you can
use subqueries with the insert
statement now the insert statement uses
the data return from the subquery to
insert into another table so this is how
the syntax looks like so you write
insert into table name followed by
select individual column so start from
the table use the wear clause and then
you give the operator followed by the
inner query or the
subquery so here we will explore a table
called products table we are going to
fetch few records from the products
table based on a condition that is the
selling price of the product should be
greater than $100 so only those records
will fetch and put it in our orders
table all
right so we are going to write this
query on my MySQL workbench so let's do
it I'll give my comment
as update
subquery all right so first of all let's
create a table that is products so I'll
write create
table
products then we'll give our column
names the First Column would be the
product ID of type
integer then we have the column as item
or the
product which is of type Vare
30 next we have the selling price of
that product the selling price will be
of type
float and finally we have
another column which is called the
product
type and again product type is of the
data type bar car I'll give the size as
30 close the bracket and give a
semicolon
now let's just run
it okay so we have successfully created
our products
table now let's insert a few records to
our products table so I'll write insert
into
products followed by
values I'll
give four records the first product ID
is
101 the product
is let's say jewelry
then the selling price is let's say
$800 and the product type is it's a
luxury
product next let's insert one more
product detail the product ID is
102 the
product is let's say
t-shirt the price is let's say
$100 and the product type is non-luxury
[Music]
next I'll just copy this to reduce our
task we'll edit this the third product's
ID is
103 the product is
laptop and let's say the price is
$1,300 and it's a luxury
product I'll paste again and finally
I'll enter my fourth product which is
let's
say
table and the price is
$400 and it's a non-luxury
product I'll give a semicolon and we'll
insert these four records to our product
table you can see we have inserted four
records let's just print it now so I'll
write select star
from products
if I run it you can see we have our four
products
ready
now we need to create another table
where we are going to put some
records from our products table so that
new table is going to be the orders
table so I'll write create table
orders now it will have three columns
the order ID
order ID will be of type integer then we
have
product underscore sold this will be of
type varing character of size 30 and
finally we have the selling price
column this will be of type
float let's create our orders
table the table name should be orders
and there is some mistake here okay
should close the brackets okay let me
run it so we have our orders table ready
now let's write our insert
subquery so I'm going to insert
into my table that is
orders and I'll
select the product
ID comma the item
and the selling price or the sell
price
from my table that is
products
where I'll write product ID
in I'll write my inner query
select prodad ID or the product
ID from
products next I'll give a where Clause
where the selling
price is greater than
$1,000 so let me tell you what I'm going
to do here I'm going to insert into my
ords table the product ID the item name
and the selling price from my product
table where the product
ID has this condition so let me first
run this condition for you which is
Select PR ID from products where the
selling price is greater than 1,000
if I run this okay there is some issue
here the column name is actually prodad
ID now let's run it again so that we can
see the product IDs of the products
which have a selling price greater than
1,000 so it is 101 and 103 now let's run
the entire
query there is another mistake here
let's debug the mistake now this should
be product ID instead of productor
in let's insert again all right so we
have successfully inserted two records
to our table that is orders now let's
see the orders table I'll write select
star from
orders if I run it there you go so there
were two products from our product table
that were jewelry and laptop which have
a selling price greater than $1,000 so
the selling price for jewelry was $1,800
and for laptop it was
$1,300 so this is how you can use a
subquery using the insert statement all
right now going back to our slides again
all
right now let's see how you can use
subqueries with the update statement now
the subqueries can be used in
conjunction with the update statement so
either single or multiple columns in a
table can be updated when using a
subquery with the update statement so
this is how the basic syntax of an
update subquery looks like so you write
update table followed by the table name
you set the column name you give the we
operator and then you write your inner
subquery so we are going to see an
example where we will use this employes
table and using this employees table we
will update the records of the salaries
of the employees by multiplying it with
a factor of. 35 only for those employees
which have age greater than
27 so we are going to use a new table
called employees B for this as well so
let's see how to do
it so I'll give my comment
as update
subquery before we see the subquery
let's see what we have in the table
employees
B this is basically a replica of the
employees table there you go it has the
same records that our employees table
has we are going to use both the
employees table and the employees _ B
table to update our records so I'll
write
update
employees set salary equal to let me
bring this to the next
line I'll write set salary equal to
salary multiplied by
35
where age
in then I'll write select age from my
other table that is employees uncore
B where age is greater than equal
to let's say
27 all
right so let me run through this query
and tell you what we are are going to do
so I'm going to update the records of
the employees table specifically for the
salary column so I'm checking if the age
is greater than 27 then we'll multiply
the salaries of the employees with a
factor of. 35 in the employees table let
me just run this then we'll see our
output okay so it says 18 rows affected
which means there are total 18 employees
in the table out of the 20 employees
whose AG is greater than 27 now if you
see I'll write select star from
employees you can see the difference in
the
salaries if I scroll to the right you
can see these are the updated
salaries
okay now if you check for employees who
have an age less than or equal to 27 for
example Markus whose age is 2 5 his
salary is the same we haven't updated
his salary then if you see if you have
okay there is one more employee Maya we
haven't updated the salary of Maya
because the age is less than
27 all
right now let's go back to our slides
again as you can see we got the same
output on our my SQL workbench now let's
explore
how you can write subqueries with the
delete
statement now subqueries can again be
used in conjunction with the delete
statement so this is how the basic
syntax of a delete query using subquery
would look like you write delete from
the table name where Clause the operator
value followed by the inner query in
within
brackets so here we are going to use the
employees table and what we are going to
do is we'll delete the employees whose
age is greater than equal to 27 so let's
see how you can do
it all right so I'll give my comment
as delete
subquery so we'll follow the syntax that
we saw I'll write
delete
from my table name that is
employees I'll write where age in and
then I'll start my inner query or the
subquery I'll write select age
from employees uncore B where AG is
let's say greater than equal to 32 or
let's say the AG is less than equal to
32 close the bracket and I'll give my
semicolon let me first run the inner
query for you so that you get an idea of
the employees who are less than 32 years
of age so there are nine employees in
the table who have an age less than
equal to 32 so we are going to delete
the records if I run
this okay it says nine records deleted
now
let's print or display what we have in
the employees table
if I run
this there you go so if you see the age
table we have total 11 employees now and
all their ages are greater than 32
because we have deleted all those
employees who had an age less than equal
to 32
okay so let me show you from the
beginning what we did so first we used
our subqueries database then we used our
employees table
so we started by looking at how you can
use the subquery with a select statement
this should be insert instead of
update so we learned how to write an
insert subquery we use two tables
products and our orders
table moving ahead we saw how to write
subqueries using the update command so
we updated the salaries of the employee
by a factor of. 35 for those who had an
age greater than equal to 27 and finally
we saw how to use the subquery using the
delete statement so we deleted all those
records for the employees whose age was
less than equal to 32 so let's start
with what is normalization normalization
in DPMS is a method used to organize
data within database to reduce
repetition by breaking down large data
sets into smaller more manageable tables
and ensuring these tables are properly
related
normalization helps prevent issues like
data rency data rency means the
unnecessary repetition or duplication of
data within a database for example when
a same piece of data is stored in
multiple places it can lead to
inconsistencies and take up more stored
space than needed for example Data rency
before normalization you can see the
table mentioned above where we have
order ID customer idid customer name
customer address product and quantity
you might see some of the data which is
being repeated again and again in the
above table the customer address for
John do is repeated three times let's
suppose if John do moves to a new
address every occurrence of his address
in the table must be updated if any
instances missed during the update it
leads to inconsistencies and errors can
occur in the database the solution is
reducing the rency through normalization
let's check it out how so you can see
this is the normalized table we have
created first is the normalized customer
table and then we have the order table
so what are the benefits of
normalization the address for joho is
stored only once in the customer table
if joho's address changes it needs to be
updated in one place ensuring
consistency through the database this
reduces the risk of errors and maintains
data Integrity the process involves
multiple steps that transform data into
a tabular format removing duplicates and
establishing clear connections between
different tables making the database
more efficient and reducing problems
like errors during data insertion
updates or deletion let's now discuss
the types of dbms normal forms
normalization rules are categorized into
different normal forms the first one is
one and if for a table to be in first
normal form it must satisfy the four
rules single valued Atomic attributes
each column should contain only one
value per row this means that the there
should be no repeating groups or arrays
within a single column same domain
values all values stored in a specific
column should be of the same data type
or domain for example if a column is
meant to store dates all values in that
column should be dates then we have
unique column names each column in the
table should have a unique name this
ensures Clarity and avoids confusion
when referring to a specific column then
we have order of of data which doesn't
matter the order in which rows are
stored in the table should not affect
the data or its Integrity let's check
the example of the first normal form
consider the following unnormalized
table customer ID customer name and the
phone numbers as you can see the phone
numbers are repeated twice the problems
with the original table is the nonatomic
values the phone numbers column contain
multiple phone numbers separated by
commas which violates the atomicity rule
of one F converting to First normal form
to bring this table into one and F we
must ensure that each column contains
only Atomic value this involves
splitting the rows where there are
multiple phone numbers as you can see we
have splitted the data each row now has
a single phone number ensuring that the
phone number column contains Atomic
value same domain names all the values
in the phone number column are
consistent in format and type all are
phone numbers then we can see that the
unique column names The Columns customer
ID customer name phone number which has
unique name satisfying the requirement
order of data the order in which the
rules appear does not matter as the
data's meaning and integrity are
preserved by applying these rules the
table now confirms the first normal form
eliminating any rency related to the
four numbers and ensuring data is stored
in a more organized and efficient manner
let's go through each of these database
normal forms step by step with simple
examples to help you grasp the concepts
more easily let's talk about the second
normal form for a table to be in second
normal form it must satisfy the
following condition number one it must
be in one and F number two no partial
dependency every non-key attribute
should be fully dependent on the entire
primary key not just part of it this
rule applies primarily to tables with
composite primary Keys example of second
normal form is consider the following
table that is in one NF the order ID
product ID product name quantity and the
supplier name the problems with this
table is that the partial dependency the
product name and the supplier name
depend only on product ID not the entire
primary key which is order ID and
product ID this violates 2 andf
converting to Second normal form to
bring the table into 2nf we separate the
data into two tables to remove part IAL
dependencies order table and the product
table no partial dependency in the order
table quantity is fully dependent on
both order ID and product ID in the
product table product name and supplier
name are dependent only on the product
ID this ensures that each non-key
attribute is fully dependent on the
primary key bringing the tables into 2
andf let's now talk about the third
normal form 3nf for a table to be in
third normal form it must satisfy the
following condition
number one it must be in 2nf number two
there should be no transitive dependency
where nonk attributes depend on other
non-key attributes rather than the
primary key let's check out the example
of a third normal form consider the
following table that is in 2nf the
problems with the 2nf table is that the
transitive dependency the instructor
name is dependent on the course name
which is not directly on student ID or
course ID and this violates 3nf so how
how do we convert this into 3 andf to
achieve 3 andf we split the table to
remove the transitive dependency student
course table and course table no
transitive dependency now the student
course table there are no non-key
attributes depending on other non key
attributes the course Table stores the
course and instructor information
separately this structure eliminates
transitive dependency ensuring the
tables conform to 3 and F let's now talk
about the boys called normal form which
is bcnf bcnf is an extension of the
third normal form 3nf a table is in bcnf
if it is in 3nf and for every functional
dependency a implies to B A should be a
Super Key let's check out the example of
a boys Squad normal form bcnf so you can
see this table here consisting of
employee ID department and the manager
the problem with this table is that the
PCN a violation in this table Department
determines manager but department is not
a super key since employee ID is the
primary key this violates bcnf so how do
we convert this to bcnf to achieve bcnf
we split the table to ensure that every
determinant is a Super Key as you can
see the employee table and the
department table the Super Key
requirement in the employee table
employee ID is the primary key and in
the department table department is now
the primary key the decomposition
ensures that every functional dependency
is Satisfied by a Super Key meeting the
requirements of bcnf let's now talk
about the fourth normal form which is
4nf a table is set to be in 4nf if it is
in bcnf and has no multivalue
dependencies so let's consider an
example of a fourth normal form consider
a table where an employee can have
multiple skills and work on multiple
projects as you can see the employee ID
skill and the project the problem with
this table is that it is multivalue
dependency an employee skill is
independent depent of the project but
both are stored in the same table this
leads to multivalue dependency violating
forf so in order to achieve 4nf we
separate the skills and the projects
into different tables the employee skill
table and the employee projects table
and now you can see that no multivalue
dependency by separating the skills and
the projects we eliminate multivalue
dependencies ensuring the table conform
to for and let's now talk about the
fifth normal form the employees skill
table and the employee projects table so
as you can see that no multivalue
dependency is there by separating the
skills and the projects we eliminate
multivalue dependencies ensuring the
tables conformed to four and F now let's
talk about the fifth normal form which
is five and f a table is set to be in
fifth normal form if it is in for enough
and cannot be decomposed into any
smaller tables losing information also
known as joint dependency let's consider
an example of a fifth normal form this
is a table here that records the
relationship between suppliers parts and
the project the problem with this table
is that the joint dependency the table
has a complex relationship between
suppliers parts and projects that can be
decomposed further so how do we convert
this into fifth normal form in order to
achieve 5 andf we break the table into
smaller related tables the suppliers
part table and the suppliers project
table also Parts project table
eliminating joint dependency by
decomposing the table into three smaller
tables we remove the complex
relationship and eliminate the join
dependency ensuring the tables confirmed
to 5 andf So currently I am on my MySQL
workbench let me connect to the local
instance so I'll give my
password I'll click on okay all right so
this is my my SQL workbench query editor
so first we are going to learn
subqueries let me me give a
comment and write
subqueries all right so first of all
let's understand what a subquery is so a
subquery is a query within another SQL
query that is embedded within the we
Clause from clause or having
Clause so we'll explore a few scenarios
where we can use subqueries so for that
I'll be using my database that is SQL
intro so I'll write my command use SQL
uncore intro now this database has a lot
of tables I'll be using the employees
table that is present inside SQL intro
Let me just expand this and you can see
here we have an employees table so let
me first show you the contents within
this table I'll write select star from
employees let me execute it okay you can
see here we have the employee ID
employee name age gender there's date of
join Department City and salary and we
have information for 20 employees if I
scroll down you can see there are 20
employees present in our table so let's
say you want to find the employees whose
salary is greater than the average
salary in such a scenario you can use a
subquery so let me show you how to write
a
subquery I'll write the select
statement in the select statement I'll
pass my column names that I want to
display so the column names I want are
the employee name then I want the
department of the employee and the
salary of the employee from my table
name that is
employees next I'll use a where
condition
where my salary should be greater than
the average salary of all the employees
so I'll write salary greater than after
this I'm going to write my subquery so
I'll give
select average of salary from my table
name that is employees and I'll close
the bracket and give a
semicolon so what it does is first it is
going to find the average salary of all
the employees that are present in our
table once we get the average salary
number we'll use this we condition where
salary is greater than the average
salary number
so the inside subquery let me run it
first if I run this this gives you the
average salary of all the employees
which is
$753 now I want to display all the
employees who have salary greater than
$75,400 so let's run our
subquery there you go so there are eight
employees in our table who have a salary
greater than the average salary of all
the
employees all right next let's see
another
example suppose this time you want to
find the employees whose salary is
greater than John's
salary so we have one employee whose
name is
John let
me run the table once
again okay if I scroll down
you see we have an employee as John you
see this our employee ID 116 is John and
his salary is
$67,000 I want to display all the
employees whose salary is greater than
John's salary so basically all the
employees who are earning more than
$65,000 I want to print them so let's
see how to do it I'll
write
select I want the m employe name comma
the agender of the
employee I also want the department and
salary from my table name that is
employees I'll write where salary is
greater
than I'll start
my opening bracket inside the bracket
I'm going to give my inner query that is
Select
salary from employees
where the employee name is John So
within single quotations I'll give John
as my
employee I'll end with a
semicolon so let me first run my inner
query so this will give us the salary
that John has which is
$667,000 now I want the employees who
are earning more than $67,000
so let's run our
subquery okay so you can see 12 rows
returned which means there are 12
employees in our table who are earning
more than
$67,000 you see here all these employees
have a salary greater than
$67,000
okay
now you can also use
subqueries with two different tables so
suppose you want to display some
information that are present in two
different tables you can use subqueries
to do that
so for this example we'll use uh
database that is called classic models
you can see the first
database so let me use this database
called classic models I'll write use
classic
models now this database was actually
downloaded from the internet there's a
very nice website I'll just show you the
website name so this is the website that
is MySQL tutorial.org you can see here
they have very
nice articles blogs from where you can
learn my SQL in detail so we have
downloaded the database that is classic
models from this website you see here
they have a MySQL sample database if you
click on this it will take you to the
link where you can download the database
so they have this download link which
says download my SQL sample database and
the name of the database is classic
Models All right so we are going to use
this classic models database throughout
our demo session if I expand the tables
section you can see there are a lot of
tables that are present inside this
classic models database we have Cricket
customers as employees office there's
orders order lines and many more so for
our subquery we'll be using using two
tables that is order details and
products table first let me show you the
content that is present
inside the products table
first if I run this you see here it says
110 rows returned which means there are
110 different products that are present
in our table which has the product code
the product name product line we have
the product vendor description quantity
and stock Buy price
MSRP the other table we are going to use
is order details which has the details
of all the
orders let me show you the
records order details tables has okay so
there are thousand records present in
this table you have the order number the
product code quantity ordered price of
each item you have the order line number
as well okay now
we want to know the product code the
product name and the MSRP of the
products whose price of each product is
less than $100 for this scenario we are
going to use two different tables and we
are going to write a
subquery
okay so if you see here in the order
details table we have a column called
price each I want to display the product
code the product name and the MSRP of
the products which have a price of each
product less than
$100 so the way I'm going to do is I'll
write
select product code
comma product name now one thing to
remember that this product name is
actually present inside our products
table and product code is present in
both the tables that is products and
Order details here you can see this is
the product code column comma MSRP which
is present inside the products table
again from my table that is
products
where I'll
write
product
code I'm going to use the in
operator next I'll write my inner query
that is
Select product code from my table order
details
where my price of each
product is less than
$100 let me run
this okay so you can see there are total
83 products in our table which
have a price less than $100 you can see
the price
here okay
now we learn another Advanced Concept in
SQL which is known as stored
procedures I'll just give a comment
saying stored
procedure
okay so first let's understand what is a
stored procedure a stored procedure is
an SQL code that you can save so that
the code can be reused over and over
again so if you want to write a query
over and over again save it as a stored
procedure and then call it to execute
it so in this example I want to create a
stored procedure that will return the
list of players who have scored more
than six goals in a tournament so I have
a database called SQL IQ these are a few
databases that I've have already created
so this database has a table called
players if I expand the tables option
you see we have a table called players
and you can see the columns player ID
the name of the player the country to
which the player belongs to and the
number of goals each player has scored
in a particular tournament so I'll write
a store procedure that will return the
list of top players who have scored more
than six goals in a tournament so first
of all let me Begin by using my SQL IQ
database we'll run it
so now we are inside the SQL IQ
database let
me
select star from players to show
the values that we have in the players
table you can see there are six players
in our
table we have the player ID the names of
the players the country to which these
players belong to and the goals they
have
scored so I I'll write a stored
procedure so the stored procedure syntax
is something like this it should start
with a D
limiter okay in the D limiter I'll write
Amberson
Amberson next I'll write
create
procedure followed by the procedure name
let's say I want to name my procedure as
topor
players next statement is
begin after begin I'll write my select
statement I want to select the name of
the
player the
country and the goals each player has
scored from my table that is players
where I'll write goals is greater than
six it give a
semicolon then I'll end
my procedure with a d limiter that was
double
Amberson next I'll write D
limiter and give a
semicolon now the semicolon suggest
this this is a default
delimiter and there should be a space
okay now let's run our stored
procedure there you go so you have
successfully created a store procedure
now the way to run a store procedure is
you need to use the call method and give
the procedure name that is topor players
in our case with brackets and a
semicolon let's execute it okay there is
some problem
here so we made a mistake while creating
a procedure the name of the column is
goals and not
goal let me create that procedure
again okay it says the procedure top
uncore player already exists let's
just edit the procedure name instead of
top player we'll write it as top players
and similarly we'll edit here as well
now let's create it
again okay now to call my procedure I'll
write call space followed by the
procedure name which is topor players if
I run this you can see we have two
players in our table who have scored
more than six goals so we consider them
as the top players in a particular
tournament all right
now there are other methods that you can
use while creating a stored procedure
one of the methods is by using an in
parameter so when you define an in
parameter inside a stored procedure the
call-in program has to pass an argument
to the stored
procedure so I'll give a
comment stored procedure using in
parameter all right so for this example
I'll create a procedure that will fetch
or display the top records of employees
based on their
salaries so if we have a
table in our SQL IQ database which is
called employee
details I'm going to use this table you
can see we have the name of the employee
the age sex then we have the date of
join City and salary using this table
I'll create a procedure that will fetch
or display the top records of employees
based on their
salaries and we'll use the in parameter
so let me show you how to do it I'll
write D limiter this time I'm going to
use forward
slash I'll write
create
procedure followed by the procedure name
let's say sp4 stor procedure sort by
salary is the name of my procedure and
inside this procedure I'll give my
parameter
in I'll create a variable V and assign a
data type
integer then I'll write
begin followed by my select statement
where I'll select the name
age
salary from my table name that is EMP
details or employee
details I'm going to order this
by salary
descending
and I want to display limited number of
Records so I'm using
this limit keyword and my variable V
which I created
here I end my select
statement I'll end my stored procedure
with forward
slash and I'll go back to my default
delimiter that is semicon
all
right so let me run
this there should be a space here all
right so let's run
this okay you can see we have
successfully created our second stor
procedure which is Spore sort by salary
now you can also check whether the store
procedure was created or not here you
have an opt option to see the stored
procedures let me just refresh
this and you can see we
have three stored procedures that we
have created so far one is Spore sort by
salary the other two were topor player
and topor players okay now let's call
our store procedure I'll write call
space followed by the stor procedure
name which is
Spore
sort by
salary and inside this I'll give my
parameter which was actually V and this
V we have used in limit let's say I want
to display only the top three records of
the employees who have the top three
highest
salaries okay so let me run
it there you go so ammy Sara and Jimmy
were the top three employees who have
the highest
salary so you saw how you could use the
in parameter in a stored procedure we
created a variable and that variable we
used in our select statement and we
called our stored procedure and passed
in that
variable
okay
now instead of a select statement inside
a stored procedure you can also use
other statements let's say
update so I'll create a stored procedure
to update the salary of a particular
employee so in this procedure instead of
Select statement we'll use the update
command in this example we'll use the in
operator twice so let me show you how to
do it I'll write my D limiter first
which is going to be forward slash then
I'll write
create
procedure my name of the procedure is
going to be update
salary and inside the update salary name
I'll write
in and then
temp underscore name which will be a
temporary name variable and the type
I'll assign is varar
20 I'll again use my in parameter I'll
write
in next
my other variable would be newcore
salary and the data type would be
float I'll write
begin and write my update command or
update statement I'll write
update table name that is employee
details
set
salary equal
to newcore
salary
where name is equal
to my temporary variable that is tempore
name so this is my update command and
I'll end the
delimiter all right so let's run
this okay we have successfully created
our store procedure if I refresh this
you can see I have my stored procedure
update _
salary okay now let's
say first of all
I'll display my records that are present
inside employee _ details table okay so
we have six rows of information let's
say you want to update the salary of
employee
Jimmy or let's say Mary from 70,000 to
let's say
72,000 or let's say
80,000 so I'll call my store procedure
that is update uncore
salary and this time I'm going to pass
in two parameters the first parameter
will be the employee name and next with
a comma I'll give my new salary that I
want to
so my employee name let's say is
Mary and the salary I want to be updated
is let's say
$80,000 I'll give a
semicolon and I'll run it you can see it
says one row affected now let's check
our table once again there you go if you
see this record for Mary we have
successfully updated the salary to
$80,000 now moving ahead we learn to
create a stored procedure using the out
parameter so I'll give a
comment stor procedure using out
parameter okay so suppose we want to get
the count of total female
employees we will create total employees
as an output parameter and the data type
would be an integer the count of the
female employees is assigned to the
output variable which is total _ emps
using the into keyword let me show you
how to write a stored procedure using
the out
parameter so first I'll declare my
delimiter to forward slash I'll
write
create
procedure followed by the procedure name
it is going to be
Spore count
employees and inside this I'm going to
give my out parameter and the variable
name that is total
underscore emps which is total employees
and the data type will be integer next
I'm going to write
begin followed by my select statement
that is Select I want the count of total
employees and the output I'm going to
put into my new variable that is total _
emps from my table that is
empore
details
where sex is equal to F which means
female I'll give a
semicolon next I'll end it
with the D limiter and I'm going to
change the D limiter to a default D
limiter that is
colon so let me tell you what I'm doing
here I'm creating a new stor procedure
that is Spore count employees using this
stored procedure I'm going to count the
total number of female employees that
are present in our table empore details
so I've used my out parameter and I'm
creating a new variable called total
uncore
emps the data type type is integer here
in the select statement I'm counting the
names of the employees and the result
I'm storing it in total uncore
emps I have used my we condition where
the gender of the sex is female so let's
run
this okay so we have created our stored
procedure let's refresh this okay you
can see we have a new stor procedure
Spore count employees
now to call it I'll write
call the name of the procedure that is
Count _ Spore count
employees within brackets I'll pass in
the parameter as at the rate fcor
EMP I'll give a semicolon then I'll
write
select at the rate fcor
EMP as female
employees okay so as is an alias name
let's run this one by one first I'll
call my procedure and then we'll display
the total number of female employees you
can see in our table we have three
female
employees all right now with this
understanding let's move on to our next
Topic in this tutorial on Advanced SQL
now we are going to learn about triggers
in
SQL so I'll give a comment here triggers
in
SQL so first let's understand what is a
trigger so a trigger is a special type
of stored procedure that runs
automatically when an event occurs in
the database server there are mainly
three types of triggers in SQL we have
the data manipulation trigger we have
the data definition trigger and Logan
triggers in this example we'll learn how
to use a before insert trigger
so we will create a simple students
table that will have the students role
number the age the name and the students
marks so before inserting the records to
our table we'll check if the marks are
less than zero so in case the marks are
less than zero our trigger will
automatically set the marks to a random
value let's say
50 so let's go ahead and create our
table that is students
all
right so I'll write
create
table
student now this table will have the
student role
number the data type is
integer it will have the age of the
students again the data type is integer
we have the names of the students so the
third column would be
name the data type would be variable or
varing
character size I'm giving it as 30
finally we have the marks as floating
type so let's create this table which is
student so we have created our
table
now I'll write
my trigger command so trigger command
will start with D limiter like how our
usual stored procedures
have
next this time I'll write create
trigger then you need to give
the name of the trigger that is Mark
underscore let's say verify
I'm going to use a before insert trigger
so I'll write before
insert on my table name that is
student next I'll write for each
row
if new do
marks is less than
zero
then we'll
set new DOT marks equal to
50 so this is
my condition first we'll check before
inserting if any student has marks less
than zero we'll assign a value 50 to
that student because usually the marks
are not less than zero in any
exam I'll write end if semicolon and
I'll close the delimiter so this is
my trigger command I'll run it it says
trigger already exists in this case we
need to update the trigger name let's
say I'll write marks _ verify
uncore student for
STD let's run it
again okay there is an error here
because in our table the column name is
Mark and not marks so here we need to
change it as Mark instead of marks all
right let's run
it okay so we have created our
trigger
now let me insert a few records to the
student table so I'll write insert into
student I'll write
values I'll give the values as
501 which is the student role number the
age is let's say 10 the name is it's say
Ruth and the marks is let's say
75.0 give a comma we'll insert our
second student
record student role number is
502 age is
12 the name is let's say
mik and this time I'm purposely giving a
value of minus 20
5 give another comma we'll insert the
third
record for student role number
503 age is
13 the name is
Dave
and let's say the marks obtained by Dave
is
90 now we'll insert our final record for
student
number
504 the age is 10
name I'll enter as
Jacobs and this time again I'm purposely
giving the marks in
negative 12 let's say
5 I close the bracket and give a
semicolon and I'll run my insert
statement okay so we have inserted four
rows of information to our student
table now
let me run the select query I'll write
select star from
student if I run this you see the
difference there you go so originally we
had
inserted for 502 the marks was minus
20.5 and for
504 but Jacobs the marks was minus
12.5 our trigger automatically converted
the negative marks to 50 because when we
created our trigger we had set our marks
to 50 in case the marks were less than
zero so this is how a trigger
works now you can also drop a trigger or
delete a trigger you can just write drop
trigger followed by the trigger name in
this case our trigger name
is maxor verore St
I'll just paste this
here and if you run this it will
automatically delete your trigger I'll
give this as a
comment
okay now moving
on now we are going to learn about
another crucial Concept in SQL which is
very widely used this is known as views
so views are actually virtual tables
that do not store any data of their own
but display data stored in other tables
views are created by join joing one or
more
tables I'll give a comment as views in
SQL
okay now to learn views I'm going to use
my table which is present inside classic
models database now this database as I
mentioned we had downloaded we had
downloaded it from the internet so first
of all let me write use classic models
so I'll switch my database first
all right now we are inside classic
models so here let me show you one of
the tables which is called customers so
I'll write select star from
customers okay I missed s
here let's run it again so this is my
customer table which is present inside
classic models database it has the
contact last name the contact first name
the customer name customer number we we
have the address State country and other
information now I'll write a basic view
command using this customer table the
way to write is I'll write create
view followed by The View name which is
custor
details then you write
as select I'm going to select a few
column names from my original customer
table which is this one so I need the
customer name let's say I need the phone
number and the city so you have this
information here you have the phone
number and the
city all right I'll write from my table
that is
customers if I run
this my view that is cust details will
be
created let's run it there's some error
here because the name of the table is
customers and not customer I'll give an
S and I'll run it
again all right so you can see we have
created our
view and to display the contents that
are present inside our view I can write
select star from followed by The View
name that is custor
details let's run
it there you go so we have the customer
name the phone number and the City of
the different customers that we have in
our table all
right now let's learn how you can create
views using joins so we'll join two
different tables and create a view so
for that I'm going to use my products
table and the products lines table I'm
talking about the product table and the
product lines table present inside
classic Model St database so before I
start let me display
the records that are present inside the
products
table let's run it so these are the
different products you can see
here now let's see what we have in
product lines
table so we have the product line the
text description and there's some HTML
description and image so I'll create
view by joining these two tables and
we'll fetch specific records that are
present in both the tables so let me
first start by writing create view
followed by The View name that is
product
underscore
description as I'll
write
select product name comma then I'll
write qu
quantity in
stock I also want the MSRP now these
three columns are present inside the
products table and next from the product
lines table I want the text description
of the products so I'll write
from products
table I'll give an alas as p
followed by Inner join my other table
that is product lines as let's say PL
on the common column that is product
line so P
dot product
line is equal
to I'll give a space PL dot product
line okay
so here we have used an inner joint to
fetch specific columns from both the
tables and our view name is product _
description let us run it all right so
we have our view ready now let me view
or display what is present inside our
productor
description view I add select star
from productor description
let's run
it there you go so we have the product
name the quantity in stock MSRP and
textual descriptions of the different
products in the
table okay now there are a few other
operations that you can perform let's
say you want to rename a view instead of
productor description you want to give
some other name so I'll just give a
comment rename description
so to rename a description you can use
the rename statement I'll write rename
table product uncore description which
is
my old
name I want to change this name to let's
say I'll give vehicle description since
all our products are related to some of
the other vehicle so I'll write vehicle
description okay let us run
it all right so here you can see I have
renamed
my view so here if I just refresh it and
I'll expand this you can see we have the
Cur details view and we have the vehicle
_ description view
okay now either you can view all the
views from this panel or you can use a
command let's
say I'll write display views is the
comment now to show all the views you
can use
show full
tables
where
table
underscore type is equal to within
single code I'll write
view so this is the command that that
will display all the views that are
present inside a
database there is
some error here let's debug the error
this should
be okay so instead of table types it
should be table type equal to
view let's run it you can see the two
different views that we have one is
customer details another is vehicle _
description okay now you can also go
ahead and delete a view
for that you can use the drop command so
I'll write
drop view followed by The View name
let's say I want to delete customer _
details or custor details view I'll
write drop view
ccore
details let's run
it you can see here we don't have the
custor details view anymore
all
right now moving to our final section in
this
demo here we will learn about Windows
functions Windows functions were
Incorporated in my SQL in the 8.0
version so Windows function in MySQL are
useful applications in solving
analytical problems so using the
employees table present inside my sqor
intro database
so we'll find the total combined salary
of the employees for each
department so first let me switch my
database to
SQL intro
database I'll run it okay I'll display
my table that is
employee so here we have 20 employees in
our table using this table
we are going to find the combined salary
of the employees for each department so
we will partition our table by
department and print the total salary
and this we are going to do using some
windows functions in
MySQL so I'll write
select I want the employee
name the age of the
employee and the department of the
employee comma next I'll
write this sum of
salary
over I want to partition it
by
department so I'll write Partition by
Department which is
D and I'll give an alas as total salary
so that it will create a new column with
the name total
salary from my table that is
employees the output will be a little
different this time let's execute it and
see the result there you go so here we
have created another column in our
result that is total salary and for each
of the employees and the respective
departments we have the highest salary
so in finance the highest salary of one
of the employees was
$155,000 similarly if I come down we
have the highest salary from HR if I
scroll further we have the highest
salary from it marketing product sales
and The Tech Team all right now we'll
explore a function which is called row
number now the row number function gives
a sequential integer to every row within
its partition so let me show you how to
use the row number function I'll write
select rore number
function
over my
column would
be salary so I'll write order by
salary I'll give
the alas as
rum give a
comma and I want to display the employee
name and the salary of the employee from
my table that is
employes and I'll order
by salary
so let's see how our row number function
will create sequencial integers okay you
can see here we have a row num column
and we have successfully given row
numbers to each of the records you can
see it starts from one and goes up till
20
okay now this row number function can be
used to find duplicate values in a table
to show that first I'll create a
table I'll write create table
let's say I'll give a random name that
is
demo and let's say we have in this table
the student ID which is of type integer
and we have the student
name which is of type
varar the size is 20 I'll create the
small table with a few records let's
create this table first now we are going
to insert a few records to our demo
table so I'll write insert
into
demo
values I'll give
101 the name is
Shane give a
comma I'll insert the second student
name one2 the name is
Bradley we give a
comma this time for 103 we have two
records let's say the name of the
student is
her give a comma I'll copy
this and we'll paste it again so we have
duplicated
103 next we have
104 the name of the student let's say is
Nathan then again let's say
for the fifth student which is Kevin we
have
two
records I'll copy this and I'll paste it
here let me give a semicolon and we'll
insert these records to our table
demo all
right
now let me
just run this table for you I'll write
select star from
demo if you see this we have a few
information that are duplicated in our
table that is for student ID 103 and
student ID
105 now I'm going to use
my row number function to find the
duplicate records present in my table
I'll write select student _ ID comma
student uncore
name I'll give another comma and write
rcore number
over within
brackets I'll write
Partition
by store
ID
comma store
name okay then I'll
write order by store ID close the
bracket I'll give alas as
ronam from my table that is
demo let's just run
it you can see here okay let me
just delete n from here and do it again
all right if you see here there is just
one student in the name Shane we have
one student in the name Bradley but here
if you see for her the second record it
says two which means there are two
records for H and if I scroll down there
is one record for Nathan and there are
two records for Kevin which means Kevin
is also
repeated okay now we are going to see
another Windows function that is called
rank function in my SQL so the rank
function assigns a rank to a particular
column now there are gaps in the
sequence of ranked values when two or
more rows have the same rank so first of
all let me create create a
table and the name of the table would be
a random name we'll give it as let's say
demo 1 and it will have only one column
let's say variable a of type
integer we'll create this table first
okay now let's go ahead and insert a
few records to
our table which is demo one so I'll
write value
101
one2 let's say 103 is repeated I'm doing
this purposely so that in the output you
can clearly distinguish what the rank
function
does next we have
104
105 we have
106 and let's say 106 is also repeated
finally we have
107
okay let me insert these values to my
table that is demo 1 okay this is
done now if I write
select Vore
a and use my rank function I'll write
rank over
then
I'll order by my variable that is Vore
a
as an alas name let's say test
rank
from my table that is demo
one let me execute this and show you how
the rank function
works if I run this there you go so here
if you
mark so for variable
a101 the test rank is 1 for 102 the test
rank is two but for this value which is
103 the test rank is repeated because
there was a repetition for
103 so we have skipped the rank 4 here
for 104 the rank is 5 now for 105 the
rank is 6 now for 106 again since the
record was repeated twice we have
skipped the eighth Rank and our rank
function assigned the same value which
is 7 for 106 and for the last value 107
the rank is
9 all
right now moving ahead we'll see our
final Windows function which is called
first
value so first value is another
important function in my SQL so this
function Returns the value of the
specified expression with respect to the
first row in the window frame all right
so what I'm going to do is I'm going to
select the employee
name the age and
salary and I'll
write first
underscore value which is my function
and pass in my employee
name and then I'll write over
order
by my column that is salary
descending I'll give an alas as highest
_
salary from my table that is
employees so let me run this and see how
the first underscore value function
works
all right so in our table Joseph was the
employee who had the highest salary
which was
$15,000 so the first value function
populated the same employee name
throughout the table you can see it
here now you can also use the first
uncore value function over the partition
so let's say you want to display the
employee name who has the highest salary
in each department so for that you can
use
partition I'll write select empore name
comma I want the
department and the salary comma I'll use
my function that is first underscore
value followed
by the name of the employee inside my
first value parameter I'll write
over here I'm going to use partition I'm
going to partition it by department
since I want to know the employee name
who has the highest salary in each
department and I'm going to order
by salary
descending and I'll give my alas again
as highest
salary
from my table that is employees
so let's run this and see the difference
in the output okay so as you can see
here we have the employee who had the
highest salary from each department so
for finance Jack had the highest salary
from HR it was Marcus similarly in it it
was William if I scroll down for
marketing it was John for product it was
Alice who had the highest salary
similarly in sales we had Joseph and and
in Tech we had Angela so this is how you
can use the first uncore value function
using
partition all right so that brings us to
the end of this demo session on our
tutorial so let me just scroll through
and show you what we did from the
beginning first we learned about
subqueries in SQL so we initially wrote
a simple subquery and then we used our
classic models database which was
downloaded from the internet I'd also
shown you the link from where you can
download this database here we used two
different tables and we performed a
subquery
operation we learned how to create
stored
procedures so we learned how you can use
the in operator or the in parameter as
well as the out parameter in stored
procedure after stored procedure we
learned another crucial Concept in SQL
which is called triggers not triggers
are also special kind of stor procedures
so we saw how to write a before insert
trigger you can see it
here next we learned how to delete a
trigger we also saw how to work with
views in SQL so views are basically
virtual tables that you can create from
existing
tables we also saw how you can use views
using two different tables and an inner
join and we learned how to display views
how to rename view names how to delete a
view and finally we explored a few
Windows function in this tutorial we
will learn how to work with databases
and tables using SQL with
python to do this demo we'll be using
our jupyter notebook and the MySQL
workbench you can see it
here so we will write our SQL queries in
the jupyter notebook with python like
syntax if you don't have MySQL or
jupyter notebook installed so please go
ahead and install them first while
installing the MySQL workbench you'll be
asked to give the username and password
let me show you so I am on my MySQL
workbench so once you connect it will
ask for the username and the password so
I've given my username as root and
password you can give while installing
it we'll be using the same user ID or
the username and the password to make
our
connection so let's get started with our
Hands-On demonstration
part first and foremost let me go ahead
and import the necessary
libraries I'll give a comment as import
libraries all right so first I'll import
MySQL do
connector
next from MySQL doc
connector I'm going to import my error
method or the error
module next I want to import put pandas
as PD so let's run this okay there is
some error
here this should be capital E and not
small e all right you can see I have
imported my important
libraries now I'm going to create a
function that will help us create a
server
connection so I'll write my user defined
function by using the DF keyword
I'll write create
underscore server underscore
connection this is going to be
my function name and it will take in
three parameters first is the host
name next is the usern
name and then we have the user
password all right
I'll give a colon and then in the next
line I'm going to Define a
variable which is going to be connection
and I'll assign it to a value called
none now we'll be using exception
handling techniques to connect to our
MySQL
server the tri block lets you test a
block of code for errors and the except
block will handle the errors so I'll
write try and give a colon
and
then I'm going to reassign the
connection
variable to a method which is MySQL do
connector do
connect now this MySQL connector.
connect method sets up a connection so
it establishes a session with the MySQL
server if no arguments are passed it
uses the already configured or default
values
so here we are going to pass
in three parameters the first is the
host
name I'll write host equal
to host name which is hostor
name I'll give a comma then I'll write
user equal to user uncore
name next will be my
password and I'll assign the value user
_
password all
right
now I'm going to use a print statement
and
write
mySQL
database
connection
successful after this I'll give my
accept block so I'll use the keyword
accept here I'll write error as
err give a colon and then I'm going to
use the print
statement here I'm going to use some
print formatting techniques using the F
letter I'll write error
colon and I'll use curly braces give VR
and then I'll close the double
codes after
this I'm going
to
return my
connection all right
let me give a comment
here we are going to assign our password
so we need to put
our
MySQL terminal
password so this password you assign it
while installing MySQL
workbench I'll write
PW and I'll give my password which is
simply at the rate 1 2 3 4 5 and then
I'm going to give my database name so
I'll
give database
name
here I'm going to write
DB equal to this is the database I want
to create which is going to be MySQL
uncore python let me just scroll this
down okay now I'll say
connection equal
to I'll pass in
my user defined function name which is
create server connection
and the parameters which are going to
be Local Host that is
my host name my username which is root
and then I'll give PW which is my
password that is exactly simply at the
rate 1 2 3 4 5 let's just run it now
okay there is an error here we need to
remove this double quotation all right
made another mistake here this this
should be
root okay you can see here mySQL
database connection
successful all right
next we are now going to create a
database that is MySQL unor python so
I'll give a comment create
MySQL python
database again to create this database
I'm going to create another userdefined
function using the DF keyword I'll
write the function name as create
database passing the parameters as
connection comma
query give a
semicolon and in the next line I'll
write cursor equal
to I'm going to make the connection so
I'll write connection
dot cursor
and I'll give the
parenthesis so this MySQL cursor of
MySQL connector python is used to
execute statements to communicate with
the mySQL database the MySQL cursor
class initiates objects that can execute
operations such as the MySQL
statements okay next I'm going to again
use my try and accept block so I'll
write try
give a coolon and here I'm going to use
cursor do
execute within that I'm going to pass in
my
query next I'll use a print
statement and the message I'm going to
display is
database created successfully
after
this I'm going to write my accept
block I'll write
accept error as
err give a colon and then I'll use a
print statement I'll write
print I'll use the formatting
again and
error
colon then I'll
write within single codes I'll give
curly Braes err and then I'll close the
double
codes
next
let's use the variable create
underscore
database underscore
query and
here I'm going to write my SQL query to
create the database so I'll write
create
database and followed by that I'll give
my database name which is going to be
MySQL
python
okay after
this I'll call my function which is
create
database and I'll pass in the parameters
the first one is
connection and next the query is create
_ database _ query let me just copy it
and I'm going to paste it
here all right so what I'm doing here is
I am creating a new function
that is to create a new database with
the
name
MySQL undor python which you can see it
here now this function takes in two
parameters connection and query I'm
using the connection. cursor function
which is often used to execute SQL
statements using Python language and
then I have created my try and except
blocks so this try block statements will
try to create my new database which is
MySQL python in case it fails to create
the new database the except block will
work so here I'm writing my SQL query to
create a new database which is create
database followed by the database name
and I'm assigning it to a variable which
is create database query and then I'm
calling my function create database and
passing in the two parameters connection
and the query all right so let's just
run it all right you can see here it has
created my datab
successfully
now you can verify this by checking the
MySQL workbench or the MySQL
shell you can see on the MySQL workbench
here on the left panel under schemas
there is a database called MySQL python
let me just expand it now we haven't
created any table so it's not showing it
now the next step we are going to
connect to this database so let's go
Ahad head and connect to our database
that we have just created I'll write the
comment as connect to
database now to connect to a database
I'm again going to create a userdefined
function using the DF keyword I'll write
create
underscore DB which is for database _
connection and the parameters it will
take is the host
name followed by the
username then we have have the user
password and finally we have the
database
name I'll give a
colon in the next line I'm going to
create my
variable which is connection and then
I'll assign it to a value
none after this I'm going to use my
exception handling techniques so I'll
write my dry block first I'm going to
reassign my connection
variable using the MySQL connector
method so I'll write MySQL do connector
do
connect so this method we'll take in
the
parameters so first it will take the
host name
I'll
write host equal
to hostor
name I'll give a comma next it will take
the usern name so user equal to user
name give another comma next it will
take the user password I'll use pass WD
equal to user uncore password we give
another comma
and this
time is going to be the database name so
I'll write database equal to DB uncore
name now let's use the print
statement and the message we are going
to print is
mySQL
database connection
successful all all right finally we'll
write
my accept block I'll write
accept error as
err give a colon and then I'll use the
print
statement
F within double Cotes I'll write error
colon within single Cotes curly braces
I'll write err and we'll close the
double quotes
finally this
function will return the connection
value all right let's run it and there
you go it has run successfully so we
have connected to our
database now it's time for us to execute
SQL
queries I'll give another comment
saying execute
SQL
queries all
right now to execute our SQL queries
I'll use another user defined function
which
is
execute
underscore
query and I'll pass in the parameters as
connection and query
give a colon I'm going to write
cursor equal
to connection.
cursor now this is used to establish a
connection and run SQL
statements next we'll use the try and
accept block so I'll write
try
cursor dot execute
this will take in one parameter which is
going to be my
query and then I'll write
connection dot
commit which is another
method now let's use the print
statement so I'll write
print let's say the message would be
query was successful
and
then we'll write our accept block which
is
accept if the tri block doesn't work
through an
error using the print
statement within double codes inside the
inside the curly braces I'll write ER R
and and close the double
codes all right so let's run it okay so
we have successfully created our various
functions that we needed
to create a database establish a
connection and to execute our
queries all
right now it's time for us to create our
first table inside the MySQL python
database so to do that I'm going to
write my
create command in
SQL so first we are going to assign our
SQL command to a python variable using
triple codes to create a multi-line
string so let me show you how to do that
I'll write my variable
name which is going to be create orders
table it is always recommended to use
relevant variable names to make it more
readable and now I'm going to use triple
quotes So the triple quote will
ensure I can create my multi-line string
inside the triple code I'm going to
write my create command which is create
table here I'm going to create an orders
table
first and inside the orders table I'm
going to create my column names the
First Column would be the order ID it is
going to be of type integer and I'll
assign this order ID as my primary key
column we give a comma
next the second column would
be
customer underscore
name the customer name column would be
of type varing character so I'll write
varar and I'll give a size of 30 and
this is also going to be not null
moving ahead my fourth column would be
the product name column so I'll write
productor name product name will be of
type varing character the size is let's
say 20 and it is also not
null next I'm going to create my fourth
column which is the date on which the
item was order or the product was
ordered so I'll write date ordered the
data type will be date next I'll create
a quantity column to keep track of the
number of quantities that were
ordered this is of type
integer my next column would be unit
price which will basically have
information about the price of each unit
of
product unit price can be of type
float and finally I'll have the phone
number of the customer
I'll write phone number phone number can
be kept as of type varying
character I've assigned a size of
20 now let's give a semicolon and
we'll close
the triple codes all right so this is
how the syntax would look
like
next to run this we are first going
to call our create DB function so let me
give a comment as connect to the
database I'll write
connection equal
to create _
dbor
connection my parameters would be my
host name which is Local Host my
username name which is
root comma my password and then my
database name which is MySQL python so
I'll write just DB all
right finally let's execute this query
using the execute
underscore query function that we had
created earlier this takes in two
parameter the first one is connection
followed
by the variable name which is
create orders uncore
table let us run
it okay there is some error here let's
see what's the
error okay so here we have put four
double quotes this should be triple
Cotes now let's run
it okay there is another here let's
debug it it's say name cursor not
defined
let me just roll it to the above cell if
you see here in our execute underscore
query function instead of
cursor I have written cursor so R is
missing let's redun this and now let's
run this again there you go you can see
here my SQL database connection
successful even our query was also
successful now if you want to recheck if
the table that is orders was created or
not you can check it on the MySQL
workbench so let me show you how to do
it so I am on my MySQL workbench and
under MySQL python database you have
something called as tables let me just
right click and I'll select refresh all
there you go you can see this Arrow just
click on this arrow and here you can see
we have a table called orders so we have
created our table called orders now you
can check the columns as well you have
the order ID you have the the order ID
the customer name product name ordered
date quantity unit price and phone
number now it's time for us to insert a
few records to this table which is
orders now to insert records I'll give a
comment as
insert
data I'll start with
the variable name let's say the variable
name is data
underscore
orders I'll give triple
codes next I'll write my insert into
command so I'll write
insert
into my table name that is orders
followed by values and now I'll start
entering my records for each of the rows
so first I'll give one1 which is the
order ID then I'll give the
customer's name let's say
Steve and the product he had ordered is
let's say
laptop then I'll give my date in which
the item was
ordered let's say it is
2018 I'll choose 06 as the month and the
date is let's say
12 we give another comma this time we'll
pass in the quantity which is two let's
the price of each laptop was
$800 and we'll give a phone number this
is random let's say 62 9 3 7 3 0 let's
say
802 all right similarly I'm going to
insert five more records of different
customers and their items that they have
purchased to this table orders so here
on my notepad I have my rest of the five
records let me just copy it and we'll
paste it in the cell here this will save
us some time okay let me recheck if
everything is fine I'll give a comma
here all right so we have six customers
in our table which have their customer
IDs from 101 to 106 you have Steve jaw
Stacy Nancy Maria and Danny you have the
different items they have purchased
laptop books trousers t-shirts
headphones phones and smart TV is the
date on which they had ordered this item
the number of quantities they had
ordered and then we have the unit price
and some random phone numbers so
let's create the connection now I'll
write
connection equal to I'll write create
uncore dbor
connection then I'll going to give my
same parameters let me just copy it from
the top is Local
Host the host
name root is my username then we have
password and the database name and then
I'll use the same query as above which
is execute query I'll copy this paste it
here and instead of create orders table
variable I'll put as dataor
orders so this will store my insert into
command you can see the variable I used
here is dataor
orders now it's time let's just run it
all right there was some mistake here
let's debug
it again this should be triple codes and
not four now let me rerun it again there
you go you can see here my SQL datab
base connection successful and my query
was also
successful now we'll create another user
defined function which will help us read
query and display the results so I'll
write my function name as DF read
uncore
query this will take in two parameters
connection and
query then I'll write
cursor equal to connection do
cursor I'll put my result as none and
and then I'll use my try and accept
block I'll write
try cursor
dot
execute this will take in one parameter
which is query and then
I'll give another variable which is
result equal
to cursor dot fetch all now this
fetchall method will return all the
results in the table
I'll write
return
result next we'll use the accept
block so I'll write
accept error as err give a colon and
I'll use my print statement scroll this
down I'll use my formatting
F error
give a colon followed by a space within
single codes inside curly press I'll
give err and close my double codes let's
run it all right so now we are all set
now we are going to use our select
Clause having whereby then we'll see how
to use autoby Clause some inbuilt
functions we'll update some records
delete some records and do a lot of
other stuff so
let's start with our first
query so our first query is going to be
using the select
statement all right so suppose I want to
display all the records that we have
inserted into our orders table so the
way to do is I'll assign my query to a
variable let's say q1 I'll
give triple quotes
within triple codes I'll write select
star from
orders we give a semicolon followed by
the triple
codes now we'll establish the connection
so let me just go to the top and I'll
copy this
line which is to connect to our
database I'll paste it
here now we'll create a variable called
results that will store the result of
this
query and we are going to to assign this
variable to our function that is read
query and this read query will have two
parameters the connection and the
variable name which is q1 for the
query next to display I'm going to use a
for Loop I'll write
for
results for
result
in results
print I'll say
result now we are done let's just run
this query there you go you can see here
we have successfully printed all the
rows in our table which is orders you
can see we have six records in
total now we are going to explore a few
more queries so let me just copy this
and we are going to edit in the same
query I'll paste it here here next let's
say you want to display individual
columns from the table and not all the
columns so let me let me create the
variable Q2 now instead of star I'm
going to display only the customer name
and let's see the phone numbers of the
customer so I'll write phone uncore
number all right the rest all Remains
the Same let me just recheck it and here
instead of q1 we'll put
Q2 and let's run this cell all right you
can see here now we have displayed only
two columns the First Column is the
customer name and then we have the
respective phone
numbers okay now let me just paste that
query again now we are going to see how
you can use an inbuilt function that is
in our table we have
the order date and from the order date
we are only going to display the
different years that are present in the
order date so to do that I'm going to
use the ear function I'll edit this
query instead of q1 I'll make it Q3 and
here I'm going to write
select here which is my function name
from my column which is date
ordered from orders and here I'll change
this to Q3
q1 Q2 Q3 are basically query 1 query 2
and query 3 let's run it there you go so
we have successfully extracted the
different years present in the order
date
column now if you want to display the
distinct or the unique dates present in
the column you can use the dextin
keyword in the select statement so the
way to do it is I'll write
select
distinct give a
space the rest of the query Remains the
Same and here Q3 I'll write
Q4 I'll make this as
Q4 let's run it you can see 2018 and
2019 are the unique year values that are
present in the order date
column okay now moving ahead let's write
our fifth query and this time we are
going to explore how you can use the
wear
Clause so I'll change this to Q5 before
I write my query so let's say you want
to display all the orders that were
ordered
before 31st of December
2018 so to filter this we are going to
use the wear Clause so I'll write
select star from
orders next I'll write
where my date underscore ordered
is less
than within course I'll give my date
value which is 2018 December
31st so all the items or the products
that were ordered before 31st of
December 2018 will be displayed so let's
run it all right you can see here there
are three orders in our table which have
been ordered before 31st of
December now moving ahead
we want to
display all the orders that were made
after 31st of December so
here what you can do is I'll just copy
the above query again I'll copy this
line so instead of less than 31st of
December 2018 I'll make it as greater
than so every order that was placed
after 31st of December will be displayed
if you run it so you can see here there
are three orders in our table which were
ordered after 31st of December
[Music]
2018 now moving
ahead let's write a seventh
query now let's see how the aut by
Clause Works in SQL so you can filter
your results based on a particular
column or sort it based on a particular
column so this is going to be my query 7
I'll write it from scratch again let's
see you want to display all the columns
from the table so I'll write select star
from
orders then I'm going to use order
by unit
price I'll give a
semicolon let's run this qu and see the
output if you see the result here and
you mark the unit price price column the
result has been ordered in ascending
order of unit price you see here it
starts with the lowest price and then
goes on with the highest price towards
the end if you want to order it in
descending order you can use the keyword
DC so this will ensure your
top or the most expensive products
appear at the top and the least
expensive products appear at the
bottom all right
next now let's see how you can create a
data
frame from the given table so as you
know using jupyter notebook and pandas
you can create data frames and work on
it very easily so with this table also
we can create our own data frame so for
that let me create an empty list first
I'll write from DB equal to I'll assign
this as an empty list
so we are going to return a list of
lists and then create a pandas data
frame next I'll write my for Loop I'll
write for result
in
results I'll assign
result
to list of results so I'm converting the
result into a list and then I'm going to
append it to
the empty variable or the empty list
which is frommore DB dot
append I'll append the result to my
empty
list
next we need to pass in
the columns now that will be part of our
data frame so I'll write columns equal
to this column I'll pass
it within a list so I'll give my first
column as order right
then we have
the customer
name next I have
my product
name then I have the date on which it
was
ordered give a comma then we'll have the
quantity
column let me write it in the next
line next we have the unit price
column and finally we have the phone
number column so I'll write within
double quotes phone
number and this we are going to assign
it to a data frame so I'll be using PD
dot data frame which is my function to
convert a list into a data frame
my variable I'm going to pass is
frommore DB and I'll write my next
argument is columns equal
to my variable name that is
columns finally let's
display the data frame which is DF all
right so here I'm creating a empty list
first and then I am creating a for Loop
and I'm appending the results to my
empty list here you can see I have
created my column list and using pd.
data frame I'm converting the list into
a data frame if I run
this this is append and not
appens all right you can see we have our
data frame ready this is the index
column it starts from zero onwards and
then we have the different column
names okay
now let's see how to use the update
command now
suppose you want to change the unit
price of one of the orders you can use
the update command so the way to do it
I'll
first create my variable let's say
update and I'll give
three codes or triple
codes then I'll use my update command
which is update for followed by the
table name that is orders next I'll
write
set let's say unitor price if you see
this let's say I want to set the unit
price of trousers from $50 to let's say
$45 I want to update this particular
record so I'm going to write set unit
price column equal to
$45
where the order ID equal
to 103
so this query will update
the third row in our table which is
order ID
103 so it will update from $50 to
$45 I'll close the triple
codes and
now I'll use
the
connection queries
again let me just just paste it
here all
right I'll
delete these three lines of code and
instead of that I'll put execute
underscore
query and this will take into parameters
as always which is going to be
connection followed by the variable name
that is update let's run it you see here
it says mySQL database connection
successful query was successful
now you can recheck
that to do it let me just go to the top
and we so let copy our first query which
is q1 I'll copy
this and I'll paste it
here let me just rename this now this
will
be
Q8 and I'll change this as well I'll
write select star from orders
where my order ID equal to
103 let's see the unit price of 103 now
you can see here instead of 50 now we
have updated it to
$45 all right now the last command we
are going to say is how you can delete a
record from the
table I'll write delete command as my
comment now to delete a query I'll
first give my variable name which is
delete uncore order and I'll pass in
within triple
quotes next I'll write my delete query
which is delete from my table name that
is orders then I'll give my we Clause
where let's say I want to delete my
order
ID
105 let me just go to the top and
explain you again so if you see this we
want to delete the order ID 105 which
was for customer name Maria and she had
ordered headphones we want to completely
remove this particular record
so I have my delete query ready now let
me just create my connection and display
the results so I'll go to the top and
I'll copy this connection command which
also has the execute query command and
I'll paste it
here and I'm going to make a change here
instead of update we'll write
delete uncore order everything looks
good let's just run it you can see our
query was
successful and
now if you want to print it let me just
show you I'll just copy
this we'll paste it
here I'll make this as
q9 I want to verify if my order ID 105
was deleted or not instead of the
statement I'll write select start from
orders and here I'll change this to
q9 if I run this you can see it here you
can Mark order ID 105 was deleted and it
no more appears in this table all right
so this brings us to the end of the demo
session on SQL with python let me just
scroll you through what we did so first
we imported the important libraries
MySQL connector then we imported the
error function then we imported pan has
using PD we learned how to create a
server connection to mySQL database we
created a new database that is MySQL
Python and now we connected to that
database we created a function to
execute our queries we saw how you can
write a create table command then we
inserted a few records to our ERS table
we created a read uncore query command
to read the queries and display the
results then we started exploring our
different SQL commands one by one we saw
how to use select query then we selected
a few individual columns from our table
followed by using
a inbuilt function which was ear then we
saw how to use the distinct
keyword after that we used our wear
Clause to filter our table based on
specific conditions we saw how to order
your results based on a particular
column then we saw how you could convert
the table into a data frame using pd.
datf frame
function finally we learned how to use
the update command and the delete
command in this session we will learn
about how to join three or more tables
in SQL that's right so so far we have a
fundamental understanding of how to join
two tables but in a few situations you
might have to extract the data by
joining three or more tables right so
that's exactly what we are going to
discuss today now without without
further delay let's get started now we
will jump into the MySQL workbench where
we have our query ready so here we will
be using three tables employee details
employee register and employee joining
register so we want employee name
contact number and joining date joining
date is available in joining register
contact number is available in employee
register and employee name is available
in employee details right so here here
we are utilizing all three tables and
joining them to extract these three
columns so here I'm providing the table
name and the column name to make sure
that the SQL workbench will not get
confused which employee name I mean
which employee name column should I
access which table should I use so to
clear that confusion I'm providing the
table name so my SEL will use employee
details table and from there it will
extract the employee name column and
contact number to be sure it is present
in only one table so it will go to
employee register and joining date it is
also present in only one table so no
need to specify the table name but to be
on safer side if you want to add you can
add that's well and good and it will
create an impact to your interviewer
considering that you know about the
syntaxes so I'll just follow the normal
syntax the way I'm going now and now I'm
trying to join it's the same operation
what you use to join two different
tables so you'll just join use the join
clause and give the second table name
and on what basis so I'm joining these
two tables on the primary key employee
ID so both tables have the same common
employee ID So based on that I'm joining
these two tables and then you will use
the join Clause once again and give the
third table name here and based on which
primary key or which common key so this
is the one which is common in both the
tables and is unique which is the
employee ID so I'm using the same one to
join the two tables with the third one
you can follow the same syntax and join
another table to it as well so with this
let's execute this particular query to
find our answer so there you go you got
the query executed and you have the
table over here with employee name
contact and joining date let's quickly
get back to my SQL workbench so here
let's say you wanted to create a table
and load the data so if the data is
minimalistic maybe the data about 10
rows or of rows you can manually create
a table and insert the elements into
your table using such insert commands
but this set like mine which is in the
Excel spreadsheet and has about 10,000
rows would you like to you know write
10,000 insert commands no right it would
be really timec consuming so for
situations like this MySQL workbench has
enabled developers to load the data from
spreadsheets within a few steps but
before we get started let's check our
column headers so here you can see uh it
is not compatible with the MySQL
workbench or SQL commands right so it
has a space and it has a word row and it
is a keyword in my SQL right so we don't
want that confusion so for that reason
we will try to modify this maybe using
an underscore right similarly for the
row ID you can eliminate space and use
an underscore and when it comes to order
ID the same so just let us quickly
change all the column headers so that
they are SQL
compatible there you go so we have
replaced all the row headers with
underscores and made them SQL compatible
so let us save it and when you're saving
it just make sure that your Excel file
data is also having the uh you know SQL
compatible uh name so here we have load
CSV to my equal so here we have the name
with space right so let's try to change
that to lowercase Xcel data and there
right now it is SQL compatible Now
quickly let's go back to my SQL
workbench here we have it now you can
just create a new table just right click
here or you can also do it from here
create a new database and the new schema
will be the name of your data set so
let's type put as Excel data or just
Excel and apply now this is the schema
apply now you have uh Excel right here
just drop down on here you can see the
tables right click the tables and here
you have the option of uh import data
visit right just click on that now
browse your folders and have it so yeah
another notification for you guys so you
need to save your Excel spreadsheet in
the form of comma separated file right
let's quickly go back and do that open
your spreadsheet go to file save as
comma separated file save there you go
now let's get back to workbench and now
I think you will be able to find it just
open next drop table of exist make sure
you do that to be on the safest side and
check all the names here so we have a
problem with row ID but that is
something which you can fix down the
line and before you go to the next step
check all the other names as well every
other name on the column header is fine
just the first one we can just add to
the table not a big deal and uh next it
should start
importing there you go the data file got
imported of course it took a little
while because it's 10,000 that's normal
now let's quickly go to the next step
and here you can see 9000
987 records imported successfully just
click on finish and I think it should be
shortly done let's close the schema go
to the query table and yeah so you can
quickly refresh so that you will have
the Excel data over here now let's use
the database that is
Excel on it now we are in Excel database
now the table we looking for is Select
St from the data name the data table
name is Excel data without a space so
colum just quickly run it and I think we
should be shortly able to see all the
data sets right over here yeah about the
First Column ID we can simply use the
alter table um function or query to
change the name let's quickly do that
with the table
name alter
table rename
okay what was this can you copy that
copy field name rename row ID
to so um a small syntax are there so I
think they should be sorted yeah and now
let's quickly run this and I guess it
should be done now let's quickly run the
select command again there you go so we
have the row ID order ID uh order dates
ship dates shipment mode customer ID
customer name Etc and everything as as
per the
expectations and that's how you can load
Excel data to my SQL workbench we will
learn about the top five interview
questions in SQL that you must know to
crack your business analytics interviews
now without further Ado let's get
started so speaking about the top five
interview questions let's quickly jump
to the workbench of SQL so I'm using
mysq workbench and here we have a
database called use simply learn so as
LP is the database name so we'll be
using the use command to get access to
that particular database so we are in
access to it and now let's quickly check
out tables show tables there you go we
have a few tables here book collection
book order employee details joining
register and employee register so let's
go with the employee
details so I'll just simply shoot a
command select
star from
EMP
details so now we have our employee
table so we will be using this
particular data set to run few queries
from our interview questions so getting
back to the interview questions so most
commonly you will be asked the following
interview questions so the first
question is you will be asked to find
find out the names of the employees that
start with the vbls so AE i w u so they
will ask a question give me the list of
names that start with these five letters
it can be either a or e or I O U right
so what's the question so here you will
be using like operators and not like
operators let's say they want the names
with WS so you can just use the like
operator and use this particular command
select employee name name that's the
name of the column from employee
register or employee details and
then where employee name is like a
modulus which means it should start with
a and it can have any number of
alphabets after that right so let's
quickly also check what do we have in
employee register so I think it's a
similar table to employee details that
we used
before we have the same details here so
no our problem now let's try to extract
the names of the
employees W's name start with vels right
so we will be using the we clause and
like
operators run the command and there you
go so we have three names so if you able
to answer this question they will ask
they might ask a similar question with a
little modification so this time they
might ask you give me the list of names
that will not start with vels so you'll
just replace the like operator with not
like so either they'll ask the questions
which might ask start with vels or they
might ask a question which does not
start with W this is one of the common
questions now going to the second
question so here also they will give it
a Simple Start they will ask to give the
details of the employee who has the
highest salary or they will ask you to
give the highest salary you can simply
use the max aggregation and you can get
the maximum salary so we have
$887,000 and sometimes if you are able
to answer this question they will make
it a little tricky to you and they will
ask give the second highest salary here
you can use offset or there are multiple
possibilities but let me give you the
simplest one where you can have the same
query only difference is where salary is
less than Max of salary first the
subquery will be executed which will
extract the maximum salary and the next
one is less than it will give you only
one row which has a little salary which
is Les less than the maximum one right
so simply let's execute the query so we
will have the answer so the next highest
salary is
$78,000 now moving on to the third
question so sometimes they will ask you
to use the update commands as well so
here we have some salary details of our
employees in the employee registered
employee going to do here is let's say
this is the appraisal period and they're
giving you 15% hike to all the employees
so you need to update the salary column
so what you do is simply uh update table
name salary plus salary into the
percentage of hike which is 15% so here
we adding that particular percentage in
the form of Def decimal numbers which is
0.15 and simply run the command and you
have it now you can just simply uh query
the same detail which is Select Staff
from employee details so you will have
the updated salary list here there you
go now let's proceed with the next
question that we have in our list which
is about select the employee name and
salary from a given range right if they
ask you give me only the range of
employees who ow salary lies between
50,000 to 70,000 so you can use the
between operator here and range of
numbers that is 50,000 and 70,000 just
run this particular code and there you
go you have the details so there are two
employees whose salary lies between
50,000 and 70,000 now the last question
is uh they might ask you to extract the
details from a certain department so
basically this might also turn up to
find a difference between having and
group by CL sorry having and wear Clause
yeah so this is one of the common
interview questions where they will ask
the difference between having and wear
Clause so when you are implementing
Group by in your query and you're also
implementing some aggregate functions
like count sum Etc minimum maximum in
those situations when a group by Clause
is involved then you can use having when
there is no uh Group by function then
you can simply go with the wear Clause
so here I'm trying to extract the number
of people present in finance department
department so I'm not grouping by
department so I can just use where
clause and run this and now in
situations where I have to group by I
mean you know when I have to implement
Group by in those scenarios you can
include having clause in place of where
so that is the fundamental difference
between having and group by and also you
got the understanding of group by
command here what is postc SQL postc SQL
is an open- Source object relational
database management system it stores
data in rows with columns as different
data attributes according to the DB
engines ranking postris SQL is currently
ranked fourth in popularity amongst
hundreds of databases worldwide it
allows you to store process and retrieve
data safely it was developed by a
worldwide team of
volunteers now let's look at the history
of post sequel so in 1977 onwards the
Ingress project was developed at the
University of California Berkeley in in
1986 the post Chris project was led by
Professor Michael Stonebreaker in 1987
the first demo version was released and
in 1994 a SQL interpreter was added to
postris the first postris SQL release
was known as version 6.0 or 6.0 on
January 29 1997 and since then postris
SQL has continued to be developed by the
postr SQL Global Development Group a
diverse group of companies and many
thousands of individual ual contributors
now let's look at some of the important
features of postest SQL so postest SQL
is the world's most advanced open source
database and is free to download it is
compatible as it supports multiple
operating systems such as Windows Linux
and Mac OS it is highly secure robust
and reliable postp SQL supports multiple
programming interfaces such as C C++
Java and
python postp SQL is compatible with
various data types it can work with
Primitives like integers numeric string
and Boolean it supports structured data
types such as dat and time array and
range it can also work with documents
such as Json and XML and finally postris
SQL supports multiversion concurrency
control or mvcc now with this Theory
knowledge let's look at the post SQL
commands that we will be covering in the
demo so we will start with the basic
commands such as select update and
delete we will learn how to filter data
using we clause and having clause in
SQL we will also look at how to group
data using the group by clause and order
the result using the order by Clause you
will learn how to deal with null values
get an idea about the like operator
logical operator such as and and or we
will also explore some of the popular
inbuilt mathematical and string
functions finally we'll see some of the
advanced concepts in postr SQL that is
to write case statements subqueries and
user defined functions so what exactly
is a CT ask now if you are a beginner in
SQL let's say you wanted to Club two
different tables or more different
tables maybe three or four right so you
will be using one keyword which is join
right and let's say you may have to
create a query in such a way that you
have to Club different tables and you
have to extract the results from one
table into another and finally create a
put table right so this might be
sounding a little too complex so
basically what CTE does is it acts as a
temporary table right now you can write
a query and save it as a CTE right and
that particular resultant table from CTE
will not be created but will be in the
memory as a temporary data or an
intermediate resultant data right now
whenever you want to use a join or
whenever you want to use the same query
inside a bracket or inside something in
your query you can just simply use the
name of the CD and then the data you
require the columns you require and done
you will get the data now this might be
a little too complicated to understand
in just m words now let's just go
through the formal definition of what
exactly is a CTE and what it does and
then let's quickly so it's a little too
complicated to understand it just with m
words so let's get started with the
Practical examples but before that let's
understand a formal definition of what
exactly is a CTE in SQL so CTE also
known as or also called as the Common
Table expression or some people also are
used to call it as a withth expression
so the key word is with so a Common
Table expression in SQL is a temporary
result set that you can Define within a
query as I said it helps to break down
the complex queries make the code more
readable and allows you to reuse the
result set multiple times within the
same query just you need to use the name
of the CTE in the places where you want
in your query and it reduces the code
length as well as the execution time now
CTE are defined using the width keyword
as we discussed before followed by by
the CTE name right so for every uh
column name or anything in your data set
you give a name right similarly when you
are using CTE in SQL you also need to
give a name to the CTE and that
particular name will be used in your
subquery positions that will reduce the
query length and execution time so you
should be giving a name and the query
that generates the result set the CTE is
available only during the execution of
that particular query or specific query
right so as I said the CT table the
resultant table which is created while
you are using the CTE will not be
created as a permanent table in the DP
right it will be a temporary or
intermediate result which will be active
as long as your current query which is
using the CTE is active now let's go to
the demonstration mode then we will try
to create some simple queries right and
we will understand how exactly a CT can
be beneficial in those situations now
let's go to the MySQL workbench this is
my mysq workbench so I have a lot of
tables here we have the credit card data
set we have the cila data set SLP data
set says Superstar World Etc right so we
will be using the Superstar data Set uh
I mean the database so firstly we need
to write in the query which means that I
am going to use the superstore database
right sorry
Superstar so I uh prefer using uh
smaller case or lower case for database
names and column names and uh uppercase
for the keywords for example here use is
uppercase and Superstar is the name of
the keyword right so uh that is for uh
identifying or easy readability which is
a keyword and which is a name right so
let's execute this query and have access
to the superstore data set and in
Superstore data set I have one table
called is Excel data now let's quickly
check what we have in Excel data select
star from EX
data here we have R ID order ID aut date
Shipe mode customer everything right so
we have uh region we have uh sales
quantity discount profit rate so we have
a number of possibilities a number of
reports that we can generate but let's
try to keep it simple let's try to find
out unique regions right select
unique of regions
right or just
regions
data Group by regions so let's quickly
execute this statement and see the but
or maybe we can make some modifications
to it right instead of that you might
want to use you might want to use
distinct fun function so that you don't
get all uh 10,000 plus rows so basically
uh this particular data set has about
10,000 or more rows in it and it's not
real it's completely made up report
using artificial intelligence so we use
chat GPT to create 10,000 R of data for
30 years maybe from 2000 or 2001 to up
to 2030 or 31 right so you don't want
all those 10,000 plus columns or sorry
rows so let's use a distinct here and uh
try to exit this statement so that we
get U five uh of uh the regions what we
have so there you go we have um five
regions as expected NorthEast Southwest
and Central now you can also uh
select a kind of maybe average of sales
uh maximum of sales and total sales so
uh this is bringing us somewhere we can
you know try to find out region wise
sales right so region wise sales Group
by ear like 30 years what was the sale
happened in the year
2021 sorry 2001 right we begin from 2000
or 2001 to all the way up to 2030 or
2031 right so so we can see if there is
an increase in the year on-ear sales or
decrease in the year on year sales we
can identify the best performing ER the
worst performing ER right so uh this
sounds like a good use case now let's go
to the code where I written it as uh CTE
and understand the
workflow so here I have uh name my CTE
as sales CTE so I'm starting it with the
keyword with right so with sales CTE as
now this is our query right what am I
doing I'm extracting so according to the
DAT set we have the date right so the
date is year month and date of that
particular day right but we want just
the year so we're using the year
function to extract the Year from the
date as sales a region uh sum of sales
right we wanted to find the total sales
happened in that particular year as
total sales from the data set Excel data
and gr by a right we wanted it an
increasing order so 2000 to all the way
up to 230 or 2031 correct so that's how
it is and I'm saving all this as a CTE
named as sales CTE now I want to select
some parts of that particular CD so I
want to select sales air region total
sales from sales CDE which is right over
here and order it in form of sales and
region right now let's try to copy this
code and run this in our
workbench right now let's Okay let me
close this quickly so that we have a
complete view of the code right so let's
now select all the code
so now we have selected this particular
code let's try to run this and see the
output there you go we okay we have the
output but there is something wrong we
did not get uh the ears right so all the
30 years of data here it is Group by
region which is fine okay we don't want
region we want to group it by ear that's
okay and the thing is we need to fix
this particular year so maybe there is
something wrong with the order date
right so I think uh the database has
saved this particular oh okay okay since
this is generated by chart jpd maybe the
data type of the date is other than data
right other than date data type it may
be string now we might have to do some
type casting to change the data type of
the audit date and and let's quickly do
that so now we have updated the ear so
what we have done is just uh cast here
right so we have changed uh the string
type of date to the normal date which
follows by year month and date so this
is a simple type casting that you can do
and uh rest everything and we've also
added a we condition so where uh dat is
not add or date is equals to null and
you can just uh ignore that and uh now
let's try to execute this quer and we
have also removed that region thing
right Group by region or order by region
so we want that to be ordered according
to the uh year which should start with
the 2001 or the first ever year to the
last ever year according to the data set
now let's select the entire CT equ and
run that and check our outputs so there
you go so you have the year onye sales
from 2001 to all the way up to the year
2030 and
2031 right so that's how the CTE or
common uh table expressions in SQL or
the width query in SQL can be used so
welcome to the demo part of the SQL
project so in this we will do digital
music store analysis okay so this SQL
project is for the beginners so what you
will learn from this uh project main
thing is like so what's the objective of
this project this particular project so
this project is for beginners and we
teach you how to analyze the music
playlist database and you can examine
the data set with SQL and help the store
understand its business growth by
answering simple questions so as you can
see I will show you so I have three set
of questions first one is easy okay and
the second one is
moderate and the third one is advanced
level so we have three set of questions
easy set moderate and the advanced okay
so every set is of three three questions
I guess yes every set there is three
three questions
so okay in easy one there are five so we
have 5 + 3 8 8 + 3 11 we have 11
questions to solve okay from this you
will understand how you can you know
analyze data with SQL how you can
extract something from database how you
can store something like
this
okay so and one more thing I will show
you the schema of the particular uh data
set which we will you know soon we will
restore so we have the tables in this
artist album track media type genre
invoice line invoice customer employee
ID playlist playlist track and all okay
so this is the music playlist database
schema so without any further Ado let me
create one database so here just right
click create
database
okay here I will
write
music okay and
save so now our database is created okay
so if you will go to
schema and if you go to tables there is
no tables in it means there is no there
is database but nothing is there the
database is empty so now what I will do
just go to your database just right
click here you can see the restore
option okay
restore so format as it is then here
file name go to this music store
database I will put this database Link
in the description box below don't worry
open
then
restore process started process complete
some people will face this uh that the
process is failed or something okay so
for that what you have to do just go to
file then
preferences here you have to set the
path just binary path okay see I am
using the 15th version okay so I have
set the path here also and this also so
but you have to set this path is
important okay if you will not set this
edv Advanced server path it's fine but
this part is most important
okay but for the future reference I have
added on the both so what you have to do
you have to just see where you will find
this path just go to this PC then OS
then program
files here you will find this postre SQL
then I'm using 15 15 then bin so you
have to
copy this
path right have to just copy
it and paste it here and select this one
after that just save you
won't find any failed thing okay the
process will complete right so now let's
move forward and see the tables okay
it's still empty why just refresh it see
now you can see all the you know columns
in my tables okay
so what I will do for the checking I
will run one query here okay let me
close it okay I will write here
select
star from
album okay let me run
it so now as you can see here my table
is working fine everything seems
good
okay so now what we will do we will
solve question one by
one okay so the first question let's see
the first question easy one who is the
senior most employe based on job title
okay who is the senior most
okay so I will
write
here like first question is
who is the
senior
most
employee based
on job
title okay so this is our
question so we we know we have the table
name called employer so we will select
that table first so I will write here
select stuff
from
employee
so you should know uh which table should
to select okay so here as you can see in
this question there is you know t uh
word employee who is the senior most
employee based on the job title most
employee means employees and employee
table
right
so I will run
it
okay so what I will do I will just
select this and run it okay so now you
can see there in employer there is
employee ID last name first name name
title report levels but date higher date
and all the details of the
particular
okay so we will do so there is one more
thing you can see the levels okay level
one level two so we have to write who is
the senior most employee based on the
job title so what I will do I will write
here Order
by levels and decreasing order
okay so first I will do so now you can
see the levels are in the descending
order from
senior to this okay L7 to L L1 so what
we want we want only one uh employee
name so what I will write here limit is
one
okay I will copy this and done it okay
so now you can see the last name is
Madan moan sorry moan Madan this is last
name this is first name so moan Madan is
the senior most employee based on the
job de so question
first is done so the second question is
which countries have the most
invoices okay first I will write down
the question
which country has
the have the most
in have the most
invoices
okay so for
this what we have to do see just first
check first we have to check from which
table you know we will get the solution
so here you can see the word
invoices okay so we have one table
invoice and invoice line we have to
select it from this
okay so I will write
here select stuff
from
invoice
okay so we have customer ID invoice date
billing
address billing city billing State and
everything so here you can see we have
the billing country as well okay because
we need the country name so we will take
this column right so I will write
here so I will write
select we change it
select count
star from
the select star
billing
country from
invoice Group by
billing
country so why I'm doing this group by
because as you can see uh we have USA
multiple times USA USA USA then Canada
also and the other countries as well so
from this I will get only the one okay I
will group them and I will get the one
fine so from this we will uh get the
count so after this I will write
order by so here I will
write
see see descending okay let me run
it so now you can see the billing this
is the billing order okay okay so or you
can see the on voices USA got the
131 and Canada 76 Brazil 61 if I will
write here again the limit one what I
will
get see
USA we got the USA so USA is the country
which have the most
invoices okay if you will remove this
limit so you will
get the other country as well second in
Canada third is Brazil and like this
okay and the third question is what are
the top three values of total
invoices okay again we need the same
table okay first I will write the
question third question is what are
are
the top three values of total
invoices top three
value of
total invoices okay I know I can just
solve this question by the second one
but I want to do it from the
starting
okay so first I will take select stuff
from invoice
let me run
it so first we will sort the data here I
will write order
by
total because the last you know this is
a table name okay
total and the descending
order so first I will select
so we need just the top three so first I
will do everyone know limit
three
okay
okay so here I have done I have wrote
this star that is why it's giving me the
all the values if I want this only this
value so I can write select total
from invoice order by
this okay I will say and run it so I
have this total like 23.75 999 and 19.8
and 19.8 so these are the top three
values of total
invoices okay so here the fourth
question is which city has the best
customer we would like to throw a
promotional music festival in the city
we made the most money write a query
that returns one city that has the
highest sum of invoice Total return
return both the city name and sum of the
all invoice total so let me write the
question first okay I'm writing question
for you know your better understanding
okay question
fourth which city has the
best customers
we
would like to throw a
party uh
promotional promotional music
festival in this
city we made the most
money we made
the most money
write
a
query
that turns one
city that has
the
highest sum of
invoices I sum of
invoices total
return
both the
city
name and
sum of
all
devices
okay so we have this question okay so
which city has the best customer we
would like to throw a promotional music
festival in the city we made the most
money write a query that returns one
city that has the highest sum of invoice
total return both the city name and the
sum of all the invoices okay so first
what we will do we will
select select stuff
from
invoice okay
sorry we select this okay so first we
will select the billing city we have to
focus on this and the total in this two
table we have to just focus on okay so
here I will write
sum
of
total
as
invoice
total comma billing
City from
invoice so this time we will do group
by
billing city because we need the city
names uh then I will add
order
by
invoice
total and the Des sending
order seems good select some total as
invoice total billing city from invoice
Billings okay so let me select
this so as you can see the highest
billing city
is
parag Prague and the best customer is
from the parak city
okay so which city has the best customer
obviously parag pragu or sorry for the
you know
mispronunciation okay so this is how we
have solved our fourth question as well
okay because written both the city name
and the sum of all the inv you know
these is the city names and the invoice
total okay moving forward to our fifth
question which is again the long one who
is the best customer the customer who
has spent the most money will be the
declared the best customer write a query
that Returns the person who has spent
the most
money okay so I will write here
who is the
best
customer the
customer who has
spent the the
most
money will be
declared the best
customer so write a
query right everybody that returns that
Returns
the
person who has
spent most money
okay yeah so who is the best customer
the customer who has spent the most
money will be declared as the best write
a query that Returns the person who has
spent the most money okay so for this we
have to take this customer Data customer
table data okay so I will write as
select stuff from
customer okay I will select this and I
will run
it okay so this is
our know data table data of customer
okay so we have the country facts emails
state city address last name first name
okay so as you can see there there is
nothing uh like no detail of invoice or
the money okay which have spent by the
customer so what we will do we will look
at our schema so now what we can do if
we can't solve a particular question
from with one table we have to you know
join the table to the other table so
here we have to join customer table to
invoice table so in this you can see
there is customer ID and here also
customer ID so on the basis of customer
ID we can join the join both the table
and with the help of this total we will
sort out the uh that guy okay that
customer
right so for this I will
write here
select customer
Dot
customer ID
comma
customer
DOT first
name comma
customer dot last name because we need
need the full name of that guy
comma
sum invoice do
total as total
okay okay let me can be POS okay I don't
need to search
pad
right then I will write
from
customer okay my
bad then
join
invoice
on customer
Dot
customer
idals
to
invoice
do customer
ID
then I need Group
by
okay Group
by
customer
Dot customer ID after
this uh let me order it by the
descending order so the most you know
spend customer will come
up so I will write here
order order
by
total the descending
order then limit
= to
1 fine let me run it let's see what
output
should
okay okay some error is
coming okay
sorry okay so as you can see the
customer ID is five the first name is R
the last name is m our m is and the
highest value
14454 and two so who is the best
customer mad our mad sorry my bad our
Maad right our mad has spent the most
money okay so this is how we are done
with our easy set of questions now let's
jump into the moderate one okay so let
me write the question first for the
moderate so I will write
here moderate
questions so these analytics skill help
you in the data analytics to become a
data analyst or to become a data
scientist
okay so the question first
is
write
query to return
okay write query to
return the
email query to
return the
email comma first
name first
name comma last
name
and
genre of all
CL music
listener okay then
return
your
list
ordered
alphabetically by
email
starting with a
okay
let
yeah so for
this
okay let me open this
first
yeah okay fine so first what I will
do so now in this question as you can
see we need the we have to return the
email first name and the last name and
the genre of all rock music listen so if
you will see select stuff from
customer okay me run
this and if I will see there is no
column name genre okay if I will show
you the schema of this see the genre is
here and the customer is here okay we
need the first name last name and the
email ID and the genre okay and the
genre is Will should be Rock okay so
what I can do I can connect this genre
with
track that because here is also track ID
and here is also track ID then track ID
to invoice line then invoice line to
invoice then invoice to customer with
the customer ID okay this pattern I have
to
follow right so for is I will
write select just copy
this okay just follow the
steps
select
distinct email comma first
name comma last
name from
customer
join
invoice
on
customer
Dot customer
ID equals
to invoice
do customer _
ID then join
invoice underscore
line
on
invoice do invoice
ID okay then
invoice underscore
ID then
where check
ID should be
in here I will
do
select track
ID okay
from
track then
join then join genre
yeah
on track dot genre
dot ID equal
to genre
dot genre
ID
where this is important and
genre
name
like rock because we need as you can see
right go to return this is this and
genre of all rock music
listeners okay
rock right then
order
by
email okay before that let me show you
this track just select star
from track okay let me show you this
table you can see the name the track ID
album ID Media type genre ID
okay then the composer this this this
bites and the unit
price
right okay so you know this we have then
this customer okay invoice ID we to
right fine so now what I will do I will
just select this
and okay invoice ID okay invoice add is
ambiguous here I have to
write
invoice
line do invoice ID
okay let me now
run let me run it okay one more join
genre on track. genre ID there is entry
for table genre but it cannot be
referenced from this part of the query
okay
okay as you can see the here the table
name is JRE uncore ready that was the
mistake okay one more genre.
name spelling mistake
sorry my bad guys no issues it happens
okay now you can see we have all the
people who love rock music and we have
the email then first name then the last
name see Adan Mitchell Alexandra Roa a
grber like this cam Dan Edward like this
okay so there are total 59 people who
loves rock music from this particular
database okay now question
two question two is let's Okay first let
me show you let's invite the artists who
have written the most rock music data
set write a query that Returns the
artist name and the total track count on
the top 10 rock bands okay so let's
invite the
artist who
have
written the
most rock
music in our data
set so
write write a query
that
Returns the artist
name
and and the total account
of track count
of top
10 do
and so now what we need here okay let me
do
this so what we need here so let's
invite the artists who have the written
the most rock music first we need the
artist okay and the second is rock music
then we need track okay and the total
count total track count means we will
get from the track so here
we have track column track uh table and
we have the artist so now let's see the
schema part so we have we need
genre
okay for the you know uh rock music then
we have
to combine this with the track ID
because genre ID is there from track ID
to album because we need the artist name
see artist ID and artist ID so this is
how we have to connect the table
now so for this I will write here just
follow the steps
select
artist
dot artist
ID
comma artist Dot name
comma
count
artist. artist
ID
as number of songs because we need the
total number okay who have written the
most rock music number of
songs find from
track now we have to
join
album
on on
album do album
ID equals to
track Dot
album
ID okay then we have to join the artist
with artist
ID so
join
artist column on the basis of artist
artist ID equals to then
album to album.
artist ID okay so here I have joined the
artist to the album color
table okay then I have to join genra to
the track table with the track table
okay so here I will WR
join
genre
on genre
do genre
ID equals
to joh
ID okay sorry track
ID
track.
joh okay so here I will write where
well genre
dot
name
like
shock
okay rock fine then I will Group
by my B group
by
artist Dot artist ID I need the ID as
well then order
by order
by
number
of
songs and the descending then limit I
need only 10 rock bands liid will be
10 let me it
okay let me run
it okay
album
okay now let me run it okay now you can
see this guy let
Zeppelin arst IDE is 22 and wrote the
most songs 144 then You2 122 de purple
92 then then this this this then this
okay so this is how we solved our second
question right so now the third
question okay return all the track names
names that have a song Length longer
than the average
song Length return return the name and
the millisecond of the each track
order by the song
Length
okay so first I will write this
question
Q3 so return return all the
track names
that have a song
length longer
than the
average song length Okay as we return
all the track names that have the song
Length longer than the average song
Length okay
then return
return the name and
milliseconds for each track fine
after that order by them order by the
songs with
the
longest
song
listed
first okay fine so we have to return all
the track names that have a song length
and the
okay first we will find the total length
of this songs then we will do the where
then we will put the V Clause to find
out the
particular uh longest s okay so this is
this will do in the two you know step
first you will find the average stke
length Okay so I will write here select
select name comma
milliseconds
okay
from
track
where
milliseconds here I will write select
average from the
millisecond
okay then I will write here
as
average
track
length Okay then here I will write from
track
after this I will write
here order
by
milliseconds I need in the descending
order
okay so let me run
it so now you can see see first I will
uh read it again so return return all
the track names that have a song left L
longer than the average song Length
return the name and the millisecond for
each track order by the song with the
longest song listed first okay so this
is the longest song okay so we have all
the songs which are the longer than the
average song Length
right so now moving forward we have jump
into the advance set of questions okay
so now we will do the advaned questions
okay
so let's see first find how much amount
spent by each customer or not is Right a
quiry to return customer name artist
name and total SP okay so first we will
write down the
questions okay then question
one question one okay
find how
much
amount spent
by
each
customer on
artist write a
quiry to
return customer
name comma artist
name comma total
Spin and total spent
okay so how to solve this so first find
which artist has earned the most
according to the invoice lines okay
first uh let me show you the schema okay
we need the artist name we need the
customer name and we need the total
spend okay with the invoice line because
the quantity should be there okay so
first we'll see how to join these three
table artist table customer invoice and
invoice line like this okay this is how
we
will you know join the table fine so now
I will tell you the you know steps so
first find which artist has earn the
most according to the invoice line okay
the second now use the artist to find
which customer spend the most on the
artist so for this query you will uh be
need to use the invoice invoice and
track customer album and the artist
table so just remember this one is
tricky because the total spent in the
invoice
table right let me show you so total
spend on the invoice
table might not be a single product so
that is why I was saying we need the
quantity so we need the invoice line
table to find out how many each product
was purchased then we have to multiply
this by the price of each artist okay
fine so now so this is a lengthy one I
will just you know write it for you and
get back to
you yeah so this is how you can see okay
Group by five I have wrote this you can
just you know write
it okay like this okay we took artist
name then sum of invoice line unit price
into invoice line the quantity that I
showed you okay we have multiply this
total with the quantity okay then we
joined the table track with invoice
album with track artist with album okay
so now let's run
it
yeah so now you can see this H or really
Queen amount spend 27 the customer ID is
this okay
then
Nicholas scer then 18 okay we have the
everything okay customer name artist
name and the total spend this is the
customer Name the artist name and the
total amount they spent fine so now
let's move forward to the next
one which
is
okay okay yeah so the second one is this
we want to find out the most popular
music genre for each country we
determine the most popular genre as the
genre with the highest amount of
purchase so write a query that returns
each country along with the top genre
for countries with the maximum number of
purchases shared return all the genres
okay so what I will do first I will
write the
question okay so we okay
question
two so
find how the
most
popular
music
music genre for each
country okay with
theine
determine the
most
popular genre as the
genre with the
highest amount
of purchase
okay then write a
query that
returns
each
country along with
the top
genre
for
countries where the maximum
number of
purchase
okay
so so there are two parts in this
question first the most popular music
genre and the second is the need of data
at the country level okay so we can do
it from the two methods okay using CT
and the using the recursive method so I
will use the using City I will do this
city so for that you have to write
with
popular
genre
as
select
count invoice
line
dot
quantity okay
as purchases
comma customer
dot
country comma
genre.
name comma genre dot
genre
ID
okay
then here I will write row
underscore
number
number then I will write
over
Partition
by customer.
country order by
count
voice line
dot
quantity okay into descending
order as row
number
okay so
from invo
line
okay
yeah so here I will join the tables
join
invoice
on invoice
do invoice
ID equals
to
invoice
line do invoice
ID okay then again
join
customer
on customer. customer
ID do
idore
idals to invoice
Dot customer
ID
fine then again we have to join
track
track
on track. track
ID equals to
invoice uncore
line
do trackcore
ID
then
join
genre on
genre
dot JRA
ID okay then
track dot John
Ry okay then I will do group
by Group by 2 comma 3 comma
4 then I will do order
by two then ascending
order and then one to descending
order okay
okay then now I will write
select star
from
popular
genre
where row number
less
than greater than
one okay now let me run
it so now you can see we
have okay I will let me read it so we
have to find the most popular music
genre for each country okay so now we
have the Contin margentina the most
popular is alternative and punk John R
is this St number is
this okay purchases this then the
Australia this rock rock rock rock rock
okay s Rock us Rock and everything is
there right so this is how you can
find the most popular music genre for
each country okay the last question is
still
here now the last question
is write a query that determines the
customer that has spent the most
on the music for each country right a
query that Returns the country along
with the top customer and how much they
spent okay for the countries where the
top amount of spent is
shared
right and they provide all the customer
who spend this amount okay so for this
um this is like a similar to this
question okay so there are two parts in
this question find
the most spent on music for each country
and the second is to filter the data for
the respective customer it's very easy
okay
so okay I will write the solution okay
you can check the question from there
okay I'll write
customer
with
country as
as uh I will here
select customer do customer
ID
comma first
name comma last
name comma building
billing
country
comma
sum should be
total
as total spending
right then I will write
zow
number same over we have also written
here
now right the same we have to write here
over
then
Partition
by billing
country order
by by
sum
total descending
order as row
number okay so after this I will
write here
from invoice you have to fetch
then again the same thing we have to
join the
table
join
customer
on customer
Dot customer
ID equals to
invoice do customer
ID okay then here I will write Group
by I 1 comma 2 comma 3 comma 4 comma
okay that's
it okay then I will write here order
by
4 ASC ascending
order comma five
to descending
order
fine so now I will write here
select start
from
customer
with country
where r w
number is one
fine so let me run
it see we have first name last name
billing country total betting R number
and the customer ID let me show you the
question here write a query that
determines okay let me make it
okay
yeah so write a query that determines
the customer that has spent the most on
the music so customer we have the
customer name for each country write a
query that return the country along with
this so we have the country name with
the top customer how much they spend we
have the total spending for the
countries where the top amount is shared
provide all the customer who
has customer who spent this amount okay
so we have everything
here right we have this Le from Brazil
this this this this this okay with the
custom so this is how you can solve
these questions so till now I can say
you have a good data analytics skills so
for this I can say this will help you in
the interview of data analyst in data
science or any SQL okay so let's start
with the first question what is SQL SQL
stands for structured query language
it's a programming language used to
manage and manipulate databases with SQL
you can query update insert and delete
data in a database imagine it as a
librarian who knows where every book in
a library is when you need information
you ask the librarian and they fetch it
for you similarly with SQL you write
queries to get the data you need from a
database for example to find all the
customers in a database who live in New
York you would write select star from
customers where city is equal to New
York
now this is a query so this command
tells the database to find all the
records in the customer table where the
city is New York SLE is essential
because it provides a consistent way to
interact with relational databases which
store data in structured tables now the
second question is what is a database
now a database is an organized
collection of data stored electronically
think of it as a digital filing cabinet
where you can store and retrieve
information quickly managed by database
Management systems or dbms databases
allow you to use SQL to interact with
data for example an online bookstore
uses a database to keep track of books
authors customers and orders so tables
like books customers and orders stored
all the necessary information SQL
queries help the bookstore to find inst
stock books top customers or total sales
easily now let's move on to the next
question what is ddl or data definition
language so ddl primarily stands for
data definition language which is a
subset of SQL that deals with the
management of database structures it
includes commands for defining and
modifying the structure of database
objects such as tables indexes and
constraints now here are some key ddl
commands create which is used to create
new database objects like tables indexes
or views the second one is Alter which
modifies existing database objects such
as adding deleting or modifying columns
in a table next we have drop which
deletes an entire database object such
as a table or index so ddl commands are
crucial for database administrators and
developers to manage the structure of
databases effectively they allow for the
creation modification and deletion of
database objects ensuring the database
remains organized and optimized for data
storage and
retrieval now let's move on to the next
question which is what do you mean by
DML or data manipulation
language so data manipulation language
is a subset of SQL used for managing
data within database objects so unlike
data definition language which focuses
on defining database structures DML
deals with retrieving inserting updating
and deleting data stored in the
databased tables so here are some key
DML commands the first one is Select
which retrieves data data from one or
more tables based on specified criteria
next you have insert which adds new rows
of data into a table then you have
update which modifies existing data in a
table and at last you have delete which
removes rows of data from a table so DML
commands are essential for applications
to interact with and manipulate the data
stored in databases they allow users to
perform tasks such as querying for
specific information adding new records
updating existing ones and deleting
unnecessary
data now let's see what the fifth
question
is what do you mean by a forign key so
forign key in the context of databases
is a column or a set of columns that
establishes a link between two tables in
a relational database so it represents a
relationship between two tables where a
value in the for and key column of one
table matches a primary key value in
another table so this relationship helps
enforce referential Integrity between
the tables ensuring that every forign
key value points to an existing primary
key value in the reference table for
example consider two tables orders and
customers so the orders table may have a
column named customer ID which is a for
in key referencing the customer ID
column in the customer table this forq
relationship ensures that every customer
ID in the orders table corresponds to a
valid customer ID in the customer table
thereby maintaining consistency and
integrity of the data so now let's move
on to the next question what are table
and field so in the context of databases
a table is a fundamental structure in a
relational database that organizes data
into rows and columns each table
represents a collection of relatable
data entries table consists of columns
and rows columns Define the types of
data that can be stored in each field
such as integers strings dates Etc
tables are used to store and organized
data in a structured manner facilitating
efficient data retrieval manipulation
and store
St now a field also referred to as a
column is a vertical element within a
table that represents a specific
attribute a property of the data being
stored each column in a table has a name
and a data type that defines the kind of
data it can hold such as numbers text
dates or binary data fields are the
building blocks of tables and Define the
structure of the data stored within the
table for example consider students
table so in this example student ID
first name last name date of birth and
grade are Fields or columns within the
students table each storing specific
information about each student record
tables and fields are fundamental
concepts and relational databases
allowing for efficient organization
storage and retrieval of structured data
now moving on to the seventh question
what is
normalization so normalization is a
process of organizing data in a database
efficiently to reduce redundancy and
dependency a it involves breaking down
large tables into smaller related tables
and defining relationships between them
now the main goal of normalization are
to minimize data redundancy ensure data
consistency and improve data Integrity
so in simpler terms normalization helps
to structure data in such a way that
avoids storing the same information
multiple times and reduces the
likelihood of errors or inconsistencies
in the database so typically involves
dividing large tables into smaller ones
and establishing relationships between
them using key ke like primary key and
foring keys to ensure data is stored
logically and efficiently now what is a
query so query is a command used to
retrieve update or manipulate data
stored in a database it's written in a
query language like SQL and specifies a
criteria for selecting or modifying data
according to the user's needs for
example a simple query might retrieve
all records from a table while more
complex queries can filter data based on
specific conditions or perform
calculations queries are essential for
interacting with databases and
retrieving meaningful information
efficiently now let's move on to the
ninth question which is what are the
different operators available in SQL SQL
operators are special symbols or
keywords used to perform operations on
data they can be categorized into
several types let's go through them with
examples the first one is arithmetic
operators which perform mathematic
operations like addition subtraction
multiplication and division then you
have comparison operator which compare
two values and return a Boolean
result which is equal not equal greater
than less than and so on then you have
logical operators which combine multiple
conditions such as and or or not then
you have bitwise operators which perform
bit level operations like bitwise and
bitwise or Etc then you have set
operators which Combine results of two
queries like Union Union all intersect
and accept and then you have other
operators like in isnel
ETC so these were the operators in SQL
now the 10th question is what are user
defined functions in SQL so user defined
functions or udfs in SQL or custom
functions created by users to perform
specific tasks unlike buil-in SQL
functions udfs are tailored to meet
particular requirements of your
application or business logic they can
be used to encapsulate complex
calculations or repetitive tasks making
your SQL code more modular and easier to
maintain now there are two types of udfs
which the first one is scalar functions
so these functions return a single value
such as an integer float or string then
you have table valued functions these
return a table which can be used like a
regular table in SQL queries now the
next question is what is an alas command
in SQL so an alas in SQL is a temporary
name given to a table or a column in a
SQL query this helps to make your SQL
queries more readable and easier to
understand so think of it as a nickname
for a column or table that you use just
for the duration of the query so here's
how you can use alas with columns and
tables column alas you use a column alas
to rename a column in your query result
this is useful for making column names
more readable or for when you want to
rename columns in your output so the
query you can give is select first name
as first last name as last from
employees so in this query first name is
given the alas first and last name is
given the alas last so the result will
show these aliases as the column headers
now we have table aliases you use a
table alas to rename a table in your
query this is particularly useful in
complex queries involving joints where
it can help shorten the query and
improve readability so for example you
have this query so in this following
query the employees is given the alas e
and department is given the alas D this
makes the query shorter and easier to
follow so hope you understood this now
let's move on to the next question which
is what is ETL in SQL so ETL stands for
extract transform and load so it's a
process used in database management and
data wehousing to move data from one or
more sources to the destination system
usually a data warehouse or database
where it can be used for analysis and
Reporting let's break down each part of
ETL first one is extract so this is the
first step where data is extracted from
various Source systems then you have
transform so once the data is extracted
it needs to be transformed to fit the
structure and format of the destination
system so this step can include cleaning
the data aggregating it and Performing
calculations or conversions and at last
you have load which is a final step
which is loading the transform data into
the target database or data
warehouse now the next question is how
to copy tables and SQL so copying tables
and SQL is a common task whether you're
duplicating data for backup purposes
testing or creating a new table based on
an existing one there are a few methods
to copy tables and I'll guide you
through the most straight forward ones
with examples so the select into
statement is a simple way to copy the
structure and data of a table into a new
table so for example you can give this
query so this command creates a new
table called new table with the same
structure and data as existing
table now what are union minus and
intersect commands
so these commands are used to combine
the results of two or more queries in
different ways let's dive in and
understand each of them with examples
the first one is Union so the union
command is used to combine the results
of two or more select queries into a
single result set it removes duplicate
rows between the combined results so for
example this query combines the first
names from the employees table and the
customer's table into a single list
removing any
duplicates next we have minus
so the minus command also known as
accept command in some SQL dialects is
used to return the results from the
first query that are not present in the
second query so for example this query
returns first names that are in the
employees table but not in the
customer's table next you have intersect
so the intersect command is used to
return the common results from two or
more select queries it includes only the
rows that are present in all queries for
example this query returns first names
that are present in both the employees
table and the customer table now let's
move on to the next question which is
what is a SQL injection so SQL injection
is a code injection technique that
attackers use to exploit vulnerabilities
in an application software by injecting
malicious SQL code so this can allow
attackers to read modify or even delete
data in the database without proper
authorization so SQL injection typically
happens when an application takes user
input and inserts it directly into an
SQL query without proper validation or
sanitization so let's look at an example
to understand this better so imagine
you're having a simple loging form where
users enter their username and password
the application might use a SQL query
like this to check the credentials so if
the application directly inserts user
input into the query an attacker could
input something like the second query so
since one is equal to one is always true
the query returns all rows in the
users's table potentially giving the
attacker access to the system without a
valid password now what is auto
increment so Auto increment is a feature
in SQL that automatically generates a
unique number whenever the new record is
inserted into a table so this is
particularly useful for creating primary
keys where each record needs a unique
identifier so when you define a column
with an auto increment attribute the
database automatically assigns a unique
value to that column for each new row
the value usually starts at one and
increments by one for each subsequent
row although you can customize a
starting point and increment value so so
let's look at a simple example to
understand how Auto increment works so
imagine you are creating a table to
store information about employees you
want each employee to have a unique ID
so in this example the employee ID
column is a set to Auto increment this
means that when you insert a new
employees into the table you don't need
to specify the employee ID value the
database will handle it for
you now the next question is what is the
default constraint so the default
constraint in SQL is used to provide a
defa value for a column when no value is
specified during the insertion of a new
record so this helps ensure that your
table always has meaningful data even if
some fields are left blank during data
entry so when you define a column with
the default constraint the database will
automatically insert the specified
default value if no other values
provided for that column so let's look
at an example to understand how the
default constraint works so imagine
you're creating a table to store
information about products and you want
to default stock quantity to be zero if
not
specified so in this example the stock
quantity column is given a default
constraint with a value of zero this
means that if you insert a new product
without specifying the stock quantity it
will automatically be set to zero now
let's move on to the next question what
is the difference between the between
and in operators in
SQL so both between and in operators are
used to filter query results based on
certain conditions but they serve
different purposes and are used in
different contexts let's break it down
the between operator is used to filter
the result set within a certain range it
can be used with numbers text or dates
the range specified includes both the
start and end values so imagine you have
a table called sales with a column sales
amount you want to find all sales that
are between1 and
$500 so in this query between filters
the results to include only those
records where the sales amount is
between 100 and 500 inclusive there so
in operators used to filter the result
set based on a list of specified values
it allows users to specify multiple
values in a wear clause for example
let's say you have a customers table and
you want to find customers who are from
either New York Los Angeles or Chicago
so in this query in filters the results
to include only those records where city
is either New York Los Angeles or
Chicago now let's move on to the 19th
question what is the difference between
a primary key and unique constraints so
both primary key and unique constants
are used to ensure that data in a
database remains unique but they have
distinct charactertics and uses so let's
explore each of them in detail so a
primary key is a constraint that
uniquely identifies each record in a
table it's a column or a combination of
columns that ensures all rows in the
table are unique and not null then you
have unique constraint so a unique
constraint also ensures that all values
in a column or a set of columns are
unique however unlike a primary key a
table can have multiple unique
constraints and columns with unique
constraints can contain null
values now what is a join in SQL and
what are the types of joints so join and
SQL is a way to combine rows from two or
more tables based on a related column
between them joints are used to fetch
data from multiple tables and present it
as a single result set so there are
several types of joints each serving a
specific purpose let's dive into the
main types of joints with examples inner
joint so an inner joint returns only the
rows where there is a match in both
tables left outer joint so left join
returns all rows from the left table and
the match rows from the right table so
if no matches found null values are
returned for columns from the right
table then you have right outer joint so
right join ensures all rows from the
right table and the mash rows from the
left table if no matches found null
values are returned for columns from the
left table and at last you have full
outer JW so full John returns all rows
when there is a match in either the left
or right table so if there is no match
null values are returned for columns
where there is no
match now the 21st question is what is
that index so an index in a database is
like a road map that helps quickly find
specific information in a table so
normally data is stored in a specific
order on a disk making it efficient for
sequential reading however when you need
to find specific data quickly like
searching for different values and index
acts like a shortcut switch the into
having a quick reference guide that
allows database to pinpoint relevant
data without scanning every single entry
so this makes searches fast similar to
how a binary search operates so although
indexes require extra disk space and can
slow down data rights they greatly
enhance retriever speed for commonly
accessed data now what is the on delete
cascate constraint so an on delete
cascate constraint in MySQL automates
the deletion of related rows in a child
table when corresponding rows in the
parent table are deleted so this ensures
that all dependent records in the child
tables are removed without requiring
manual deletion maintaining data
integrity and simplifying database
management now what is a cursor so a
cursor in SQL is a temporary storage
area allocated by database serving
during DML operations like select insert
update or delete so curses allow you to
process each row in a results set
individually making it useful for row by
row data manipulation so you declare a c
with a query open it to execute the
query fet rows one at a time for
processing and close the cursor when
done to release
resources so the next question is what
are the various types of relationships
in SQL so in SQL relationships between
tables are crucial for organizing and
structuring data here are the different
types of relationships the first is one
to one so each row in table a is linked
to one and only one row in table B and
vice versa so example a table of
employees and a table of employees
addresses but each employee has one
unique
address now the next one is one to many
here each row in table a can be linked
to multiple rows in table B but each row
in table B is linked to only one row in
table a for example a table of
departments are a table of employees
where each department has multiple
employees but each employee Belongs to
Only One department now the next one is
many to one so it is a reverse of one to
many where each row in table be B can be
linked to multiple rows in table a so
for example multiple employees can be
linked to one department and the last
one is many to many so each row in table
a can be linked to multiple rows in
table B and each row in table B can be
linked to multiple rows in tbling for
example a table of students and a table
of courses where each student can enroll
in multiple courses and each course can
have multiple students so these
relationships help maintain data
integrity and facilitate complex query
by properly structuring how tables
interact with each other now the 25th
question is what is the difference
between SQL delete and SQL truncate
commands so the delete and truncate
commands in SQL are used to remove data
from tables but they operate differently
and have different implications SQL
delete removes specific rows from a
table based on a condition SQL trunade
removes all rows from a table resetting
the table to an empty
State now what is the difference between
cluster and non-cluster
index clustered index a clustered index
reorders the way records are physically
stored in a table based on the indexed
columns there can only be one clustered
index per table it organizes data rows
and tables based on the indexed columns
it changes the physical order of the
table data to match the index order so
typically it's used on columns that are
frequently used for range queries
example wear order by Etc now a
non-clustered index a non-clustered
index does not change the physical order
or the table draws and creates a
separate structure for the fast data
retrieval so multiple non-clustered
indexes can exist on a single table does
not affect the physical order of the
table data it stores index entry
separately from the actual data rows so
it is typically used for columns that
are frequently used in join wear and aut
by Clauses now the next question is what
is a live log so live lock happens when
multiple processes are actively running
but are stuck in a repetitive cycle of
interaction so each process responds to
changes initiated by others causing a
loop where no meaningful progress is
made so unlike a deadlock where
processes are all waiting for resources
in live loog processes remain active and
continue to react to each other without
achieving any productive outcome this
can occer in concurrent systems where
processes are trying to coordinate
actions but end up in a state where
their actions hinder each other's
progress leading to a persistent Loop of
interactions now the next question is
name different types of case
manipulation functions available in SQL
so these are the three useful functions
in SQL for manipulating the case of
strings the first one is lower the lower
function is used to convert a string
into a lowercase letter it accepts a
string as inputs and Returns the same
string with all characters converted to
lowercase for example if you have a
string hello world applying lower case
it would result in a smaller case Hello
World now next we have uppercase so
conversely the uppercase function
converts a string into uppercase letters
it also takes a string as input and
returns a string with all characters
converted to uppercase and the last one
is init cap the init cap function is
used to capitalize a first letter of
each word in a string while converting
all other letters to lowercase so this
function is Handy for formatting names
or titles so these functions are helpful
for standardizing Text data or
formatting it according to specific
requirements and SQL queries now the
next question is what are local and
Global variables so a local variables
are declared within a specific scope
such as within a function not a block of
code so they exist only within that
scope and cannot be accessed or modified
from outside it so local variables are
typically used to store temporary data
or values that are only needed for a
specific task or computation within that
particular scope so once the scope of
the functional block ends the local
variables are usually destroyed or no
longer accessible now the global
variables on the other hand are declared
outside of any specific function or
block and can be accessed and modified
from anywhere within the program or
script they have a wider scope and
throughout the entire execution of the
program Global variables are useful for
storing values that need to be accessed
by multiple functions or parts of the
code however excessive use of global
variables can lead to potential issues
like accidental overwriting of values or
difficulty in debugging now coming to
the 30th question name the function
which is used to remove spaces in the
end of a string so in SQL the trim
function is used to remove spaces or
other specified characters from the
beginning and end of a string it helps
clean up data by eliminating unnecessary
white space that might affect the
comparisons or display the Syntax for
trim is straightforward you provide the
string inside the parenthesis and SQL
will trim any leading and trailing
spaces for default now what is the
difference between truncate and drop
statements the truncate statement
quickly removes all rows from a table it
deletes data while keeping the table
structure indexes and permissions intact
now the drop statement completely
removes a table from the database it
deletes a table structure along with all
its data indexes constraints and
permissions now so Define SQL order by
so order by arranges fetch datas based
on specified columns defaulting to
ascending order but by adding DEC
command you can reverse the order for
highest to lowest prices so it's a
simple yet essential feature for
organizing data exactly as needed in SQL
queries now explain SQL having statement
so the having clause and SQL is used to
filter data based on conditions for
group result or aggregate functions used
in select statement unlike the we clause
which filters rows before grouping
having filters rows after data has been
grouped together this means you can use
having to apply conditions to summarize
data like finding groups with a total
sum about a certain value or averages
that meet specific criteria it's
important to remember that aggregate
functions like sum count average can
only be used with having not with where
this helps SQL manage and analyze data
effectively whether you are looking at
individual roles or group results now
the next question is explain SQL and or
statement in SQL the and statement
combines conditions where both must be
true for a road to be
included for example this query
retrieves employees older than 25 who
work in the IT department now the all
statement is used when at least one
condition must be true for instance this
query retrieves products in either the
electronics or clothing category both
statements allow for flexible data
filtering based on specific criter in
SQL queries now let's move on to the
next question which is why do we use
commit and roll back commands we use
commit and SQL to finalize and
permanently save changes made by a
transaction ensuring they're visible to
other users or applications and roll
back is used to undo changes if a
transaction encounters an errored or
needs to be cancelled reverting the
database its previous date so this
commands are essential for managing
transactional integrity and ensuring
data consistency in SQL databases
now let's see what the next question is
what are asset properties so asset
properties are a set of four essential
characteristics that guarantee the
reliability and consistency of
transactions in a database system so the
first one is atomicity it ensures that
all operations within a transaction are
treated as a single unit so either all
operations are successfully completed or
if any operation fails the entire
transaction is rolled back to maintain
data Integrity the second one is
consistency and ensures that only valid
data is committed to the database
transactions take the database from one
valid state to another constraints
triggers and validations are applied to
ensure data consistency I stands for
isolation it ensures that the execution
of transactions concurrently does not
interfere with each other each
transaction is isolated from others
until it completes preventing them from
accessing uncommitted changes and the d
stands for durability ensures that once
a transaction is committed its changes
are permanent and surviv system failures
the changes are stored in nonvolatile
memory disk and remain intact even in
case of power loss or system crash now
the next question is are null values the
same as zero or a blank space so no a
null value and SQL are not the same as
zero or a blank space so null represents
a missing or unknown value in a database
column it indicates that the value for
that particular record is undefined or
not applicable it is distinct from zero
or an empty string zero represents a
numerical value that is explicitly
defined as a number zero it is a numeric
value and not the same as null now blank
space I'm T string represents an absence
of characters in a string field it is
different from null which is
specifically used to denote the absence
of any value including numeric or other
data types moving on to the next
question what is the need for group
functions in
SQL in database Management Group
functions also refer to as aggregate
functions are used to process multiple
rows of data together based on specific
criteria resulting in a single
meaningful value these functions operate
across groups of rows rather than
individual rows allowing for
calculations and summaries at a higher
level of abstraction so various group
functions are the first one is Count
function so it calculates the number of
rows that meet the specified criteria
such as counting the number of orders
placed by customers the next one is sum
function it adds together the numeric
values in a column for all rows that
meet the criteria like totaling the
sales revenue for a specific period
and then you have the average function
which computes the average value of a
numeric column across all selected rows
useful for finding the average salary of
employees the next you have Min function
it retrieves the minimum value from a
column for the selected rows such as
finding the earliest date in a
transaction history and then you have
the max function which retrieves the
maximum value from a column for the
selected rows for example identifying
the highest sales figure achieved in a
month now the next question is how can
you fetch common records from two tables
so when we have data spread across
different tables in a database and want
to retrieve information that relates
across these tables we use the joint
statement this SQL feature lets us
specify which columns from each table we
want to include in a query
results now the next question is how do
we avoid getting duplicate entries in a
query without using the distinct keyword
so when dealing with SQL queries the
distinct keyword serves to filter out
duplicate rows from the result set so
while useful it can sometimes impact
query performance because it requires
the database engine to sort and compare
the results set to eliminate duplicates
so alternatively there are several
methods to remove duplicates efficiently
the first one is using row numbers so by
assigning new row numbers to each row
partitioned by The Columns that Define
uniqueness you can filter out duplicates
by selecting rows where the row number
is one the next is using self jooin so
joining a table to itself based on a
columns that Define uniqueness allows
you to filter duplicate
selecting only those rows where
corresponding values match and then
we're using Group by so grouping rows
based on columns that Define uniqueness
and aggregating the results helps in
eliminating duplicates as each groups
represents a unique combination of
values now the next question is what is
the difference between a qualus and
isnull function so the qualus function
Returns the first non-null expression
from its arguments this means if you
have multiple Expressions separated by
commas this function will evaluate them
order and return the first Nal value if
all expressions are null then the
function return returns null now in SQL
Server the isnull function serves a
different purpose it replaces null
values with a specified replacement
value now the next question is what's
the difference between rows and range so
rows specifies the window frame based on
a physical number of rows before and
after the current row and the range
defines the window frame based on rows
with the same values as the current
this is useful when your data is ordered
by values that can have
duplicates now the next question is what
is a CTE also known as common table
expression and how is it different from
a SE query so a Common Table expression
or CTE is a temporary result set that
you can reference within a select insert
update or delete
statement it is defined using the width
clause and is easier to read and
maintain compared to subqueries so
unlike subqueries CTS can be self-
referential and recursive which allows
for complex query moving on to the next
question explain the difference between
cross join and full outter join so cross
joint produces a cartisian product of
two tables meaning each row from the
first table is combined with each row
from the second table and the full outo
join returns all records when there is a
match in either the left or right table
it combines the results of both left
join and right join now as the 45th
question we have what are windows
functions so Windows function performs a
calculation across a set of table rows
related to current row unlike aggregate
functions they do not cause rows to
become grouped into a single output row
common window functions include row
number off rank off and dense rank off
so this is how the query will look like
now what is the difference between the
rank of and dense rank of functions so a
rank of function assigns ranks to rows
within a partition with gaps in the
ranking sequence when there are ties and
the dense rank of assigns ranks to rows
within a partition without gaps in the
ranking sequence when there are ties how
do you perform a recursive query in SQL
recursive queries are performed using
recursive ctes they're defined using the
with clause and include a union all to
combine the anchor member and the
recursive member so this is how a
recursive query looks
like now as the next question we have
write a query to find the top five
customers with the highest total order
amounts
so this is your query now this SQL query
selects the customer ID and calculates a
sum of order amount for each customer
from the orders table now it then groups
the results by customer ID using group
buy ensuring each customer's total order
amount is aggregated the order by total
order amount thec arranges these totals
in descending order placing the
customers with the highest order amounts
at the top finally the limit five
restricts the output to only the top
five customers with the highest total
ordered amounts now how can you optimize
a slow running
query so there are several techniques
including use appropriate indexes
indexes help retrieve the data Faster by
organizing it efficiently second avoid
unnecessary joints and subqueries
simplify queries to minimize the amount
of data processed third use efficient
functions and operators choose functions
and operators that perform tasks with
minimal overhead and then analyze
execution plans review query execution
plans to identify and address
Performance bottlenecks
effectively moving on to the last
question what is a partitioned table and
why would you use it so a partitioned
table is a large table divided into
smaller more manageable pieces called
partitions so partitioning improves
performance and manageability especially
for large data sets by allowing queries
to scan only relevant partitions rather
than the entire table for example the
the SQL statement creates a table named
sales with column sale ID of type int
sale date of type date and amount of
type decimal 10 to it partitions the
table sales based on a sale date column
using range partitioning two partitions
which is p 0 and P1 are
defined so p 0 includes values less than
2022 01 01 and P1 includes values less
than 2023 0101 this setup allows data in
the Sal table to be divided into
separate partitions based on the data
ranges so that concludes our Advanced
SQL full course for 2024 if you have any
questions or would like to share your
experiences please leave a comment below
your feedback is invaluable to our
community if you found this course
helpful please give it a thumbs up and
consider sharing it with others don't
forget to subscribe to our Channel and
hit the notification Bell to stay
updated with our latest content thank
you for joining us on this journey
staying ahead in your career requires
continuous learning learning and
upskilling whether you're a student
aiming to learn today's top skills or a
working professional looking to advance
your career we've got you covered
explore our impressive catalog of
certification programs in cuttingedge
domains including data science cloud
computing cyber security AI machine
learning or digital marketing designed
in collaboration with leading
universities and top corporations and
delivered by industry experts choose any
of our programs and set yourself on the
path to Career Success click the link in
the description to know
more hi there if you like this video
subscribe to the simply learn YouTube
channel and click here to watch similar
videos to nerd up and get certified
click here