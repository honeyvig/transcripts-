foreign
I am mayank and welcome to Simply learn
today we will take you through our hands
of lab demo of how you can do time
series forecasting using machine
learning before we start I hope this
screen is clearly visible and the audio
is fine if yes please type in yes if
there are any issues do let us know in
the chat section so that we can resolve
them
let's wait for some more minutes to let
other people join
let me tell you guys that we have
regular updates on multiple Technologies
if you are a tech geek in a continuous
hunt for the latest technological trends
then subscribe to our YouTube channel
and press that Bell icon to never miss
any update from Simply learn great I
think we can get started so in today's
session we will discuss what time series
forecasting is after that a hands of lab
demo of how you can do time series
forecasting using machine learning we
will perform different functions and
different python libraries for analyzing
the data
before we move on to the programming
part let's discuss time series
forecasting and proceed further for the
same
what is time series forecasting
making scientific projection based on
the data with historical timestamps is
known as time series forecasting it
entails creating model through
historical study using them to draw a
conclusion and guide strategic decision
making in the future
the fact that the future result is
wholly unknown at the time of the task
and can only be anticipated through
analysis and evidence-based priors is an
essential distinction in forecasting
give yourself a chance to Simply against
professional certificate program in Ai
and machine learning which comes with
completion certificate and in-depth
knowledge of AI and machine learning
check this course detail from the
description box below
so here is one question for you guys I
will give you exactly one minute for
this you can comment or you can give
your answer in the chat section so I can
see if the answer is given by you are
right or wrong
okay
so the question is which type of
programming does python support
I'm repeating again which type of
programming does python support
option a object oriented programming
option b structured programming option C
functional programming and option D all
of the above
foreign
or in the comment section
so I am starting a timer of one minute
just type your answer in the comment
section or in the chat section
do let me know your answers please
so I am starting the timer of one minute
which type of programming does python
support object oriented structured
programming functional or all of the
above
do let me know your answers please
you can comment or you can give your
answer in the chat section so I can see
if the answer is given by you are right
or wrong
which type of programming does python
support object oriented structured
functional or all of the above
30 seconds meaning
this type of programming does python
support object oriented structured
function or all of the above
let us know your answers in the chat
section or in the comment section below
10 seconds more
which type of programming does python
support
five seconds more
so the alerted time is over we will give
a reply to those who gave the correct
answer
and for those who didn't give the
correct answer we will give you reply
with the correct answer okay
now let's move to our programming part
so we will open command prompt to write
a command to open Jupiter notebook so
here I will write Jupiter
notebook
that's okay Jupiter
notebook press enter
will take time
it's open
so this is the landing page of Jupiter
Noodle and here I will select new
python kernel file
so this is how Jupiter kernel look likes
so
here
what we will do we will import some
major libraries of python which will
help us in analyzing the data okay
import numpy
as NP
okay
then import
pandas
as PD
then import
C bone
as SNS
the fourth one is from
matplotlib
port
as pld
okay
then
we will import some model libraries so
here I will add from
stats
models
dot TSA
dot API
import
exponential
muting
and comma then
simple
XP smoothing
and one more
hold
we will write here import sorry from
sqln dot linear
underscore model
import
linear
regression
okay
then import
ance
earnings
then we will already have warnings
Dot
filter warnings
should be ignore
yes there will be no error
or it's still loading yeah
so numpy numpy is a python Library used
for working with arrays it also has a
function for working with the domain of
linear algebra and matrices
it is an open source project and you can
use it freely numpy stands for numerical
python
second is paranda
pandas is a software Library written for
the Python programming language for data
manipulation and Analysis in particular
it offers data structure and operations
for manipulating numerical data and Time
series
than Seaborn an open source python
Library based on matplotlib is called C
bone
it is utilized for data exploration and
data visualization
with data frames and the pandas
liability c bond function with ease
matplotlib for Python and its numerical
extension numpy matte prodib is a cross
platform data visualization and
graphical charting package
as a result it presents a strong open
source substitute for matpler
the apis format.lib allow programmers to
incorporate graphs into GUI applications
linear regression the machine learning
method regression built on linear
supervised learning
analysis regression is done
regression creates a value for the aim
prediction using independent variables
as inputs
its main goal is to investigate the
relationship between factors and
forecasting
exponentially smoothing
the exponential Windows function is a
general method for smoothing time series
data known as exponential smoothing
it contrasts to the ordinary moving
average which weights previous data
quality
exponential function use weights that
decrease exponentially with time
and there is one more simple exponential
smoothing
the simple exponential smoothing classes
use Simple exponential smoothing models
to give very simple time serial analysis
a weight average of the most recent
value and the preceding smooth value
constitute the predicted value
the contribution of older valued degrade
exponentially as a result of this
smoothing parameter
okay so after importing libraries let's
import data set
for this we I will write here DF
or you can write data frame
PD Dot
read
underscore CSV
here I will write
monthly
underscore CSV
dot CSV
okay this is my file name
you can download this file from the
description box below
and
for seeing the data I will write here DF
Dot
head
then press enter
yeah
so here PD is for pandas Library read is
used for reading the data set from the
machine and CSV is used for the type of
file which I was using okay or whichever
you want to read
and if you want to see the top 5 rows of
your data set you can use head and if
you want to see the last five rows of
your data set you can use tail instead
of head
okay this one you can write your tail
so moving forward let's see how many
rows and columns are present in our data
set for that I have to write DF dot
shape
okay
then press enter
okay it will give error why because
this yeah
so here you can see 847 rows and two
columns date and price only
so moving forward let's do some Eda
exploratory data analysis okay for that
I have to write here print
data
date range
of
of gold prices
available from
and here I have to give curly brackets
and DF dot location Loc
and colon
comma
date
okay D is capital here so I have to
write
date
and from location 0
to
again same thing DF Dot
Loc
date
to the length of
EF
minus 1
. everything seems good yeah
then press enter
okay
we have date range of gold prices
available from this 1950 to 2020. okay
in our data set
and here I will write date
equals to PD Dot
date
range
start from
slash one
slash 1950
comma
and equals to
each slash
one slash 2020.
comma frequency
media
okay then
then here I will write date
then press enter
yeah
so here you can see date time index
okay from starting to land these dot
dots
and here I will write
DF
and
was to
date
we have dot drop
date
comma axis is 1
comma in place
pursue true
T should be capital
then DF equals to DF
dot set
index
and month
and TF
Dot
head
press enter
so instead of
this state
we have adjusted this month
okay for particular value
so moving forward let's see the graph
different different graphs okay
TF Dot Plot
then figure set should be
plus two
20 comma 8.
then plot
dot title
is
like
gold
prices
1950
and onwards
okay title should be this
then X level should be PLT dot X label
will be months
then PLT dot y labels
should be
price
and I will write a PLT Dot
grid
okay
press enter
okay title spelling my battery
okay then press enter
oh why label it is sorry
here you can see
gold prices monthly since 1950 and
onwards
okay till from 1950 and from till 2020.
okay this is the price
then moving forward let's see another
graph so I will write here for that
round
DF Dot
describe
comma 3.
and here's you can see the count
variable and the average is 416.557
standard deviation that minimum price
value is this 20 this and the maximum
value is this okay
so
so the average gold price in last 70
years is this Force 16.557 okay
only 25 percent of the time the gold
price is above 447.
the highest gold price ever does this
this one 1840 807.
so we will do visual analysis so here I
will write
ax equals to
PLT Dot subplots
sub plots
okay then figure size
assume
25
comma odd
okay
then
sns.box plot
X
equals to
DF dot index
dot ear
comma y equals to DF dot values
colon comma 0
comma ax equals to X
okay
then same PLT dot title
total price
monthly
1950
in words
same graph will come but in the
different format okay
let me remove this
then PLT Dot X label
table must be here
LT dot y label
ice
and
PLT Dot
X ticks
will be rotation
pursue
okay I will give rotation 90.
PLT dot grid
you can write here instead of grid I can
write here direct issue so grid is this
format this box format okay
so press enter
it's loading yeah
so here you can see from 1950 every year
is here till 2020 so how the gold prices
are decreasing and increasing okay
let's see the another graph
I will write here from
ads
models
models
Dot graphics
Dot
TSA plots
port
okay
then I will write here figure comma ax
equals to
then PLT Dot
subplots
bigger size
equals to
22 comma 8.
okay
then month plot
TF comma y label
pursue
gold
price
okay comma
then ax equals to ax
and I will give the title PLT Dot
title
I will copy from here
and PLT Dot
X label
month
and PLT dot y label
the price
PLT dot grid
so here you can see gold prices monthly
since 1950. like for every month like
January February March April so on till
December okay
we will cover one more graph
okay and many many more graphs
so
so we will
go with the next graph
for that I will add here
let's go
comma ax
equals to
PLT Dot subplots
then figure size
was 2.
22 comma 8
then same SNS
dot box plot
x equals to
DF dot index
dot month name
okay
then y equals to
DF dot values
comma 0
comma ax
equals to ax
okay then PLT dot title
will put same title so I can copy from
it here
let's copy from here and paste it here
okay
and PLT Dot
X label
and PLT dot y label
price
and PLT dot grid
okay
dot show
this time let's not use grid
okay
okay something videos month name
yes
you can see
for every month
this is another type of graph
okay box plot graph
so why we are creating so much graphs
because we are doing Eda exploratory
data analysis in this we have to see the
multiple different and different
different types of
graph
okay so moving forward let's see average
gold price
per year like Trend since 1950.
so for that I have to write here DF
let's go early
let's go sum
DF Dot resample
sample
then
a
dot mean
DF underscore
yearly
underscore sum
Dot Plot
PLT Dot title
here I will write average
gold price
yearly
since
1950
or you can write onwards from onwards
1950. so here I will add PLT dot X label
here
and PLT dot y label
ice
okay
then PLT dot grid this time we'll use
grid
so here you can see the average gold
price early since 1950. okay this is the
chart till 2020 like sometimes up
sometimes down okay
and we will see now like average gold
price per quarter
like trends like since 1950
so here I will write DF Dot
not DOT do you have dot quarterly
okay
underscore sum equals to
DF Dot resample
quarter Q
dot mean
okay
move this
then DF underscore
quarterly
scores sum
Dot Plot
and the same PLT dot title
from here
here I will write average good price
waterly
quarterly
okay
since 1950
then PLT dot X label
label is now here quarter
PLT dot y label
is price
now PLT dot shown
it this time
okay
you have underscore quietly
okay quarterly
yeah
so here you can see the price prediction
okay let me set to the grid only
it's not this
visuals are not good so great
yeah
so here you can see the quarterly
process prediction
okay average gold price quarterly
prediction
so like moving forward
we will see now average gold price per
decade like per 10 years okay
so from 1950 only so here I will write
DF underscore decade
underscore sum
vasu DF Dot resample
every 10 years okay 10 year
dot mean
we are writing mean because we are like
putting out average
okay
so DF underscore decade
underscore sum
Dot Plot
PLT dot title
average
goal
price
per decade
since
1950. okay
since 1950 yeah perfect
so here I will get PLT Dot X label
then
take it decade is off like every 10 year
PLT dot y label
PLT dot grid
yeah
so here you can see the average gold
price per decade like from 1950 to 1960
like this straight then against it then
up then sometimes down then up and down
okay every 10 years you can see a 1990
2000 2010 and 2020.
so moving forward let's do like analysis
in coefficient of variation the
coefficient of variation CV is a
statical measure of the relative
dispersion of data points in a data
series around the mean
and in finance the coefficient of
variation allows investor to determine
how much mortality or risk is assumed in
comparison of the amount
like amount to the return expected from
investors
okay the lower the ratio of the standard
deviation to mean return the better risk
return trade-off
okay let's like let us look now the CV
values for each year in gold prices
so CV means coefficient of variation in
prices okay
so here I will write DF underscore one
equals to DF Dot
Group by
F dot index
dot ER
dot mean
dot name
dot columns
equals to
private price
and
mean
then again DF underscore one equals to
DF underscore one
dot range
or what we can do instead of range we
can write merge
TF dot Group by
scope DF dot index
dot EO
in the division
rename
columns
equals to
ice
standard deviation
comma left
index
was you true
then comma right index
was so true
okay
and here DF underscore one
let's go
first two
EF underscore one
standard deviation
slash
DF underscore one
two
hundred
like Dot
round figure should be like 2 after
decimal how much like numbers you want
to see
then DF underscore one dot head
Center yeah
so here you can see for every year
I have mean standard deviation
and this coefficient of variation
okay
for every year
so
like moving forward let's see the
average gold price per year again
so for that figure
underscore
figure Dot
comma ax
equals to PLT
Dot subplots
bigger size
15 comma
that
then
I will write here DF underscore one
is
like COV underscore
Dot Plot
VLT dot title
average goal
price
yearly
since
1950.
okay then PLT dot X label
is here
or PLT
dot y level
by label
coefficient of variation I am writing CV
in percent
okay
then PLT dot show
okay DF underscore invalid syntax
capital
City The Dot Plot
okay
codf underscore one DF underscore one
it here
valid syntax
okay
foreign
gold price since 1950.
okay
this is like percentage CV in percent
okay
like
good
you can say the chart
so the CV value these its highest in
1978 like somewhere here like 1980 1978
okay
like near to 25 percent which could have
made the asset as a highly risky but in
2020 the CV value is closer to five
percent which makes the asset variable
via good investment okay
so
now what we will do we will do time
series forecasting
okay we will train model we will build
model different different model we will
train and test split to build time
series forecasting model
so for that let me do like this first
yeah
so here I will write train
was to DF
TF dot index
dot per year
okay
equals to 2015
and for the testing we will write TF
DF dot index
dot ER
2015.
okay for training we are taking till
2015 for and for the testing we are
taking till 2020 from 2015. okay
then I will write here
how many columns present in train or
test
so for that I will add print train
dot shape
print
test dot ship
press enter
792 rows and one column in train
training for training the model and 55
to test the model okay
so now let's see the training date and
testing data
so train
a
like square brackets so
price
Dot Plot
then figure size
equals to
13 comma
5.
and
font size should be
also 15
.
test
ice
Dot Plot
bigger size
figure size
let me give
same 13 comma 5
font size
should be
okay then PLT dot let me add grid
LT dot grid
then PLT
Dot agent
training
data
comma
test data
okay then PLT
or
so I will tell you what the legend is
okay
so here you can see the training data in
blue and the testing data okay this is
known as the legend this this portion
and yeah
so here you can see month wise
okay till 2020.
and from 1950
right these are the prices
and this is the chart so moving forward
let's do model formation now okay
we will do two models lineal
linear regression and the name base one
okay so first we are
first we will go from
linear regression
for that I will write train underscore
time
pursue I plus 1
1
4
I in range
brain
test underscore time equals to
I Plus
length like train
one for I in
range then length should be test
okay so for length
training time
or my length should be tested
press enter
okay this is the training and this for
the testing 792 rows and here 55 rows in
testing
so
LR underscore
alarm is linear regression let me make
it capital
rain
equals to
make a copy
underscore
test equals to test copy
dot copy
then LR
okay
so LR
r
train
time
question train time
okay and LR
underscore test
time
equals to test time
okay
underscore is there
so here I will write LR equals to linear
regression
uh dot fit to the model
because LR train
and for the time
la
underscore train
ice
values
linear regression is not defined okay my
bad
L should be Capital yeah
so now see the graph
so test underscore
[Music]
prediction
let's go model
one
question
Allah Dot
predict
La underscore test
time
test
question
test underscore predictions
score model
one
okay
let's create the graph figure
size should be
let's do
14 comma six
PLT Dot Plot
print
price
comma
label
should be
trained
okay then plot
PLT Dot Plot
test
ice
label
equals to test
PLT Dot Plot
then LR train or tests
podcast
or label
equals to
regression on time okay
regression on time
foreign
PLT dot Legend
best
PLT dot get it
let's enter
okay
here I have to write predict
loading
one more error
price price
okay
is the price
so here you can see regression on time
test data is this green one and this
training Returns the testing data
OK let's find the map now so for this
we'll write here def
me
chill comma prediction
then return
Ed
P dot mean
abs
actual
action
Jewel
I
100
comma 2.
okay
to give the
yeah
so for for getting the map you have to
write a map underscore
model
let's go test equals to make
just
price
Dot values
comma
test underscore
action
scope model one
okay
then print
is
percent three
Dot 3 f
then here I have a percent
model
one underscore test
comma
percentage
press enter
best
okay
jewel is not defined
web test
we'll model one test
May test
values
the test
pictures
model one
okay
here's a is small
so
map here you can see 29.76 0.
so you are a bit confused like what is
Me Maybe is a measure of prediction of
accuracy of a forecasting method in
statical model OKAY is a measure of
prediction accuracy of forecasting
method in statical mother
and now
results
equals to PD Dot
data frame
test
map
and percent
score
model 1
comma index
equals to
regression
on time
okay then I will print the results
okay D should be capital
pandas has no attribute data frame
okay
model one is not defined
let's go test
well it's in there perhaps you gotta
forget a comma
Colin
model one okay
here you can see the test map regression
on time
so let's do with the name now we have to
perform the same pattern so what I will
do what I will write the code and get
back to you okay
so I'm done with the code so here you
can see I have same pattern train and
test copy
and this is the name forecast on the
test data so this is the line
and this is the training and this orange
one is testing
the same we have got me like 19.380
okay
so and regression is this
the name model
so what we'll do we will create now
final model of ours okay
and we will forecast final forecasting
will do
for that I have to write final
model
question
exponential
smoothing
okay DF
comma
and equals to
iterative
comma seasonal
pursue additive
for my fit
smoothing
level
goes to 0.4
comma
smoothing
trend
versus 0.3
comma smoothing
season
equals to 0.6
okay press enter
exponential exponential
so map
go final underscore model is equal to
map
like DF
dice
dot values
comma final
let's go
model
Dot
fitted values
then print
map
comma map
it's cool
final underscore model
okay
so map is 17.24 which is quite good for
the final model
okay
so getting the prediction for the same
number of time stamps at the present
time in the test data so I will write
here predictions
equals to final
underscore model Dot
forecast
steps
equals to length DOT test
Center
now we will compute 95 percent of
confidence interval for the predicted
value so
tkf equals to PD Dot
data frames
then
lower
CI
prediction
1.96
into
NP
dot standard deviation of final
model
Dot
one
okay
and comma
right here prediction
okay then upper CI
action
plus 1.96
into
our standard deviation
the same
final model
God
so one
okay
then prediction
underscore DF dot at
so this is lower CI prediction and the
upper CI okay how much it will forecast
or
now
at the end at the final State what we
will do we will plot a graph okay
forecast graph along with the confidence
band
for that X is equals to DF Dot Plot
label
question
actual
comma figure size
16
comma 9
addiction DF
and
Dot Plot
ax equals to
this
comma label
underscore DF
it's lower CI
what I will do
instead of this
label equals to
cast
comma Alpha
equals to 0.5
this
dot bill
between
chin
underscore DF
dot index
comma prediction underscore DF
1 underscore CI
comma prediction
underscore DF
this CI
then
color
question
um
comma
Alpha
equals to
0.15
okay
then axis
dot set
underscore
X label
year month
axis
dot set
y label
it's
PLT dot Legend
should be location
best
then PLT dot grid
PLT dot show
okay this is PLT only
then press enter
okay 16 comma 9 position argument
follows keyword argument
right 15.
oh
okay okay I have to give you
upper CI
alright upper CI
so here you can see our final model
forecasting so till 2020 it is showing
like normal and after that till 2030
okay this will be the forecast as per
the data
okay
so
here you can see
as you can see we have the map is
17.24
okay then here I did the prediction for
the testing data
and here I've created the data frames
these are the data frames lower CI
prediction and upper CI and then I have
created
the and then I have created the final
graph of the forecasting
okay
so I hope you guys must have understood
like how you can do time series
forecasting using machine learning or
python
like if you have any queries you can ask
in the comment section our team will
respond you as soon as possible or if
you want this full code this full code
just comment down for the same
and you can download the data set from
the description box below and don't
forget to check the course link from the
description box below and machine
learning thank you so much for being
here if you enjoyed this video please
subscribe to our YouTube channel and
give a like to this video thank you
and keep learning
hi there if you like this video
subscribe to the simply learn YouTube
channel and click here to watch similar
videos turn it up and get certified
click here